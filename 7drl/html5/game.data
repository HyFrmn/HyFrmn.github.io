love.conf = function(t)
  t.window.title = "7drl2017"
  t.window.resizable = true
  t.identity = "7drl2017"
  t.window.width = 800
  t.window.height = 600
  t.window.minwidth = 800
  t.window.minheight = 600
end
local lume = require('lib/lume')
local bresenham = require('lib/bresenham')
local Delaunay = require('lib/delaunay')
local Point = Delaunay.Point
local Map
do
  local _class_0
  local _base_0 = { }
  _base_0.__index = _base_0
  _class_0 = setmetatable({
    __init = function(self, width, height, grid)
      self.width = width
      self.height = height
      self.tiles = grid
    end,
    __base = _base_0,
    __name = "Map"
  }, {
    __index = _base_0,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  Map = _class_0
end
local rr
rr = function(x, y)
  return lume.round(lume.random(x, y))
end
local Grid
do
  local _class_0
  local _base_0 = {
    print = function(self)
      for y = 0, self.height do
        local line = ""
        for x = 0, self.width do
          local t = '0'
          if self.grid[x][y] == 1 then
            t = '.'
          end
          if self.grid[x][y] == 2 then
            t = ','
          end
          line = line .. t
        end
        print(line)
      end
    end,
    add_room = function(self, room)
      local hw = room.halfwidth
      local hh = room.halfheight
      for x = room.x - hw, room.x + hw do
        for y = room.y - hh, room.y + hh do
          self.grid[x][y] = 1
          self.room_grid[x][y] = #self.rooms
        end
      end
      return table.insert(self.rooms, room)
    end,
    test_room = function(self, room)
      local result = true
      local hw = room.halfwidth
      local hh = room.halfheight
      for x = room.x - hw - 1, room.x + hw + 1 do
        if result == false or x == 0 or x >= self.width then
          result = false
          break
        end
        for y = (room.y - hh - 1), (room.y + hh + 1) do
          if self.grid[x] == nil or self.grid[x][y] ~= 0 then
            result = false
            break
          end
        end
      end
      return result
    end,
    get_spawn_location = function(self)
      local tx = rr(1, self.width - 1)
      local ty = rr(1, self.height - 1)
      while self.items[tx][ty] ~= false or self.grid[tx][ty] ~= 1 do
        tx = rr(1, self.width - 1)
        ty = rr(1, self.height - 1)
      end
      self:set_item_spawn(tx, ty, true)
      return tx, ty
    end,
    set_item_spawn = function(self, x, y, item)
      self.items[x][y] = item
    end
  }
  _base_0.__index = _base_0
  _class_0 = setmetatable({
    __init = function(self, width, height, d)
      if d == nil then
        d = 0
      end
      self.width = width
      self.height = height
      self.grid = { }
      self.items = { }
      self.room_grid = { }
      for x = 0, width do
        self.grid[x] = { }
        self.items[x] = { }
        self.room_grid[x] = { }
        for y = 0, height do
          self.grid[x][y] = d
          self.items[x][y] = false
          self.room_grid[x][y] = -1
        end
      end
      self.rooms = { }
    end,
    __base = _base_0,
    __name = "Grid"
  }, {
    __index = _base_0,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  Grid = _class_0
end
local Room
do
  local _class_0
  local _base_0 = { }
  _base_0.__index = _base_0
  _class_0 = setmetatable({
    __init = function(self, x, y, width, height)
      self.x = x
      self.y = y
      self.halfwidth = width
      self.width = width * 2 + 1
      self.halfheight = height
      self.height = height * 2 + 1
    end,
    __base = _base_0,
    __name = "Room"
  }, {
    __index = _base_0,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  Room = _class_0
end
local setseed
setseed = function(seed)
  if seed == nil then
    seed = os.time()
  end
  math.randomseed(seed)
  return seed
end
local Desert
Desert = function(width, height, seed)
  setseed(seed)
  local grid = Grid(width, height, 1)
  local tilemap = {
    3,
    1
  }
  local entities = { }
  local tx, ty = grid:get_spawn_location()
  table.insert(entities, {
    x = tx,
    y = ty,
    type = 'pc'
  })
  for i = 1, 4 do
    tx, ty = grid:get_spawn_location()
    table.insert(entities, {
      x = tx,
      y = ty,
      type = 'mine_entrance',
      data = {
        interact_map = 'dungeon',
        seed = math.random() * 1000
      }
    })
  end
  for i = 1, 40 do
    tx, ty = grid:get_spawn_location()
    local data = {
      sprite_frame = {
        rr(2, 4),
        2
      }
    }
    table.insert(entities, {
      x = tx,
      y = ty,
      type = 'cactus',
      data = data
    })
  end
  for i = 1, 30 do
    tx, ty = grid:get_spawn_location()
    table.insert(entities, {
      x = tx,
      y = ty,
      type = 'snake'
    })
  end
  return grid, tilemap, entities
end
local Dungeon
Dungeon = function(width, height, seed)
  seed = setseed(seed)
  local grid = Grid(width, height)
  for i = 1, 30 do
    local test = 0
    local room = Room(rr(0, (width - 1) / 2) * 2 + 1, rr(0, (height - 1) / 2) * 2 + 1, 2, 2)
    while not grid:test_room(room) and test < 10 do
      room.x = rr(0, (width - 1) / 2) * 2 + 1
      room.y = rr(0, (height - 1) / 2) * 2 + 1
      test = test + 1
    end
    if test < 10 then
      local _ = nil
      grid:add_room(room)
    end
  end
  local tx, ty = 1, 1
  local bx, by = tx, ty
  local bread_crumbs = { }
  local maze
  maze = function(tx, ty)
    local tests = {
      {
        1,
        0
      },
      {
        -1,
        0
      },
      {
        0,
        1
      },
      {
        0,
        -1
      }
    }
    tests = lume.shuffle(tests)
    local moved = false
    for _index_0 = 1, #tests do
      local test = tests[_index_0]
      local _tx = tx + test[1] * 2
      local _ty = ty + test[2] * 2
      if _tx > 0 and _tx < width and _ty > 0 and _ty < height then
        if grid.grid[_tx][_ty] == 0 then
          grid.grid[tx + test[1]][ty + test[2]] = 1
          grid.grid[_tx][_ty] = 1
          grid.room_grid[tx + test[1]][ty + test[2]] = 0
          grid.room_grid[_tx][_ty] = 0
          maze(_tx, _ty)
        end
      end
    end
  end
  for x = 1, width, 2 do
    for y = 1, height, 2 do
      maze(x, y)
    end
  end
  local connectors = { }
  for x = 2, width - 2 do
    for y = 2, height - 2 do
      if grid.grid[x][y] == 0 then
        local a = grid.room_grid[x][y - 1]
        local b = grid.room_grid[x][y + 1]
        if a ~= b and a >= 0 and b >= 0 and (a == 0 or b == 0) then
          local room = b
          if a > 0 then
            room = a
          end
          if connectors[room] == nil then
            connectors[room] = { }
          end
          table.insert(connectors[room], {
            x,
            y
          })
        end
        a = grid.room_grid[x - 1][y]
        b = grid.room_grid[x + 1][y]
        if a ~= b and (a > 0 or b > 0) and (a == 0 or b == 0) then
          local room = b
          if a > 0 then
            room = a
          end
          if connectors[room] == nil then
            connectors[room] = { }
          end
          table.insert(connectors[room], {
            x,
            y
          })
        end
      end
    end
  end
  for room, conns in pairs(connectors) do
    local _ = lume.randomchoice(conns)
    local x, y = _[1], _[2]
    grid.grid[x][y] = 1
  end
  local points = { }
  local _list_0 = grid.rooms
  for _index_0 = 1, #_list_0 do
    local room = _list_0[_index_0]
    table.insert(points, Point(room.x, room.y))
  end
  local tilemap = {
    3,
    7
  }
  local start_room = lume.randomchoice(grid.rooms)
  local entities = { }
  tx = start_room.x
  ty = start_room.y
  while grid.grid[tx][ty] == 1 do
    ty = ty - 1
  end
  ty = ty + 1
  table.insert(entities, {
    x = tx,
    y = ty - 0.5,
    type = 'mine_entrance',
    data = {
      interact_map = 'desert'
    }
  })
  table.insert(entities, {
    x = tx,
    y = ty,
    type = 'pc'
  })
  local _list_1 = grid.rooms
  for _index_0 = 1, #_list_1 do
    local room = _list_1[_index_0]
    table.insert(entities, {
      x = rr(room.x - room.halfwidth, room.x + room.halfwidth),
      y = rr(room.y - room.halfheight, room.y + room.halfheight),
      type = 'crate'
    })
  end
  for i = 1, 30 do
    tx, ty = grid:get_spawn_location()
    table.insert(entities, {
      x = tx,
      y = ty,
      type = 'snake'
    })
  end
  return grid, tilemap, entities
end
return {
  Desert = Desert,
  Dungeon = Dungeon
}
local deep_copy, deep_extend, pprint
do
  local _obj_0 = require("utils")
  deep_copy, deep_extend, pprint = _obj_0.deep_copy, _obj_0.deep_extend, _obj_0.pprint
end
local TYPES = {
  default = {
    tx = 0,
    ty = 0,
    rot = 0,
    name = 'entity'
  },
  chara = {
    _inherit = 'default',
    sprite_image = "sprites",
    sprite_frame = {
      1,
      3
    },
    sprite_color = {
      255,
      255,
      255
    },
    vx = 0,
    vy = 0,
    ax = 0,
    ay = 0,
    acc = 512
  },
  mine_entrance = {
    _inherit = 'default',
    sprite_image = "sprites",
    sprite_frame = {
      8,
      2
    },
    sprite_color = {
      255,
      255,
      255
    },
    script = 'mineentrance',
    interact = {
      label = "Leave Mine"
    }
  },
  cactus = {
    _inherit = 'default',
    sprite_image = "sprites",
    sprite_frame = {
      2,
      2
    },
    sprite_color = {
      255,
      255,
      255
    }
  },
  crate = {
    _inherit = 'default',
    sprite_image = "sprites",
    sprite_frame = {
      10,
      2
    },
    sprite_color = {
      255,
      255,
      255
    },
    interact = {
      label = "Open Crate"
    }
  },
  box = {
    _inherit = 'default',
    sprite_image = "sprites",
    sprite_frame = {
      10,
      2
    },
    sprite_color = {
      255,
      255,
      255
    },
    interact = {
      label = "Open Box"
    }
  },
  ammo = {
    _inherit = 'default',
    sprite_image = "sprites",
    sprite_frame = {
      12,
      3
    },
    sprite_color = {
      255,
      255,
      255
    },
    sprite_scale = 1,
    sprite_oy = 12,
    trigger = true,
    droppable_attr = 'ammo',
    droppable_ammount = 6
  },
  red_potion = {
    _inherit = 'default',
    sprite_image = "sprites",
    sprite_frame = {
      11,
      2
    },
    sprite_color = {
      255,
      255,
      255
    },
    sprite_scale = 1,
    sprite_oy = 12,
    trigger = true,
    droppable_attr = 'health',
    droppable_ammount = 6
  },
  green_potion = {
    _inherit = 'default',
    sprite_image = "sprites",
    sprite_frame = {
      12,
      2
    },
    sprite_color = {
      255,
      255,
      255
    },
    sprite_scale = 1,
    sprite_oy = 12,
    trigger = true,
    droppable_attr = 'health',
    droppable_ammount = 6
  },
  yellow_potion = {
    _inherit = 'default',
    sprite_image = "sprites",
    sprite_frame = {
      13,
      2
    },
    sprite_color = {
      255,
      255,
      255
    },
    sprite_scale = 1,
    sprite_oy = 12,
    trigger = true,
    droppable_attr = 'health',
    droppable_ammount = 6
  },
  pc = {
    _inherit = 'chara',
    player = true,
    acc = 1024,
    health = 20,
    health_max = 20,
    name = "pc",
    melee_attack = 0,
    melee_damage = 5,
    melee_range = 24,
    anim_right = true,
    anim_track = 'idle',
    anim_tracks = {
      idle = {
        1,
        3
      },
      walk = {
        '2-3',
        3
      },
      melee = {
        '1-4',
        4
      },
      range = {
        '1-4',
        5
      }
    },
    ammo_max = 36,
    ammo = 36
  },
  enemy = {
    _inherit = 'default',
    sprite_image = "sprites",
    sprite_frame = {
      '2-3',
      3
    },
    sprite_color = {
      255,
      255,
      255
    },
    vx = 0,
    vy = 0,
    ax = 0,
    ay = 0,
    acc = 512,
    health = 10,
    anim_right = true,
    anim_track = 'idle'
  },
  snake = {
    _inherit = 'enemy',
    health = 6,
    sprite_frame = {
      9,
      1
    },
    name = 'snake',
    script = 'snake',
    acc = 128,
    speedMax = 12,
    melee_attack = 0,
    melee_damage = 1,
    melee_range = 12,
    sprite_oy = 12,
    anim_track = 'idle',
    anim_tracks = {
      idle = {
        '10-11',
        1
      },
      walk = {
        '12-15',
        1
      },
      attack = {
        '16-19',
        1
      }
    },
    width = 12,
    height = 12
  },
  fox = {
    name = 'fox',
    _inherit = 'enemy',
    health = 6,
    sprite_frame = {
      9,
      2
    }
  },
  bullet = {
    _inherit = 'default',
    name = 'bullet',
    vx = 0,
    vy = 0,
    ax = 0,
    ay = 0,
    acc = 2048,
    sprite_image = "sprites",
    sprite_frame = {
      6,
      2
    },
    sprite_color = {
      255,
      255,
      255
    },
    sprite_oy = 12,
    sprite_ox = 12,
    speedMax = 2048,
    solid = false,
    drag = 1,
    script = 'bullet'
  }
}
local EntityFactory
EntityFactory = function(data, defaults)
  if data == nil then
    data = { }
  end
  local default = {
    tx = 0,
    ty = 0,
    rot = 0
  }
  if defaults ~= nil then
    local tmp = TYPES[defaults]
    local inherits = {
      tmp
    }
    while tmp._inherit ~= nil do
      tmp = TYPES[tmp._inherit]
      table.insert(inherits, 1, tmp)
    end
    for _index_0 = 1, #inherits do
      local d = inherits[_index_0]
      deep_extend(default, d)
    end
  end
  local e = default
  deep_extend(e, data)
  return e
end
return {
  EntityFactory = EntityFactory
}
local debugGraph = require("lib/debugGraph")
local bind_methods
bind_methods = require("lib/moon").bind_methods
local TimerContext
TimerContext = require("timer").TimerContext
local Controls
Controls = require("input").Controls
local GameEngine
do
  local _class_0
  local _parent_0 = TimerContext
  local _base_0 = {
    add_state = function(self, name, state)
      self.states[name] = state
      if self.state == nil then
        self.state = state
      end
    end,
    load_state = function(self, name, arg)
      if self.state == nil then
        self.state:unload()
      end
      self.state = self.states[name]
      self.state:resize(self.width, self.height)
      return self.state:load(arg)
    end,
    start = function(self, lovelib)
      lovelib.draw = function()
        return self:draw()
      end
      lovelib.update = function(dt)
        for name, control in pairs(Controls) do
          control:update()
        end
        return self:_update(dt)
      end
      lovelib.resize = bind_methods(self).resize
      return lovelib.mouse.setVisible(false)
    end,
    draw = function(self)
      return self.state:draw()
    end,
    _update = function(self, dt)
      _class_0.__parent.__base._update(self, dt)
      return self.state:_update(dt)
    end,
    resize = function(self, w, h)
      self.width = w
      self.height = h
      print(w, h)
      for name, state in pairs(self.states) do
        print(name, state)
        state:resize(w, h)
      end
    end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__base)
  _class_0 = setmetatable({
    __init = function(self)
      _class_0.__parent.__init(self)
      self.states = { }
      self.state = nil
      self.width = love.graphics.getWidth()
      self.height = love.graphics.getHeight()
    end,
    __base = _base_0,
    __name = "GameEngine",
    __parent = _parent_0
  }, {
    __index = function(cls, name)
      local val = rawget(_base_0, name)
      if val == nil then
        local parent = rawget(cls, "__parent")
        if parent then
          return parent[name]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  if _parent_0.__inherited then
    _parent_0.__inherited(_parent_0, _class_0)
  end
  GameEngine = _class_0
end
return {
  GameEngine = GameEngine
}
local bind_methods
bind_methods = require("lib/moon").bind_methods
local TimerContext
TimerContext = require("timer").TimerContext
local GameMode
do
  local _class_0
  local _parent_0 = TimerContext
  local _base_0 = {
    draw = function(self)
      return nil
    end,
    _update = function(self, dt)
      _class_0.__parent.__base._update(self, dt)
      return self:update(dt)
    end,
    update = function(self, dt)
      return nil
    end,
    resize = function(self, w, h)
      return nil
    end,
    load = function(self)
      return nil
    end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__base)
  _class_0 = setmetatable({
    __init = function(self, state)
      _class_0.__parent.__init(self)
      self.state = state
      self.methods = bind_methods(self)
      local mt = getmetatable(self)
      local newindex
      newindex = function(t, k)
        local val = mt[k]
        if val == nil then
          val = state[k]
        end
        return val
      end
      mt.__index = newindex
    end,
    __base = _base_0,
    __name = "GameMode",
    __parent = _parent_0
  }, {
    __index = function(cls, name)
      local val = rawget(_base_0, name)
      if val == nil then
        local parent = rawget(cls, "__parent")
        if parent then
          return parent[name]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  if _parent_0.__inherited then
    _parent_0.__inherited(_parent_0, _class_0)
  end
  GameMode = _class_0
end
return {
  GameMode = GameMode
}
local bind_methods
bind_methods = require("lib/moon").bind_methods
local TimerContext
TimerContext = require("timer").TimerContext
local GameState
do
  local _class_0
  local _parent_0 = TimerContext
  local _base_0 = {
    init = function(self)
      return nil
    end,
    load = function(self)
      return nil
    end,
    unload = function(self)
      return nil
    end,
    draw = function(self)
      return nil
    end,
    _update = function(self, dt)
      _class_0.__parent.__base._update(self, dt)
      return self:update(dt)
    end,
    update = function(self, dt)
      return nil
    end,
    resize = function(self, w, h)
      return nil
    end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__base)
  _class_0 = setmetatable({
    __init = function(self, engine)
      _class_0.__parent.__init(self)
      self.methods = bind_methods(self)
      self.engine = engine
      return self:init()
    end,
    __base = _base_0,
    __name = "GameState",
    __parent = _parent_0
  }, {
    __index = function(cls, name)
      local val = rawget(_base_0, name)
      if val == nil then
        local parent = rawget(cls, "__parent")
        if parent then
          return parent[name]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  if _parent_0.__inherited then
    _parent_0.__inherited(_parent_0, _class_0)
  end
  GameState = _class_0
end
local QuitState
do
  local _class_0
  local _parent_0 = GameState
  local _base_0 = {
    load = function(self)
      return love.event.quit()
    end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__base)
  _class_0 = setmetatable({
    __init = function(self, engine)
      return _class_0.__parent.__init(self, engine)
    end,
    __base = _base_0,
    __name = "QuitState",
    __parent = _parent_0
  }, {
    __index = function(cls, name)
      local val = rawget(_base_0, name)
      if val == nil then
        local parent = rawget(cls, "__parent")
        if parent then
          return parent[name]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  if _parent_0.__inherited then
    _parent_0.__inherited(_parent_0, _class_0)
  end
  QuitState = _class_0
end
return {
  GameState = GameState,
  MainMenuState = MainMenuState,
  QuitState = QuitState
}
local tactile = require('lib/tactile')
pcall(function()
  return love.joystick.loadGamepadMappings('lib/gamecontrollerdb.txt')
end)
local Controls = {
  Horizontal = tactile.newControl():addAxis(tactile.gamepadAxis(1, 'leftx')):addButtonPair(tactile.keys('a', 'left'), tactile.keys('d', 'right')),
  Vertical = tactile.newControl():addAxis(tactile.gamepadAxis(1, 'lefty')):addButtonPair(tactile.keys('w', 'up'), tactile.keys('s', 'down')),
  Primary = tactile.newControl():addAxis(tactile.gamepadAxis(1, 'triggerleft')):addAxis(tactile.gamepadAxis(1, 'triggerright')):addButton(tactile.gamepadButtons(1, 'a')):addButton(tactile.keys('x')):addButton(tactile.keys('return')):addButton(tactile.keys('space')),
  Secondary = tactile.newControl():addAxis(tactile.gamepadAxis(1, 'triggerleft')):addAxis(tactile.gamepadAxis(1, 'triggerright')):addButton(tactile.gamepadButtons(1, 'b')):addButton(tactile.keys('z')),
  Tertiary = tactile.newControl():addButton(tactile.keys('c')),
  Quaternary = tactile.newControl():addButton(tactile.keys('v'))
}
return {
  Controls = Controls
}
local GameEngine
GameEngine = require("gameengine").GameEngine
local GameState, QuitState
do
  local _obj_0 = require("gamestate")
  GameState, QuitState = _obj_0.GameState, _obj_0.QuitState
end
local PlayState
PlayState = require("playstate").PlayState
local Controls
Controls = require("input").Controls
local g = love.graphics
local MainMenuState
do
  local _class_0
  local _parent_0 = GameState
  local _base_0 = {
    update = function(self, dt)
      if Controls.Vertical:pressed(1) then
        if self.selected < #self.menu - 1 then
          self.selected = self.selected + 1
        end
      else
        if Controls.Vertical:pressed(-1) then
          if self.selected > 0 then
            self.selected = self.selected + -1
          end
        else
          if Controls.Primary:pressed() then
            return self.menu[self.selected + 1].func()
          end
        end
      end
    end,
    draw = function(self)
      g.setColor(0, 0, 32)
      g.rectangle("fill", 0, 0, self.engine.width, self.engine.height)
      g.setColor(255, 255, 255)
      g.push()
      g.translate(self.engine.width / 2 - 200, self.engine.height / 2 - self.fontsize)
      g.setFont(self.font)
      local i = 0
      local _list_0 = self.menu
      for _index_0 = 1, #_list_0 do
        local item = _list_0[_index_0]
        if self.selected == i then
          g.setColor(255, 255, 255)
        else
          g.setColor(170, 170, 255)
        end
        g.printf(item.label, 0, i * (self.fontsize + self.fontpadding), 400, "center")
        i = i + 1
      end
      g.pop()
      return g.setColor(255, 255, 255)
    end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__base)
  _class_0 = setmetatable({
    __init = function(self, engine, menu)
      _class_0.__parent.__init(self, engine)
      self.menu = menu
      self.selected = 0
      self.fontsize = 24
      self.fontpadding = 16
      self.font = love.graphics.newFont("assets/fonts/PressStart2P-Regular.ttf", self.fontsize)
    end,
    __base = _base_0,
    __name = "MainMenuState",
    __parent = _parent_0
  }, {
    __index = function(cls, name)
      local val = rawget(_base_0, name)
      if val == nil then
        local parent = rawget(cls, "__parent")
        if parent then
          return parent[name]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  if _parent_0.__inherited then
    _parent_0.__inherited(_parent_0, _class_0)
  end
  MainMenuState = _class_0
end
love.load = function(args)
  for _, flag in ipairs(args) do
    if flag == "-f" or flag == "--foo" then
      local foo = true
    end
  end
  local game = GameEngine()
  local menu = {
    {
      label = "Play",
      func = function()
        return game:load_state("game")
      end
    },
    {
      label = "Quit",
      func = function()
        return game:load_state("quit")
      end
    }
  }
  game:add_state("mainmenu", MainMenuState(game, menu))
  if PlayState ~= nil then
    game:add_state("game", PlayState(game))
  end
  game:add_state("quit", QuitState(game))
  return game:start(love)
end
local talkback = require('lib/talkback')
local lume = require('lib/lume')
local bresenham = require('lib/bresenham')
local Delaunay = require('lib/delaunay')
local Point = Delaunay.Point
local fov = require("lib/rsfov")
local bind_methods
bind_methods = require("lib/moon").bind_methods
local g = love.graphics
local Map
do
  local _class_0
  local _base_0 = {
    pov = function(self, x, y)
      for x = 1, self.width do
        for y = 1, self.height do
          if self.viz[x][y] == 1 then
            self.viz[x][y] = 2
          end
        end
      end
      local tx = math.floor(x / self.tilesize)
      local ty = math.floor(y / self.tilesize)
      fov(tx + 1, ty + 1, 7, self.methods.is_opaque, self.methods.set_visible)
      self.tilebatchdirty = true
    end,
    resize_screen = function(self, w, h)
      self.screenwidth = w
      self.screenheight = h
      self.tileviewwidth = math.ceil(self.screenwidth / self.tilesize)
      self.tileviewheight = math.ceil(self.screenheight / self.tilesize)
      self.tilebatch = love.graphics.newSpriteBatch(self.tile_image, self.tileviewwidth * self.tileviewheight)
      self.tilebatchdirty = true
      return print(self.tileviewwidth, self.tileviewheight)
    end,
    make_quads = function(self, image, width, height)
      local quads = { }
      local img_width = image:getWidth()
      local img_height = image:getHeight()
      local cols = img_width / width
      local rows = img_height / height
      for y = 0, rows - 1 do
        for x = 0, cols - 1 do
          table.insert(quads, g.newQuad(x * width, y * height, width, height, img_width, img_height))
        end
      end
      return quads
    end,
    load_sprite = function(self, image, width, height)
      local img = g.newImage('assets/' .. image .. '.png')
      img:setFilter('linear', 'nearest')
      local quads = self:make_quads(img, width, height)
      return img, quads
    end,
    update_tile_batch = function(self, camera)
      self.tilebatch:clear()
      local vieww = self.screenwidth / camera.scale
      local viewh = self.screenheight / camera.scale
      local startx = math.max(1, math.floor((camera.x - vieww / 2) / self.tilesize))
      local starty = math.max(1, math.floor((camera.y - viewh / 2) / self.tilesize))
      local endx = math.min(math.ceil(vieww / self.tilesize) + startx + 1, self.width)
      local endy = math.min(math.ceil(viewh / self.tilesize) + starty + 1, self.height)
      for row = startx, endx do
        for col = starty, endy do
          local x = row - 1
          local y = col - 1
          if self.viz[row][col] > 0 then
            if self.viz[row][col] == 1 then
              self.tilebatch:setColor(255, 255, 255)
            end
            if self.viz[row][col] == 2 then
              self.tilebatch:setColor(128, 128, 128)
            end
            self.tilebatch:add(self.tile_quads[self.tiles[row][col]], math.floor(x * self.tilesize), math.floor(y * self.tilesize))
          end
        end
      end
      self.tilebatchdirty = false
    end,
    is_visible = function(self, x, y)
      local tx = math.floor(x / self.tilesize)
      local ty = math.floor(y / self.tilesize)
      if tx < 0 or tx > self.width or ty < 0 or ty > self.height then
        return false
      end
      return self.viz[tx + 1][ty + 1]
    end,
    get_tile = function(self, x, y)
      local tx = math.floor(x / self.tilesize)
      local ty = math.floor(y / self.tilesize)
      return self.tiles[tx + 1][ty + 1]
    end,
    draw = function(self, camera)
      if self.oldcamera == nil then
        self.oldcamera = { }
        self.oldcamera.x = camera.x
        self.oldcamera.y = camera.y
      end
      g.setColor(255, 255, 255, 255)
      if self.oldcamera.x ~= camera.x or self.oldcamera.y ~= camera.y then
        self.tilebatchdirty = true
      end
      if self.tilebatchdirty then
        self:update_tile_batch(camera)
      end
      self.oldcamera.x = camera.x
      self.oldcamera.y = camera.y
      return love.graphics.draw(self.tilebatch)
    end,
    set_visible = function(self, tx, ty)
      if tx > 0 and tx < self.width and ty > 0 and ty < self.height then
        self.viz[tx][ty] = 1
      end
    end,
    is_opaque = function(self, x, y)
      if x <= 0 or x > self.width or y <= 0 or y >= self.height then
        return false
      end
      return self.tiles[x][y] ~= 3
    end,
    is_solid = function(self, tile, y)
      if y ~= nil then
        tile = self:get_tile(tile, y)
      end
      return tile == 3
    end,
    is_blocker = function(self, tile)
      return tile == 1
    end
  }
  _base_0.__index = _base_0
  _class_0 = setmetatable({
    __init = function(self, width, height, grid, tilemap)
      self.methods = bind_methods(self)
      self.events = talkback.new()
      self.scale = 3
      self.width = (width * self.scale) + 1
      self.height = (height * self.scale) + 1
      self.tiles = { }
      self.viz = { }
      self.tilesize = 16
      self.screenwidth = g.getWidth()
      self.screenheight = g.getHeight()
      self.tile_image, self.tile_quads = self:load_sprite('tiles/tiles', self.tilesize, self.tilesize)
      for row = 0, width do
        for i = 1, self.scale do
          self.viz[(row * self.scale) + i] = { }
          self.tiles[(row * self.scale) + i] = { }
        end
        for col = 0, height do
          if tilemap ~= nil then
            for x = 0, 2 do
              for y = 0, 2 do
                self.viz[(row * self.scale) + x + 1][(col * self.scale) + y + 1] = 0
                self.tiles[(row * self.scale) + x + 1][(col * self.scale) + y + 1] = tilemap[grid[row][col] + 1]
              end
            end
          else
            self.tiles[row][col] = grid[row - 1][col - 1] + 1
          end
        end
      end
      return self:resize_screen(self.screenwidth, self.screenheight)
    end,
    __base = _base_0,
    __name = "Map"
  }, {
    __index = _base_0,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  Map = _class_0
end
local map
map = function(width, height, seed)
  if seed == nil then
    seed = os.time()
  end
  math.randomseed(seed)
  local grid = { }
  for x = 1, width do
    grid[x] = { }
    for y = 1, height do
      grid[x][y] = 0
    end
  end
  local points = { }
  for i = 1, 5 do
    local room = {
      w = lume.round(lume.random(1, 7) * 2 + 1),
      h = lume.round(lume.random(1, 3) * 2 + 1)
    }
    local hw = room.w / 2
    local hh = room.h / 2
    local done = false
    while not done do
      room.x = lume.round(lume.random(1, width - 1))
      room.y = lume.round(lume.random(1, height - 1))
      if room.x - hw > 0 and room.x + hw < width and room.y - hh > 0 and room.y + hh < height then
        done = true
        for x = math.floor(room.x - hw) - 1, math.ceil(room.x + hw) + 1 do
          if done == false or x <= 0 or x >= height then
            done = false
            break
          end
          for y = math.floor(room.y - hh) - 1, math.ceil(room.y + hh) + 1 do
            if grid[x][y] == 1 or grid[x][y] == nil then
              done = false
              break
            end
          end
        end
      end
      if done then
        table.insert(points, Point(room.x, room.y))
      end
    end
    for x = math.floor(room.x - hw), math.ceil(room.x + hw) do
      for y = math.floor(room.y - hh), math.ceil(room.y + hh) do
        grid[x][y] = 1
      end
    end
  end
  local triangles = Delaunay.triangulate(unpack(points))
  local draw
  draw = function(x, y)
    grid[x][y] = 1
    return true
  end
  for i, triangle in ipairs(triangles) do
    local _list_0 = {
      triangle.e1,
      triangle.e2,
      triangle.e3
    }
    for _index_0 = 1, #_list_0 do
      local edge = _list_0[_index_0]
      local a = edge.p1
      local b = edge.p2
      local x, y = edge:getMidPoint()
      local mid = Point(lume.round(x), lume.round(y))
      local horz = math.random() > 0.5
      if horz then
        bresenham.los(b.x, b.y, b.x, mid.y, draw)
        bresenham.los(a.x, mid.y, b.x, mid.y, draw)
        bresenham.los(a.x, mid.y, a.x, a.y, draw)
      else
        bresenham.los(mid.x, a.y, a.x, a.y, draw)
        bresenham.los(mid.x, a.y, mid.x, b.y, draw)
        bresenham.los(b.x, b.y, mid.x, b.y, draw)
      end
    end
  end
  for y = 1, height do
    local line = ""
    for x = 1, width do
      local t = '0'
      if grid[x][y] == 1 then
        t = '.'
      end
      line = line .. t
    end
  end
  return grid
end
return {
  map = map,
  Map = Map
}
local flux = require('lib/flux')
local tiny = require('lib/tiny')
local lume = require('lib/lume')
local bump = require('lib/bump')
local gamera = require('lib/gamera')
local talkback = require('lib/talkback')
local Vector = require('lib/vector-light')
local EntityFactory
EntityFactory = require("entity").EntityFactory
local deep_copy, deep_extend, q
do
  local _obj_0 = require("utils")
  deep_copy, deep_extend, q = _obj_0.deep_copy, _obj_0.deep_extend, _obj_0.q
end
local bind_methods
bind_methods = require("lib/moon").bind_methods
local GameState
GameState = require("gamestate").GameState
local GameMode
GameMode = require("gamemode").GameMode
local Controls
Controls = require("input").Controls
local Map, map
do
  local _obj_0 = require("map")
  Map, map = _obj_0.Map, _obj_0.map
end
local Desert, Dungeon
do
  local _obj_0 = require("dungeon")
  Desert, Dungeon = _obj_0.Desert, _obj_0.Dungeon
end
local TriggerSystem, InteractSystem, AnimSystem, RenderSystem, MoveSystem, PlayerSystem, MeleeSystem, LivingSystem, ScriptSystem
do
  local _obj_0 = require("systems")
  TriggerSystem, InteractSystem, AnimSystem, RenderSystem, MoveSystem, PlayerSystem, MeleeSystem, LivingSystem, ScriptSystem = _obj_0.TriggerSystem, _obj_0.InteractSystem, _obj_0.AnimSystem, _obj_0.RenderSystem, _obj_0.MoveSystem, _obj_0.PlayerSystem, _obj_0.MeleeSystem, _obj_0.LivingSystem, _obj_0.ScriptSystem
end
local g = love.graphics
local GameOverMode
do
  local _class_0
  local _parent_0 = GameMode
  local _base_0 = {
    update = function(self, dt)
      return self.state.world:update(dt)
    end,
    start = function(self)
      self.state.mode = "gameover"
      self.anim = {
        text_alpha = 0,
        bg_alpha = 0
      }
      return self.state.flux:to(self.anim, 1, {
        bg_alpha = 72
      }):after(self.anim, 1, {
        text_alpha = 255
      })
    end,
    draw = function(self)
      self.state:draw_game()
      g.setColor(255, 0, 0, self.anim.bg_alpha)
      g.rectangle("fill", 0, 0, self.state.engine.width, self.state.engine.height)
      g.setColor(255, 255, 255, self.anim.text_alpha)
      local width = 500
      return g.printf("Game Over", self.state.engine.width / 2 - width / 2, self.state.engine.height / 2, width, "center")
    end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__base)
  _class_0 = setmetatable({
    __init = function(self, state)
      _class_0.__parent.__init(self, state)
      self.anim = {
        text_alpha = 0,
        bg_alpha = 0
      }
      return state.events:listen("gameover", bind_methods(self).start)
    end,
    __base = _base_0,
    __name = "GameOverMode",
    __parent = _parent_0
  }, {
    __index = function(cls, name)
      local val = rawget(_base_0, name)
      if val == nil then
        local parent = rawget(cls, "__parent")
        if parent then
          return parent[name]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  if _parent_0.__inherited then
    _parent_0.__inherited(_parent_0, _class_0)
  end
  GameOverMode = _class_0
end
local PauseMode
do
  local _class_0
  local _parent_0 = GameMode
  local _base_0 = {
    update = function(self)
      if Controls.Primary:pressed() then
        self.state.mode = 'play'
      end
    end,
    draw = function(self)
      self.state:draw_bg()
      g.setColor(0, 0, 0, 128)
      g.rectangle("fill", 0, 0, self.state.engine.width, self.state.engine.height)
      g.setColor(255, 255, 255, 255)
      local width = 500
      return g.printf("Paused - Press Spacebar to unpause.", self.state.engine.width / 2 - width / 2, self.state.engine.height / 2, width, "center")
    end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__base)
  _class_0 = setmetatable({
    __init = function(self, ...)
      return _class_0.__parent.__init(self, ...)
    end,
    __base = _base_0,
    __name = "PauseMode",
    __parent = _parent_0
  }, {
    __index = function(cls, name)
      local val = rawget(_base_0, name)
      if val == nil then
        local parent = rawget(cls, "__parent")
        if parent then
          return parent[name]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  if _parent_0.__inherited then
    _parent_0.__inherited(_parent_0, _class_0)
  end
  PauseMode = _class_0
end
local PlayMode
do
  local _class_0
  local _parent_0 = GameMode
  local _base_0 = {
    update = function(self, dt)
      return self.state.world:update(dt)
    end,
    draw = function(self)
      return self.state:draw_game()
    end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__base)
  _class_0 = setmetatable({
    __init = function(self, ...)
      return _class_0.__parent.__init(self, ...)
    end,
    __base = _base_0,
    __name = "PlayMode",
    __parent = _parent_0
  }, {
    __index = function(cls, name)
      local val = rawget(_base_0, name)
      if val == nil then
        local parent = rawget(cls, "__parent")
        if parent then
          return parent[name]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  if _parent_0.__inherited then
    _parent_0.__inherited(_parent_0, _class_0)
  end
  PlayMode = _class_0
end
local PlayState
do
  local _class_0
  local _parent_0 = GameState
  local _base_0 = {
    init = function(self)
      self.events = talkback.new()
      self.modes = {
        play = PlayMode(self),
        pause = PauseMode(self),
        gameover = GameOverMode(self)
      }
      self.mode = 'play'
      self.ready = false
      self.map = nil
      self.load_progress = 1
      self._nextid = 0
      self.flux = flux.group()
      self.events:listen("player created", self.methods.game_start)
      return self.events:listen("player killed", self.methods.game_over)
    end,
    draw = function(self)
      return self.modes[self.mode]:draw()
    end,
    draw_game = function(self)
      if self.ready and self.load_progress < 1 then
        self:draw_bg()
        self.cam:draw(function(l, t, w, h)
          self.map:draw(self.cam)
          if self.renderer.entities then
            return self.renderer:draw()
          end
        end)
        self:draw_ui()
        g.setColor(0, 0, 0, 255 * self.load_progress)
        g.rectangle("fill", 0, 0, self.engine.width, self.engine.height)
        return g.setColor(255, 255, 255, 255)
      else
        g.setColor(0, 0, 0, 255)
        g.rectangle("fill", 0, 0, self.engine.width, self.engine.height)
        return g.setColor(255, 255, 255, 255)
      end
    end,
    draw_ui = function(self)
      if self.pc ~= nil and self.ready then
        g.push()
        g.translate(self.engine.width - 260, 0)
        g.printf(self.pc.ammo .. "/" .. self.pc.ammo_max, 0, 30, 120, "center")
        g.pop()
        g.push()
        g.translate(self.engine.width - 120, 0)
        g.setColor(255, 255, 255)
        g.rectangle("line", 10, 10, 100, 40)
        g.setColor(255, 0, 0)
        g.rectangle("fill", 10, 10, (self.pc.health / self.pc.health_max) * 100, 40)
        g.setColor(255, 255, 255)
        g.pop()
        if self.pc.interact_label ~= nil then
          g.push()
          g.translate(self.engine.width / 2 - 200, self.engine.height * 0.8)
          g.printf(self.pc.interact_label, 0, 0, 400, "center")
          return g.pop()
        end
      end
    end,
    draw_bg = function(self)
      g.setColor(0, 0, 0)
      g.rectangle("fill", 0, 0, self.engine.width, self.engine.height)
      return g.setColor(255, 255, 255)
    end,
    resize = function(self, w, h)
      if self.map ~= nil then
        return self.map:resize_screen(w, h)
      end
    end,
    update = function(self, dt)
      self.flux:update(dt)
      return self.modes[self.mode]:_update(dt)
    end,
    load = function(self, level, seed)
      self:reset()
      self:init_game()
      if level == nil then
        return self:new_game()
      else
        return self:load_game(level, seed)
      end
    end,
    create_entity = function(self, data, tmpl)
      local e = EntityFactory(data, tmpl)
      e.id = self._nextid
      self._nextid = self._nextid + 1
      e.events = talkback.new()
      e.events:listen("kill", function()
        return self.methods.remove_entity(e)
      end)
      return self.world:add(e)
    end,
    remove_entity = function(self, e)
      self.world:remove(e)
      if self.physics:hasItem(e) then
        return self.physics:remove(e)
      end
    end,
    search = function(self, tx, ty, radius, filter)
      local _results = self.physics:queryRect(tx - radius, ty - radius, radius * 2, radius * 2, filter)
      local results = { }
      for _index_0 = 1, #_results do
        local e = _results[_index_0]
        local length = Vector.dist(tx, ty, e.tx, e.ty)
        if length <= radius then
          table.insert(results, e)
        end
      end
      return results
    end,
    init_game = function(self)
      self.world = tiny.world()
      self.physics = bump.newWorld()
      self.cam = gamera.new(0, 0, 1000, 1000)
      self.cam.scale = 2
      self.cam:setPosition(500, 500)
      self.renderer = RenderSystem(self)
      self.world:add(self.renderer)
      self.world:add(MoveSystem(self))
      self.world:add(PlayerSystem(self))
      self.world:add(MeleeSystem(self))
      self.world:add(LivingSystem(self))
      self.world:add(AnimSystem(self))
      self.world:add(ScriptSystem(self))
      self.world:add(InteractSystem(self))
      return self.world:add(TriggerSystem(self))
    end,
    get_spawn_location = function(self)
      local tx = lume.round(lume.random(1, self.map.width))
      local ty = lume.round(lume.random(1, self.map.height))
      while self.map:is_solid(self.map.tiles[tx][ty]) do
        tx = lume.round(lume.random(1, self.map.width))
        ty = lume.round(lume.random(1, self.map.height))
      end
      return tx * self.map.tilesize, ty * self.map.tilesize
    end,
    game_start = function(self, pc)
      self.pc = pc
      if self.playthrough.pc ~= nil then
        self.pc.health = self.playthrough.pc.health
        self.playthrough.pc = nil
      end
    end,
    game_over = function(self)
      self.events:say("gameover")
      return self:Timer(3, function()
        return self.engine:load_state("mainmenu")
      end)
    end,
    new_game = function(self)
      self.playthrough = {
        seed = os.time()
      }
      local w = 11
      local h = 11
      local grid, tilemap, entities = Desert(w, h, self.playthrough.seed)
      return self:create_map(grid, tilemap, entities)
    end,
    load_game = function(self, typ, seed)
      seed = seed or 0
      local map_table = {
        dungeon = Dungeon,
        desert = Desert
      }
      local w = 27
      local h = 21
      if typ == desert then
        w = 11
        h = 11
      end
      local grid, tilemap, entities = map_table[typ](w, h, self.playthrough.seed + seed)
      return self:create_map(grid, tilemap, entities)
    end,
    create_map = function(self, grid, tilemap, entities)
      self.map = Map(grid.width, grid.height, grid.grid, tilemap)
      self.cam:setWorld(0, 0, self.map.width * self.map.tilesize, self.map.height * self.map.tilesize)
      for x = 1, self.map.width do
        for y = 1, self.map.height do
          local tile = self.map.tiles[x][y]
          if self.map:is_solid(tile) then
            self.physics:add({
              name = "tile" .. x .. "x" .. y,
              tile = tile,
              events = self.map.events
            }, (x - 1) * self.map.tilesize, (y - 1) * self.map.tilesize, self.map.tilesize, self.map.tilesize)
          end
        end
      end
      for _index_0 = 1, #entities do
        local e = entities[_index_0]
        e.data = e.data or { }
        deep_extend(e.data, {
          tx = (e.x + 0.5) * self.map.tilesize * self.map.scale,
          ty = (e.y + 0.5) * self.map.tilesize * self.map.scale
        })
        self:create_entity(e.data, e.type)
      end
      self.ready = true
      self.mode = 'play'
      return self.flux:to(self, 1, {
        load_progress = 0
      })
    end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__base)
  _class_0 = setmetatable({
    __init = function(self, ...)
      return _class_0.__parent.__init(self, ...)
    end,
    __base = _base_0,
    __name = "PlayState",
    __parent = _parent_0
  }, {
    __index = function(cls, name)
      local val = rawget(_base_0, name)
      if val == nil then
        local parent = rawget(cls, "__parent")
        if parent then
          return parent[name]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  if _parent_0.__inherited then
    _parent_0.__inherited(_parent_0, _class_0)
  end
  PlayState = _class_0
end
return {
  PlayState = PlayState
}
local fov = require("lib/rsfov")
local flux = require('lib/flux')
local tiny = require('lib/tiny')
local lume = require('lib/lume')
local bump = require('lib/bump')
local anim8 = require('lib/anim8')
local gamera = require('lib/gamera')
local talkback = require('lib/talkback')
local Vector = require('lib/vector-light')
local bind_methods
bind_methods = require("lib/moon").bind_methods
local GameMode
GameMode = require("gamemode").GameMode
local Controls
Controls = require("input").Controls
local deep_copy, pprint
do
  local _obj_0 = require("utils")
  deep_copy, pprint = _obj_0.deep_copy, _obj_0.pprint
end
local g = love.graphics
local SPRITE_CACHE = { }
local SCRIPT_CACHE = { }
local TriggerSystem
TriggerSystem = function(state)
  local sys = tiny.processingSystem()
  sys.filter = tiny.requireAll("trigger")
  sys.onAdd = function(self, e)
    e.width, e.height = 12, 12
    e.solid = false
    if not state.physics:hasItem(e) then
      state.physics:add(e, e.tx - e.width / 2, e.ty - e.height / 2, e.width, e.height)
    end
    return e.events:listen("collide", function(o)
      if o.name == "pc" then
        e.events:say("kill")
        if e.droppable_attr then
          o[e.droppable_attr] = math.min(o[e.droppable_attr] + e.droppable_ammount, o[e.droppable_attr .. '_max'])
        end
      end
    end)
  end
  sys.process = function(self, e, dt)
    return nil
  end
  return sys
end
local InteractSystem
InteractSystem = function(state)
  local sys = tiny.processingSystem()
  sys.filter = tiny.requireAll("interact")
  sys.onAdd = function(self, e)
    e.width, e.height = 6, 6
    e.highlight_radius = 24
    if not state.physics:hasItem(e) then
      return state.physics:add(e, e.tx - e.width / 2, e.ty - e.height / 2, e.width, e.height)
    end
  end
  sys.preWrap = function(self, dt)
    local _list_0 = self.entities
    for _index_0 = 1, #_list_0 do
      local e = _list_0[_index_0]
      e.highlight = nil
    end
  end
  sys.process = function(self, e, dt)
    return nil
  end
  return sys
end
local ScriptSystem
ScriptSystem = function(state)
  local sys = tiny.processingSystem()
  sys.filter = tiny.requireAll("script")
  sys.onAdd = function(self, e)
    if SCRIPT_CACHE[e.script] == nil then
      local cmpt = require("scripts/" .. e.script)
      SCRIPT_CACHE[e.script] = cmpt(state)
    end
    return SCRIPT_CACHE[e.script]:onAdd(e)
  end
  sys.process = function(self, e, dt)
    return SCRIPT_CACHE[e.script]:update(e, dt)
  end
  return sys
end
local LivingSystem
LivingSystem = function(state)
  local sys = tiny.processingSystem()
  sys.filter = tiny.requireAll("health")
  sys.onAdd = function(self, e)
    e.health_max = e.health_max or e.health
    return e.events:listen('damage', function(info)
      e.sprite_color = {
        255,
        0,
        0
      }
      e.health = e.health - info.damage
      local cb
      cb = function()
        e.sprite_color = {
          255,
          255,
          255
        }
        e.ax = 0
        e.ay = 0
      end
      return state.modes.play:Timer(0.125, cb, 1)
    end)
  end
  sys.process = function(self, e, dt)
    if e.health <= 0 then
      return e.events:say("kill")
    end
  end
  return sys
end
local MeleeSystem
MeleeSystem = function(state)
  local sys = tiny.processingSystem()
  sys.filter = tiny.requireAll("tx", "ty", "melee_attack", "melee_range", "melee_damage")
  sys.onAdd = function(self, e)
    return e.events:listen("attack melee", function()
      local cx = e.tx + math.sin(e.rot) * (e.melee_range / 3)
      local cy = e.ty + math.cos(e.rot) * (e.melee_range / 3)
      local results = state.physics:queryRect(cx - (e.melee_range / 2), cy - (e.melee_range / 2), e.melee_range, e.melee_range, function(o)
        return o.health ~= nil
      end)
      for _index_0 = 1, #results do
        local _continue_0 = false
        repeat
          local o = results[_index_0]
          if o == e then
            _continue_0 = true
            break
          end
          local dx = o.tx - e.tx
          local dy = o.ty - e.ty
          dx, dy = Vector.normalize(dx, dy)
          o.ax = dx * o.acc
          o.ay = dy * o.acc
          o.events:say("damage", {
            damage = e.melee_damage,
            attacker = e
          })
          _continue_0 = true
        until true
        if not _continue_0 then
          break
        end
      end
    end)
  end
  return sys
end
local AnimSystem
AnimSystem = function(state)
  local sys = tiny.processingSystem()
  sys.filter = tiny.requireAll("tx", "ty", "anim_right", "anim_track")
  sys.onAdd = function(self, e)
    return e.events:listen("anim change", function(track, cb)
      if track ~= "walk" and track ~= "idle" then
        e.anim_running = true
      end
      e.anim_track = track
      e.anim = anim8.newAnimation(SPRITE_CACHE[e.sprite_image].grid(unpack(e.anim_tracks[e.anim_track])), 0.1, cb)
      if not e.anim_right then
        return e.anim:flipH()
      end
    end)
  end
  sys.process = function(self, e, dt)
    if e.rot >= 0 then
      if not e.anim_right then
        e.anim_right = true
        return e.anim:flipH()
      end
    else
      if e.anim_right then
        e.anim_right = false
        return e.anim:flipH()
      end
    end
  end
  return sys
end
local RenderSystem
RenderSystem = function(state)
  local sys = tiny.processingSystem()
  sys.filter = tiny.requireAll("tx", "ty", "rot", "sprite_image", "sprite_frame", "sprite_color")
  sys.onAdd = function(self, e)
    if SPRITE_CACHE[e.sprite_image] == nil then
      SPRITE_CACHE[e.sprite_image] = { }
      local image = g.newImage('assets/sprites/' .. e.sprite_image .. '.png')
      image:setFilter('nearest', 'nearest')
      SPRITE_CACHE[e.sprite_image].image = image
      SPRITE_CACHE[e.sprite_image].grid = anim8.newGrid(24, 24, image:getWidth(), image:getHeight())
    end
    e.anim = anim8.newAnimation(SPRITE_CACHE[e.sprite_image].grid(unpack(e.sprite_frame)), 0.1)
    e.sprite_ox = e.sprite_ox or 12
    e.sprite_oy = e.sprite_oy or 22
    e.sprite_scale = e.sprite_scale or 2
  end
  sys.process = function(self, e, dt)
    return e.anim:update(dt)
  end
  sys.draw = function(self)
    local t = { }
    local tkeys = { }
    local _list_0 = self.entities
    for _index_0 = 1, #_list_0 do
      local e = _list_0[_index_0]
      t[e.ty * 1000 + e.tx] = e
    end
    for k in pairs(t) do
      table.insert(tkeys, k)
    end
    table.sort(tkeys)
    for _, k in ipairs(tkeys) do
      self:draw_entity(t[k])
    end
  end
  sys.draw_entity = function(self, e)
    if e.active ~= false and state.map:is_visible(e.tx, e.ty) == 1 then
      g.push()
      g.translate(e.tx, e.ty)
      local base = 0
      if e.highlight ~= nil then
        g.setColor(255, 0, 0)
        e.anim:draw(SPRITE_CACHE[e.sprite_image].image, 2, base, 0, 2, 2, e.sprite_ox, e.sprite_oy)
        e.anim:draw(SPRITE_CACHE[e.sprite_image].image, -2, base, 0, 2, 2, e.sprite_ox, e.sprite_oy)
        e.anim:draw(SPRITE_CACHE[e.sprite_image].image, 0, base + 2, 0, 2, 2, e.sprite_ox, e.sprite_oy)
        e.anim:draw(SPRITE_CACHE[e.sprite_image].image, 0, base - 2, 0, 2, 2, e.sprite_ox, e.sprite_oy)
        g.setColor(255, 255, 255)
      end
      if e.hook then
        g.setColor(255, 0, 0, 255)
        local dx = e.tx - e.hook.tx
        local dy = e.ty - e.hook.ty
        g.line(0, base, -dx, -dy)
      end
      g.setColor(192, 192, 192, 255)
      g.setColor(unpack(e.sprite_color))
      e.anim:draw(SPRITE_CACHE[e.sprite_image].image, 0, base, 0, e.sprite_scale, e.sprite_scale, e.sprite_ox, e.sprite_oy)
      g.setColor(255, 255, 255)
      return g.pop()
    end
  end
  return sys
end
local MoveSystem
MoveSystem = function(state)
  local sys = tiny.processingSystem()
  sys.filter = tiny.requireAll("tx", "ty", "vx", "vy", "ax", "ay")
  sys._listeners = { }
  sys.onAdd = function(self, e)
    e.width, e.height = e.width or 6, e.height or 6
    e.physics_offsetx = e.physics_offsetx or (e.width / 2)
    e.physics_offsety = e.physics_offsety or (e.height / 2)
    e.drag = e.drag or 0.7
    e.speedMax = e.speedMax or 256
    e.vz = e.vz or 0
    e.tz = e.tz or 0
    e.speed = 0
    if not state.physics:hasItem(e) then
      state.physics:add(e, e.tx - e.physics_offsetx, e.ty - e.physics_offsety, e.width, e.height)
    else
      state.physics:update(e, e.tx - e.physics_offsetx, e.ty - e.physics_offsety)
    end
    sys._listeners[e] = e.events:listen("stop", function()
      e.vx = 0
      e.vy = 0
      e.ax = 0
      e.ay = 0
      e.speed = 0
    end)
  end
  sys.onRemove = function(self, e)
    e.events:stopListening(sys._listeners[e])
    sys._listeners[e] = nil
  end
  local filter
  filter = function(e, o)
    if e.solid == false or o.solid == false then
      return "cross"
    end
    return "slide"
  end
  local filterPit
  filterPit = function(e)
    if e.tile == 1 then
      return true
    end
    return false
  end
  sys.process = function(self, e, dt)
    if e.active == false then
      return 
    end
    if e.ax == 0 and e.tz <= 0 then
      e.vx = e.vx * e.drag
      if math.abs(e.vx) < 4 then
        e.vx = 0
      end
    else
      e.vx = e.vx + (e.ax * dt)
    end
    if e.ay == 0 and e.tz <= 0 then
      e.vy = e.vy * e.drag
      if math.abs(e.vy) < 4 then
        e.vy = 0
      end
    else
      e.vy = e.vy + (e.ay * dt)
    end
    e.speed = Vector.len(e.vx, e.vy)
    if e.speed > e.speedMax then
      e.vx, e.vy = Vector.normalize(e.vx, e.vy)
      e.vx = e.vx * e.speedMax
      e.vy = e.vy * e.speedMax
      e.speed = Vector.len(e.vx, e.vy)
    end
    if e.tz > 0 then
      e.vz = e.vz - 1
    end
    local dx = (e.vx * dt)
    local dy = (e.vy * dt)
    local dz = (e.vz * dt)
    if not state.physics:hasItem(e) then
      return 
    end
    local ax, ay, cols = state.physics:move(e, e.tx + dx - e.physics_offsetx, e.ty + dy - e.physics_offsety, filter)
    e.tx = ax + e.physics_offsetx
    e.ty = ay + e.physics_offsety
    if e.vx ~= 0 or e.vy ~= 0 then
      e.rot = math.atan2(e.vx, e.vy)
    end
    for _index_0 = 1, #cols do
      local c = cols[_index_0]
      c.item.events:say("collide", c.other)
      c.other.events:say("collide", c.item)
    end
    if dz ~= 0 or e.tz > 0 then
      e.tz = e.tz + dz
      if (e.tz < 0) then
        e.tz = 0
        e.vz = 0
        local results, len = state.physics:queryRect(e.tx, e.ty, e.width, e.height, filterPit)
        if #results > 0 then
          e.events:say("stop")
          e.events:say("stun")
          e.events:say("fall")
          state.physics:update(e, e.tx, e.ty)
        else
          e.events:say("land")
        end
      end
    end
    return e.events:say("move")
  end
  return sys
end
local PlayerSystem
PlayerSystem = function(state)
  local sys = tiny.processingSystem()
  sys.filter = tiny.requireAll("player", "acc", "ax", "ay")
  sys._listeners = { }
  sys.process = function(self, e, dt)
    e.ax = Controls.Horizontal() * e.acc
    e.ay = Controls.Vertical() * e.acc
    if e.anim_running ~= true then
      if e.vx ~= 0 or e.vy ~= 0 then
        if e.anim_track ~= "walk" then
          e.events:say("anim change", "walk")
        end
      else
        if e.anim_track ~= "idle" then
          e.events:say("anim change", "idle")
        end
      end
    end
    local interactions = state:search(e.tx, e.ty, 64, function(o)
      return o.interact ~= nil
    end)
    local d = 1e6
    local interact = nil
    for _index_0 = 1, #interactions do
      local i = interactions[_index_0]
      local dist = Vector.dist2(e.tx, e.ty, i.tx, i.ty)
      if dist < d then
        d = dist
        interact = i
      end
    end
    if interact ~= nil then
      interact.highlight = true
      e.interact_label = interact.interact.label
    else
      e.interact_label = nil
    end
    if Controls.Primary:pressed() then
      e.events:say("attack melee")
      e.events:say("anim change", "melee", function()
        e.anim_running = false
        return e.events:say("anim change", "idle")
      end)
    end
    if Controls.Secondary:pressed() then
      if e.ammo > 0 then
        e.ammo = e.ammo - 1
        e.events:say("attack ranged")
        e.events:say("anim change", "range", function()
          e.anim_running = false
          return e.events:say("anim change", "idle")
        end)
        d = {
          tx = e.tx + math.sin(e.rot) * 12,
          ty = e.ty - 10 + math.cos(e.rot) * 12,
          vx = math.sin(e.rot) * 2048,
          vy = math.cos(e.rot) * 2048,
          range_attacker = e
        }
        state:create_entity(d, 'bullet')
      end
    end
    if Controls.Tertiary:pressed() then
      if interact ~= nil then
        return interact.events:say("interact", e)
      end
    end
  end
  sys.onAdd = function(self, e)
    e.stun = false
    e.events:listen("stun", function()
      e.stun = true
    end)
    e.events:listen("move", function()
      state.cam:setPosition(math.floor(e.tx), math.floor(e.ty))
      return state.map:pov(math.floor(e.tx), math.floor(e.ty))
    end)
    e.events:listen("fall", function()
      return e.events:say("kill")
    end)
    e.events:listen("kill", function()
      local _list_0 = sys._listeners
      for _index_0 = 1, #_list_0 do
        local evt = _list_0[_index_0]
        state.events:stopListening(evt)
      end
      return state.events:say("player killed", e)
    end)
    return state.events:say("player created", e)
  end
  return sys
end
return {
  TriggerSystem = TriggerSystem,
  InteractSystem = InteractSystem,
  AnimSystem = AnimSystem,
  RenderSystem = RenderSystem,
  MoveSystem = MoveSystem,
  PlayerSystem = PlayerSystem,
  MeleeSystem = MeleeSystem,
  LivingSystem = LivingSystem,
  ScriptSystem = ScriptSystem
}
local _Timer
do
  local _class_0
  local _base_0 = {
    update = function(self, dt, time)
      if time > self.timeout then
        self:callback()
        if self.count > 0 then
          self.count = self.count - 1
          if self.count <= 0 then
            return false
          end
        end
        self.timeout = time + self.interval
      end
      return true
    end
  }
  _base_0.__index = _base_0
  _class_0 = setmetatable({
    __init = function(self, time, interval, callback, count, every)
      if callback == nil then
        callback = nil
      end
      if count == nil then
        count = -1
      end
      if every == nil then
        every = nil
      end
      self.interval = interval
      self.callback = callback
      self.every = every
      self.count = count
      self.timeout = time + interval
    end,
    __base = _base_0,
    __name = "_Timer"
  }, {
    __index = _base_0,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  _Timer = _class_0
end
local TimerContext
do
  local _class_0
  local _base_0 = {
    reset = function(self)
      self.time = 0
      self.timers = { }
    end,
    Timer = function(self, interval, cb, count, every)
      if count == nil then
        count = -1
      end
      if every == nil then
        every = nil
      end
      local t = _Timer(self.time, interval, cb, count, every)
      table.insert(self.timers, t)
      return t
    end,
    _update = function(self, dt)
      self.time = self.time + dt
      local i = 1
      while i <= #self.timers do
        if self.timers[i]:update(dt, self.time) == false then
          table.remove(self.timers, i)
        else
          i = i + 1
        end
      end
    end
  }
  _base_0.__index = _base_0
  _class_0 = setmetatable({
    __init = function(self)
      return self:reset()
    end,
    __base = _base_0,
    __name = "TimerContext"
  }, {
    __index = _base_0,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  TimerContext = _class_0
end
return {
  TimerContext = TimerContext
}
table.shuffle = function(t)
  local rand = math.random
  assert(t, "shuffleTable() expected a table, got nil")
  local iterations = #t
  local j = nil
  for i = iterations, 2, -1 do
    j = rand(i)
    t[i], t[j] = t[j], t[i]
  end
end
math.sign = function(n)
  if n > 0 then
    return 1
  end
  if n < 0 then
    return -1
  end
  return 0
end
local remove_by_val
remove_by_val = function(list, val)
  for idx = #list, 1, -1 do
    if list[idx] == val then
      table.remove(list, idx)
    end
  end
end
local pprint
pprint = function(obj, indent)
  if indent == nil then
    indent = 0
  end
  if type(obj) ~= 'table' then
    return print(obj)
  else
    for k, v in pairs(obj) do
      if type(v) == 'table' then
        print(string.format("%s%s:", string.rep(" ", indent), k))
        pprint(v, indent + 4)
      else
        print(string.format("%s%s: %s", string.rep(" ", indent), k, v))
      end
    end
  end
end
local deep_copy
deep_copy = function(obj, seen)
  if type(obj) ~= 'table' then
    return obj
  end
  if seen and seen[obj] then
    return seen[obj]
  end
  local s = seen or { }
  local res = setmetatable({ }, getmetatable(obj))
  s[obj] = res
  for k, v in pairs(obj) do
    res[deep_copy(k, s)] = deep_copy(v, s)
  end
  return res
end
local deep_extend
deep_extend = function(obj, update)
  for k, v in pairs(update) do
    if type(v) == 'table' then
      if obj[k] == nil then
        obj[k] = deep_copy(v)
      else
        deep_extend(obj[k], v)
      end
    else
      obj[k] = v
    end
  end
end
return {
  remove_by_val = remove_by_val,
  pprint = pprint,
  deep_copy = deep_copy,
  deep_extend = deep_extend
}
   Bud1                                                                      sbwspblob                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            @                                              @                                                @                                                @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  f o n t sbwspblob   bplist00	



]ShowStatusBar[ShowSidebar[ShowPathbar[ShowToolbar[ShowTabView_ContainerShowSidebar\WindowBounds\SidebarWidth_PreviewPaneVisibility			_{{24, 245}, {1381, 541}})5AMYp}                                f o n t slsvPblob  obplist00		DEF_useRelativeDates_showIconPreviewWcolumns_calculateAllSizesXtextSizeZsortColumnXiconSize_viewOptionsVersion		#(-27<		WvisibleUwidthYascendingZidentifier	%	Tname		\dateModified[dateCreated	 "	aTsize	%	'	s	Tkind*	,d	Ulabel/	1K	Wversion4	6,	Xcomments9;^dateLastOpened=>?BWvisibleUwidthYascendingYdateAdded#@(      #@0         , > F Z c n w                      	
$-.017@ACDLUVYZclmop             G                  f o n t slsvpblob  Wbplist00		FGD_useRelativeDates_showIconPreviewWcolumns_calculateAllSizesXtextSizeZsortColumnXiconSize_viewOptionsVersion		#(-27<AXcomments^dateLastOpened[dateCreatedTsizeUlabelTkindWversionTname\dateModified	WvisibleUwidthYascendingUindex,	 "%'	*,	a/	1d		4	6	s	9	;K		>	@	%	 	%D	#@(      #@0         , > F Z c n w               &')*,5689;DEGHJSTVWYbcefhqrtuw             H                  f o n t svSrnlong       s p r i t e sdsclbool    t i l e sdsclbool                                                                                                                                                                                                                                                                                                                                                                                                                                           E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         DSDB                                 `                                                  @                                                @                                                @       	*,	a/	1d		4	6	s	9	;K		>	@	%	 	%D	#@(      #@0         , > F Z c n w               &')*,5689;DEGHJSTVWYbcefhqrtuw             H                  f o n t svSrnlong       s p r i t e sdsclbool    t i l e sdsclbool                                                                                                                                                                                                                                                                                                                                                                                                                                      DSIG       GDEF     GSUB%_  8  dOS/2ht'     `cmap;]    	cvt h    fpgmvd|   gasp       glyfw   headuG 0   6hheaz h   $hmtxzY`   
Flocad   &maxp*     nameA   ~post{u   ]prep                 x{      
 ^J DFLT latn $           	   
 CAT         
             aalt taalt zaalt ccmp ccmp ccmp frac frac frac liga liga liga locl ordn ordn ordn sups sups sups                                                                                        * 4 < D N V ^ f n    0     V h     r                                             "        
         
 
    	          	   	    
                     
           
      u                  	       2     
    @                 xy  {        <               {   I    C     	  I {     <     I {     X   KX  ^ 2                         CYRE       v                                  	                                              6Vj 	A$ GDFi      $ % * - 8 : < B C I T V W [ ` d o p r s w
v {                         qL       H M h |  ~                      sp4<lk nmoE  QNJIH?TURQO    MS9KP&'2 	  R S "!+,-.C\  v8()  t/*W     ! / 1 2 4 J Lh N e g i  n      2    / Ha&5z~/5:_cku%    " & 0 : D t     !!"!!""""""""+"H"`"e%%%%%&&`&c&f&j        0 Jd &5z~ 06;bjr$      & 0 9 D t     !!"!!""""""""+"H"`"d%%%%%&&`&c&e&j                     xTF|  A                                                         '  ~_MSJBA+90$  \              j    "          $  .  0J68:@Zdr|                                                                       6Vj 	A$ GDFi      $ % * - 8 : < B C I T V W [ ` d o p r s w
v {                         qL324<5?rlm &M%npJTk ' 	        !    4 / 1 2  H N J L R MB Q i e g h t U   | ~                    C         
   }               "       #    '  &  )  (  ,  +  7  5  0  6  3  .  9  ;   =  ?  >  @  A  D  F  E  G  P  K  O  S  X  Z  Y  \  _  ^  ]  b  a  n  k  f  m  j  l  q  u  v x  z  y   c }~w0) ! #$%&	      
"'(STUVYZ]^_`bdefghijklnoqprsvwu|[\W{z}~xycamt*+,- X./012345789:;<=>?@ABCDEFGHIJKLMNOPQR6"!#+,*st>7IHh      } }k    
 0+7!!!!#35#}ww}}}kww}}}    }k   K
PX@/
	 p	 
	n  e 

] IK  LKJL@1
	
	~	 
	 |  e 

] IK  LKJLY@    	+53535!33#5!!5#5##}}w}}w}}}}q}}}}w}}    }k    K
PX@<
p  e  e   ] IK]	LK^JL@=
~  e  e   ] IK]	LK^JLY@	+#53#5!#353535333##5##!q}}}}}}}}}}}}wk}}}w}}}}}}}}}    }k     K
PX@:
pn 	 	e  e  ]IK^JL@<
~| 	 	e  e  ]IK^JLY@*  
	  	+#5#53#5!#3535!3##5##!}q}}}}}w}}}}}w}}}}}}w}}}}}       }k   # K
PX@D p  |e  
	
e ] IK ] LK  	^		J	L@E~  |e  
	
e ] IK ] LK  	^		J	LY@"  #"!   	+53535#535!3#33#5!35#!5#5##}}}}w}}}}}}}}w}}}}w}}}}}}}}}}q}}}}    }k     K
PX@=pn  
	
e ]  IK ] LK	^		J	L@?~|  
	
e ]  IK ] LK	^		J	LY@.  
	  	+533533535!33#5!5!5#5##}}}}w}}w}}}k}}}}w}}}}}}}}}      }k    K
PX@=
p  e  e   ]IK]	LK^JL@>
~  e  e   ]IK]	LK^JLY@*  
	  	+#5#5!#353535333##5##!w}q}}}}}}}}}}w}}}}w}}}}}}}}}     }k    K
PX@:pn 
 
e ]   IK ] LK^	JL@<~| 
 
e ]   IK ] LK^	JLY@&  
	  	+5!3535!33#5!5!5#5##}q}}w}}w}}}k}}w}}}}}}}}}      k    ! K
PX@F	
	p   e e 

] IK  ]LK ] JK ]NL@G		~   e e 

] IK  ]LK ] JK ]NLY@%  !!   	+##5!#3535!3##5##!3#53k}}}}w}}}}}w}}}}}}w}}}}}}}}}}}     }k    K
PX@< p e  e ] IK 
] 

LK  ^	JL@=~ e  e ] IK 
] 

LK  ^	JLY@    	+53535353333#5!35#!5#5##}}}}}}}}}}}w}}}}w}}}}}}q}}}}     }k    % K
PX@F ~	n e   e]IK] LK
 ^  J L@G ~	| e   e]IK] LK
 ^  J LY@(  %$#"!   	+#5!#353535#5333#53#5#5##!k}}}}}}}}}}}}w}}w}}}}}}w}}}}}}}    }k   K
PX@9  p  n  
e 
 
e ] IK   LK ]	JL@; ~   |  
e 
 
e ] IK   LK ]	JLY@    	+53535!#3#3!5#35#}}q}}}}q}}}}}w    }k    G@D  e  		e  e  ]   IK ]
JL    	+5!3#3#!5!!5!}}}}ww}k}}}     }k  Q@Ne	 
	 e ] IK ] LK 

^JL    	+75#5#3535!3#5##3353#}}}}}}}}}}}w}}}}}}}}}}     }k  # K
PX@D  pe  e
e   ] IK ]LK 	^ 		J	L@E   ~e  e
e   ] IK ]LK 	^ 		J	LY@"##"! 	+#53#5##3353#!5#5#535353533q}}}}}}}}}}}k}}}}}}}}}}}}}}}}}     }k # a@^  e	

e  e  e]IK ^JL   # #"! 	+75#5#53535#53353#3#5##3353#}}}}}}}}}}}}}}}}}}}}}}}}}}}     k  # g@d  e
e 	f ] IK ] LK JK ] NL  #"!   	+#5##3353###5#5#5#53535!3#k}}}}}}}}}k}}}}}}}}}}}}}}}      }k ! % l@i e		f  e  e ] IK 

] LK ^JL  %$#" ! ! 	+75#5#53535#535!33#5##3353#35#}}}}}}w}}}}}}}}}}}}}}}}}}}}}}}}q}       }k   j@g
e  ee ]   IK 		] LK ^JL  
	  	+535#5#53535!3#5##3353#w}}}}}}}}k}}}}}}}}}}}}}}}}       }k   K
PX@6 	p p  e 		 ]   IK ] LK ^
JL@8 ~ ~  e 		 ]   IK ] LK ^
JLY@    	+5!33##%353#5#q}}}}}}}k}}}}}}w}    }k   K
PX@@ 

p 		p  e  e ] IK ] LK ^JL@B 

~ 		~  e  e ] IK ] LK ^JLY@    	+7#53!33##'353#5#3#}}}}}}}}}}}}}}w}w}}}}}}w}}     }k   K
PX@D ~ 	p  e  e  		e]IK   LK 
^

J
L@E ~ 		~  e  e  		e]IK   LK 
^

J
LY@    	+535#53353#33##%3535#5#}}}}}}}}}}q}}}}}}}}}}}}}      }k   K
PX@@ 

p 		p  e  e ] IK ] LK ^JL@B 

~ 		~  e  e ] IK ] LK ^JLY@    	+7#53!33##'353#5#3#}}}}}}}}}}}}}}w}w}}}}}}w}}     }k  /@,  e  ]   IK ]JL    	+5!!!!!kq}k}}}     }k   K
PX@0  p  e   ] IK ]
	LK ] JL@1   ~  e   ] IK ]
	LK ] JLY@	+#53!!!!!!53q}}qw}k}}}}}}q}}    }k    K
PX@3 
 		
p  e  ]IK 	]		LK ^ JL@4 
 	 
	~  e  ]IK 	]		LK ^ JLY@"  
	  	+#5#53!!!!!35!}q}}}qw}}}}}}}}}q}}       }k  K
PX@2   p  	
	e]IK  ]  LK 

^JL@3   ~  	
	e]IK  ]  LK 

^JLY@    	+535#53353#3!!!!}}}q}q}}}}}}}}}}}    }k   K
PX@2  p  e ] IK  ]
  LK 	^		J	L@3  ~  e ] IK  ]
  LK 	^		J	LY@    	+53535!33!!!!35#}}w}}q}}}q}}}}}}}}}q}      }k    Q@N  e
 ]  IK ] LK 	]		J	L  
	  	+53353!!!!!}}kqk}}}}q}}}}}      }k   F@C  e ]   IK ] LK ]	JL  
	  
	+53!!!!!wkqk}}q}}}}}      }k   K
PX@1  p  e   ]
IK ]	LK ] JL@2   ~  e   ]
IK ]	LK ] JLY@  
	  	+#5!!!!!!53w}qqw}}}}}}}}q}}     }k   F@C  e ]   IK ] LK ]	JL  
	  
	+5!!!!!!}qkqk}}q}}}}}       k    K
PX@; p e   ]IK ] LK 	] 		JK 

]NL@< ~ e   ]IK ] LK 	] 		JK 

]NLY@    	+!!!!!#5!3#53kq}}}}}}}}}}}q}}}}    }k 	 )@&  e  ]   IKJL   	 		+5!!!!k}k}}       }k  K
PX@> p  p 
 	
	e    e ] IK ] LK ^JL@@ ~   ~ 
 	
	e    e ] IK ] LK ^JLY@    	+75#5#3535!!#335#5!}}}}q}}}w}}}w}}}}}}     }k    K
PX@;  p  	e 
 	
	e  ]IK ]LK ^ JL@<   ~  	e 
 	
	e  ]IK ]LK ^ JLY@&  
	  	+#5#53!!5#5!!5#3535!}q}}}w}w}}}w}}}}}}}}w}}}      }k   K
PX@9p 	  	e    e ] IK ]LK 
^

J
L@:~ 	  	e    e ] IK ]LK 
^

J
LY@    	+75#3535!33!!5#5!35#}}}}w}}w}w}}}}w}}}}}}q}     k  K
PX@I p U  
e 		e ] IK] LK 

] JK   ]NL@J ~ U  
e 		e ] IK] LK 

] JK   ]NLY@    	+3535#5#5#53535!!#335#5!##}}}}}}q}}}w}}}}}}}}}}}}}}       }k   R@O  e  e
 ]   IK ] LK 	]		J	L  
	  	+535#35!!!5#5!w}}w}wk}}}w}}}}     }k  '@$  e  IKJL    	+53!3#!w}kww       }k   3@0  e  e  IKJL    		+53!53#!!5!ww}k}}w}    }k   uK
PX@(	 p  e ] IK  ]
JL@)	  ~  e ] IK  ]
JLY@    	+535!3#5!!5#5##ww}}}}}}w}}   } }k  )@&] IK  ]JL    	+753#5!#3}}}q}}}     }k   J@G 
 e]IK ]IK 	]		J	L    	+53#5!#35!3#}}}}}w}w}}}}}   } }k   @@=   ~   ] IK]
	LK^ JL	+#53#3!53#5353q}}}k}}}}w}}}   } }k    S@P 
 	 
	~  ]IK	]		LK^ JL  
	  	+#5#53#3!53#5353w}}}}}}}}}}}w}}}    } }k  mK
PX@&p IK]LK  	^
		J	L@'~ IK]LK  	^
		J	LY@    	+753#53535333#3}}}}}}}w}}}}}}}    } }k    K@H
 ]  IK] LK	]		J	L  
	  	+5335353#5!#3}k}}}}}w}}}     } }k   @@= ]   IK] LK]	JL  
	  
	+5353#5!#3wk}}}w}}}     } }k   M@J   ~   ]
IK]	LK^ JL  
	  	+#5#3!53#5!53}w}}}}}}w}}}    } }k   @@= ]   IK] LK]	JL  
	  
	+5!53#5!#3}k}}}w}}}     }  k    S@P ~e  ]IK 	] 		JK 

]NL    	+#3!#5#53#53#53k}}}}}}}}}}w}}}}}    } }k    K
PX@- p  ]IK
]LK	] JL@.  ~  ]IK
]LK	] JLY@
		+#53!#533#3!53#533w}}}k}}}}}}}}w}       }k  .@+   U  ] IK ]JL    	+75#53!3#}}w}}}}}}    }k  =@: e   e ] IK 	]
		J	L    	+75#53!##535!3#}}w}}w}}}}}}q}}}}}    }k  K
PX@H p ~ 	
	p  e  	e  ]  IK ] LK 

^JL@J ~ ~ 		~  e  	e  ]  IK ] LK 

^JLY@    	+533535353###333!5#5#}}}}}}}}}}}}k}}}}}}}}}}}}        k  ! K
PX@R p ~ 	
	p  
e 

f ]IK ] LK ] JK   ]NL@T ~ ~ 		~  
e 

f ]IK ] LK ] JK   ]NLY@   !   	+3535#335353##333!#'35#5#}}}}}}}}}}}}}}}}}}}}}}}}}}}   } }k  @   IK ^JL    	+73!}}k}     } }k   /@,  e   ] IK] JL	+#53!!#q}}w}k}}}  } }k   bK
PX@p  ]  IK ^JL@ ~  ]  IK ^JLY@  
	  	+73!3#}}}k}w}     }  k  4@1 U] IK JK   ]NL    	+3535#3!##}}}}}}}     } }k  	 2@/   IK] LK ^JL  		  	+73!53}}k}w       }k  5@2    e IK ] LK ^JL    	+7#5333#!}}}}}}w}w}}    }k  7@4e  IK ] LK
	JL    	+53335353###5#}}}}}}}k}}}}       }k  =@:  e  e  IK ] LK
	JL    	+533333#5#5#5#}}}}}}}k}}}w}}     }k    K@H  e 	 	e   ] IK ]LK 

^JL	+#53#53!5#5##!335q}}}}}w}}w}}k}}}}}q}}     }k  T@Q ~  

e   e	]IKLK  ^  J L    	+!5#5##35#53353##335k}}}}}}}}}q}}}}}}}}     k   \@Y  e ]IK ] LK  ]IK 		
] 

JK ] NL    	+#5#5#5##!3353##53k}}}w}}}}}}}}}}}}        k  M@J 		~  e ]IK ] LK 		JK   
]

N
L    	+35!5#5#5##!3353#w}}}w}}}}}}}}}    }k    W@T 
e  e  ]IK 
]

LK ^	JL	+#533#%#53!5#5##3533335w}}w}}}}}}}}}}k}}}}}}}q}}}}      }k   5@2  e ] IK ]JL    		+75#35!3#%!!}}}q}}w}}q}}}}q      }k    K
PX@2  p	e   ] IK 

]LK ] JL@3   ~	e   ] IK 

]LK ] JLY@	+#53#!5#353533#!!q}}}}}}}wk}}}w}}}}      }k     Z@W 	 	ee  ]IK
LK ^ JL  
	  	+#5#53#!5#3535!3#!!}q}}}}}}}w}}w}}}}}}w}}}}     }k    N@K		~ 
 e 		] IK ] LK 

^JL    	+75#3535!33#35#!!}}}}w}}}}}}w}}w}}}q}w    }k     W@T
e ]  IK ] LK 

	]		J	L  
	  	+533535#35!3#%!!}}}}q}}wk}}}}}w}}}}w    }k    K
PX@3  p	e   ]IK 

]LK ] JL@4   ~	e   ]IK 

]LK ] JLY@"  
	  	+#5#!5#353533#!!w}q}}}}}w}}}}w}}}}       }k     K
PX@5
 		pe  ]IK 	]		LK ^ JL@6
 	 	~e  ]IK 	]		LK ^ JLY@	+#53#53#!5#3533533#!!w}}w}}}}}}}}}}wk}}}}}w}}}}      }k    L@Ie
 ]   IK 		] LK ]JL  
	  	+5!5#35!3#%!!}q}}q}}wk}}}w}}}}w    }k    `@] 
e 
  
e  e 		] IK ] LK ]JL    	+75#35!3#%!#535!3#753}}}q}}w}}}}}}}}q}}}}w}}}}}}       }k    K
PX@5p	  e]IK ]LK 
^

J
L@6~	  e]IK ]LK 
^

J
LY@    	+75#35353353#33#35#!!}}}}}}}}}}}}w}}w}}}}}}}q}w       }k   ?@<   e    e	] IK]
JL    	+75#35!#3#3%3#}}}}}}}q}}}}}q       }k 	  5@2  e  e  ]   IKJL  
 	 		+5!3#!!!}}w}k}}ww       }k   ;@8  e  e   IK ] LKJL    		+53!3#!5!!}}w}k}}}}w      }k    N@K 
	 
 ee ] IK]JL    	+##!5#35!#!35#5353k}}}}q}}}}k}}}q}}}}}}     }k   K
PX@< 

~ p n  	e 	 	e  ]   IK ^JL@> 

~ ~ |  	e 	 	e  ]   IK ^JLY@    	+5!3#33!5#5#3535!}}}}}}}k}}}}}}w}       }k    K
PX@F 
 		
p p n f  e   ] IK 	]		LK ^JL@I 
 	 
	~ ~ | f  e   ] IK 	]		LK ^JLY@	+#53#33!5#5##!533##3q}}}}}}w}k}}}}}}}q}}}}     }k    ! K
PX@I  p 	p 	n f  		e  ]IK ]LK ^
JL@L   ~ 		~ 	| f  		e  ]IK ]LK ^
JLY@,  ! 
	  	+#5#53#33!5#5##!533##3w}w}}}}}}w}}}}}}}}}}}q}}}}        k   K
PX@M 	p 	n  p  e  e 	
	f ] IK LK JK   ^NL@P ~ 		| ~  e  e 	
	f ] IK LK JK   ^NLY@    	+353535#5##!3#33##3535!}}}}}}}}}}}}}}}}}}}q}}      }k  Y@V U 
e 
 
e  U   e 		] IK ]JL    	+75#53!5!5#535!3#5!!3#}}w}}q}}}}}}}}}}}}}}       }k   K
PX@@ 	 	p  e  e e   ] IK ]
LK ] JL@A 	  	~  e  e e   ] IK ]
LK ] JLY@	+#53#!5!5!5#5353533!!q}}}q}}}k}}}}}}}}}}}}}     }k  K
PX@B p  e  f   e	]IK ]
LK   ]JL@C ~  e  f   e	]IK ]
LK   ]JLY@    	+55!5!5#53535#53353#3!!3#q}}}}}}}}}}}}}}}}}}}}}}}}}}      k   f@c 	 	e U   e e 
] 

IK ] LK JK ] NL    	+###5!5#53!5!5#535!!!3#k}}}}w}}qq}}}}}}}}}}}}}      }k   K
PX@@p  e  	f 	 
 	
e ] IK ] LK   ]JL@A~  e  	f 	 
 	
e ] IK ] LK   ]JLY@    	+55!5!5#53535!3!!3#35#q}}}w}}}}}}}}}}}}}}}}q}     } }k  !@  ] IKJL    	+%#5!#w}}}  } }k  5@2  e    e] IKJL    		+%5#53#5!#3#w}}}}}}w}}}  } }k    F@C  ]
IK]	LK ] JL  
	  	+#5#53###5353w}}}}}}}}}}}}  }  k 	  8@5   ~  ]IK JK ] NL  
 	 		+##5##53#k}}}}}q}}     }k  )@&  ]IK ]JL    	+75#3!3#}}w}}}}       }k    ?@<  e   ] IK]
	LK ] JL	+#53#53#!5#3!q}}}}}w}}wk}}}}}       }k     R@O  	e  ]IK	]		LK 

] JL  
	  	+#5#53!5!#!5#3!}q}}}w}}w}}}}}}}}    }k   L@I  e	
e ] IK ]JL    	+535!3#5#5#3!3#}}w}}}w}}}}}}}}ww}      }k    K@H
 ]  IK]LK 	]		J	L  
	  	+533535#3!3#}}}w}k}}}}}}     }k    J@G 
e   ] IK]	LK ] JL
		+#5353!#!5#3!w}}}w}}wk}}}}}      }k     M@J e  ]IK]
LK 		^ JL	+#53#53#!5#353!5#5w}}w}}}}}}}w}k}}}}}}}}}       }k   @@= ]   IK]LK ]	JL  
	  
	+5!5#3!3#}q}w}k}}}}      k    K
PX@3 p e  ]IK 	] 		JK 

]NL@4 ~ e  ]IK 	] 		JK 

]NLY@    	+###5#5#3!3#53k}}}w}}}}}}}}}}}     }k    e@b  ~e 		] IK ]LK  ]LK 

^JL    	+75#3535!33#35#!35#!5#3}}}}w}}}}}}w}}}}}}}}}}}q}w}}}}     }k    H@E
 	e  ]IK	]		LK ^ JL	+#533#%#53#!5#353!w}}w}}}}}}}wk}}}}}}}}      }k  yK
PX@*	 p
  e]IK ]JL@+	  ~
  e]IK ]JLY@    	+%5#5#5#333533###w}}}}}}}}}}}}}}}w}}}       }k  9@6
  e 		]IKJL    	+75#33333##5#5##}}}}}}}}}}}}}}}}}      }k   K
PX@6~ n 	 	e ] IK  LK
^JL@7~  | 	 	e ] IK  LK
^JLY@    	+53535!33!5#35335#5##}}w}}}}}}}}}}}q}}}}}}w}}}}       }k # K
PX@>
p p  e	]IK]LK  ^JL@@
~~  e	]IK]LK  ^JLY@"   # #"! 	+553535#5#53335353##33#5#5##}}}}}}}}}}}}}}}}}}}}}}}}}  } }k  _K
PX@   p]IK ]JL@!  ~]IK ]JLY@    		+%#5#333##w}}}}}w}ww}     } }k    K
PX@2
p  	e   ] IK	]		LK 

] JL@3

~  	e   ] IK	]		LK 

] JLY@	+#53#53###5#5#5335q}}}}}w}}}}k}}}}}     } }k   E@B 	 e ] IK]LK 

	]		J	L    	+%5#5#53535333##3#w}}}}}}}}}}}}}}}ww    } }k    K
PX@.
p ]  IK	]LK ]JL@/
~ ]  IK	]LK ]JLY@&  
	  	+533535#5#53353##}}}}}k}}}}}}    }k  K
PX@K p ~ | | 		|  	

 p ] IK 		] LK 

^JL@M ~ ~ | | 		|  	
	 
~ ] IK 		] LK 

^JLY@    	+5535353535!5!####!}}}}k}}}}}}}}}}}}}}}       }k   K
PX@F   ~ 	p 		| | n   ] IK
]LK^ JL@H   ~ 		~ 		| | |   ] IK
]LK^ JLY@	+#53###!!5353535!5!53q}}}}}w}}}w}k}}}}}}}}}}}}}      }k  K
PX@H ~ p | |   n	]IK]
LK  ^JL@J ~ ~ | |   |	]IK]
LK  ^JLY@    	+55353535!535#53353#3###!}}}}}}}}}w}}}}}}}}}}}}}}}}}      }k   K
PX@> p 		| 		| n ]   IK] LK
^JL@@ ~ 		| 		| | ]   IK] LK
^JLY@"  
	  	+535353535!5!###!w}}}k}}}wk}}}}}}}}}}}}     }k   D@A ~  e    e ] LK ^	JL    
	+75#535!5!5!3%!5!}}}q}w}}}}}}}}}       }k    K
PX@@  p

~  e  e   ] IK ]	LK ^ JL@A   ~

~  e  e   ] IK ]	LK ^ JLY@	+#53!5#535!5!53533!!q}}}}}}wk}}}}}}}}}}       }k     K
PX@C 
 		
p~  e  e  ]IK 	]		LK ^ JL@D 
 	 
	~~  e  e  ]IK 	]		LK ^ JLY@(  
	  	+#5#53!5#535!5!535!3!!}q}}}}}}w}}w}}}}}}}}}}}}}     }k    K
PX@@
		p ~  e    e 

] IK 	] 		LK ^JL@A
	
	~ ~  e    e 

] IK 	] 		LK ^JLY@    	+75#535!5!535!3335#!5!}}}}w}}}}}w}}}}}}}q}}      }k     g@d 		~  e  e ]  IK ] LK 
^

J
L  
	  	+533535#535!5!5!3%!5!}}}}q}wk}}}}}}}}}}}}    }k    K
PX@A  p

~  e  e   ]IK ]	LK ^ JL@B   ~

~  e  e   ]IK ]	LK ^ JLY@$  
	  	+#5!5#535!5!53533!!w}q}}}}w}}}}}}}}}}}    }k    \@Y ~  

e  	e ]   IK ] LK 		^JL  
	  	+5!5#535!5!5!3%!5!}q}}q}wk}}}}}}}}}}     k     K
PX@K~   p  
e 
 
 f ] IK 		] LK ] JK ]NL@L~   ~  
e 
 
 f ] IK 		] LK ] JK ]NLY@!    	+!#5#5#535!5!5!!!3#53k}}}q}w}}}k}}}}}}}}}}}}}    }k    K
PX@Bp 		~  e    e ] IK ]LK 
^

J
L@C~ 		~  e    e ] IK ]LK 
^

J
LY@    	+75#535!5!53535333335#!5!}}}}}}}}}}}}w}}}}}}}}}}}q}}    }k    K
PX@C		p 

~  e    e]IK 	]		LK ^JL@D		~ 

~  e    e]IK 	]		LK ^JLY@    	+75#535!5!5353353#3335#!5!}}}}}}}}}}}w}}}}}}}}}}}q}}     }k    K
PX@1 p	f    e
] LK]JL@2 ~	f    e
] LK]JLY@    	+75#53535#5!3!335#35#}}}q}}}}}}}}}}}}}}w}}     }k   <@9   U  ] IK ] LK ]JL    		+75#3!3#%!!}}}}w}}}}}w       }k  /@,    e ] LK ]JL    	+75#35!!!}}}q}}w}}}     }k   K
PX@0  p  e   ] IK ]
	LK ] JL@1   ~  e   ] IK ]
	LK ] JLY@	+#53!!!5#35353q}}q}}}k}}}}w}}}      }k  K
PX@2 p   
 e]IK 		]LK 

^JL@3 ~   
 e]IK 		]LK 

^JLY@    	+75#3535#53353#3!!}}}}}}}q}}w}}}}}}}}}     k   C@@  e e   ]
LK JK 	] 		N	L    	+!!##5!5#5353#kq}}}}}}}}}}}     }k   K
PX@1
p    e 

] IK ]	LK ^JL@2

~    e 

] IK ]	LK ^JLY@    	+75#3535!33!!35#}}}}w}}q}}}}w}}}}}q}     }k   F@C  e ]   IK ] LK ]	JL  
	  
	+535#35!!!w}}qk}}}w}}}       }k 	  7@4    e IK ] LK ^JL  
 	 		+75#35!53%!!}}}w}}w}}w    }k     m@j 

~ f	  e 

]IK ]IK ]LK ^ JL    	+#!5#53535#5333#53#5!!k}}}}}}}qw}}}}}}w}}}    } 	   I@F    e ]IK	] LK ^
JL

  

 	 		+75#353533#3#}}}}}}}}}w}w}w       }k   C@@ e    e IK 		] LK ^
JL    	+75#35353533#%3#}}}}}}}}w}}}}}}w       }k   =@:   f   e ] LK ]	JL    
	+75#35!3!!!5!}}}q}w}}w}}}}w}     }k    K
PX@9  p  f
 e   ] IK ]	LK ] JL@:   ~  f
 e   ] IK ]	LK ] JLY@	+#53!!!5#353533#!!q}}}}}}wk}}}}w}}}}}      }k     c@` 
 
e  f e  ]IK		LK ^ JL  
	  	+#5#53!!!5#3535!3#!!}q}}}}}}w}}w}}}}}}}w}}}}}    }k   V@S  e  
 
f	   e]IKLK ^JL    	+75#3535#53353#33!!!5!}}}}}}}}}w}}w}}}}}}}}}}w}     }k    V@S
	
	~   f   e 

] IK 	] 		LK ^JL    	+75#3535!33!!35#!5!}}}}w}}}}}w}}w}}}}q}}    }k     `@]  f 	e ]  IK ] LK 		
]

J
L  
	  	+533535#35!3!!!5!}}}}q}wk}}}}}w}}}}w}      }k    U@R 	 	f e ]   IK 

] LK ]JL  
	  	+535#35!3!!!5!w}}q}wk}}}w}}}}w}      }k    K
PX@:  p  f
 e   ]IK ]	LK ] JL@;   ~  f
 e   ]IK ]	LK ] JLY@$  
	  	+#5!!!5#353533#!!w}q}}}}w}}}}}w}}}}}       }k    U@R 	 	f e ]   IK 

] LK ]JL  
	  	+5!5#35!3!!!5!}q}}q}wk}}}w}}}}w}       k     K
PX@D p e e 		] IK   
] 

LK ] JK ]NL@E ~ e e 		] IK   
] 

LK ] JK ]NLY@!    	+!!##5#5#35!#!!3#53k}}}q}w}}}k}}}}}w}}}}}}}     } }k  5@2 ] IK  ]LK ]JL    		+%#53535!#3#w}w}}}}}}}     k   A@>  e  e ] LK JK   ]	NL    
	+35!5!5#535!#!5!}}}}w}}}}}w       k     g@d  	e 	 	e  f  ]IK

LK JK ] NL  
	  	+#5#53#!5!5!5#53535!!!}q}}}}}}}ww}}}}}}}}}}}}      k    \@Y~  e  f ] IK ]
LK JK   	]		N	L    	+35!5!5#53535!33#35#!5!}}}}w}}}}}}w}}}}}}}}        k   K
PX@= p  e  	f ] IK ]LK 		JK   
]

N
L@> ~  e  	f ] IK ]LK 		JK   
]

N
LY@    	+35!5!5#53535353#!#!5!}}}}}}w}w}}}}}}}}}w       k    Y@V  	e 	 	e ]   IK 

] LK JK ]NL  
	  	+535!5!5#535!#!5!w}}}wk}}}}}}}w      }k  -@*   IK ] LK ]JL    	+53!3#!}}k}       }k  9@6  e  e IK ]
	JL    	+7#53533#!3##}}}w}}q}}}}}}w       }k  @@=  e  		e ] IK ]
JL    	+535!3#5##!3#!w}}}}}}}}}}}}w     } }k   =@: ]   IK ] LK]JL  
	  		+5353#5!3w}wk}}}w}}    } }k 	 '@$ ] LK  ]JL   	 		+753#5!3}}w}}w}}     } }k    ;@8  e  e   ] IK	] JL
	+#53#53!535#5!q}}}}}w}wk}}}}}   } }k     I@F 	e 	 	e  ]IK
] JL	+#53#535!!535#5!}}}}w}wk}}}}}}}}     } }k   I@F  e  e ] IK	
]

J
L    	+535!3#5#535#5!3}}w}}}w}}}}}}}}}  } }k    H@E
	 ]  IK ] LK]JL  
	  	+5335353#5!3}}}wk}}}}}w}}    } }k    E@B 	e  e   ] IK
] JL
		+#5353!535#5!w}}}w}wk}}}}}}     k     a@^

~ ]  IK]	LK 

JK ]NL  
	  	+53353#5!5!#5!#}}w}w}w}k}}}}w}}}}    } }k   =@: ]   IK ] LK]JL  
	  		+5!53#5!3}q}wk}}}w}}    }  k     ]@Z 		~e   ] IK ] LK 		
] 

JK ]NL	+#53!#5#535#5!3#53q}}w}}}k}}}}}}}}}}}   } }k      S@Pe  e  ]IK
	] 		J	L  
	  	+#5!#53#%3#3!535#5!q}}}w}}w}}}}}}}}}}}     }     A@> ]   IK ] LK JK ]NL  
	  		+535!#5!#w}w}k}}}}}   }  k   M@J  e  	e ] IK 		JK 
]

N
L    	+535!3#5#5!#5!#}w}}w}w}}}}}}}}w}}     }k  K
PX@: p 
	p  

e  		e   IK ] LK ^JL@< ~ 
	
	~  

e  		e   IK ] LK ^JLY@    	+5335353##33#5#5#}}}}}}}k}}}}}}}}}       k   K
PX@P p 
	p  e  

e U ]   IK 		] LK ] JK ]NL@R ~ 
	
	~  e  

e U ]   IK 		] LK ] JK ]NLY@"    	+5335353##33#5#5#5353#}}}}}}}}}}}}}}}}}}}}}}       }k  K
PX@6 p 
	p  

e  		e  ]  LK ^JL@8 ~ 
	
	~  

e  		e  ]  LK ^JLY@    	+5335353##33#5#5#}}}}}}}q}}}}}}}}}     } }k 	 '@$ ] IK  ]JL   	 		+753#5!3}}w}}q}}       }   >@;   ~   ] IK ]LK	^ JL
	+#53!53#53533}}}}}}k}}}w}}}      }k 	  |K
PX@+	 p ]IK ]IK  ]JL@,	  ~ ]IK ]IK  ]JLY@

  

 	 	
	+553#5!33#}w}}}}q}}w}    }  k  9@6e ] IK JK   ]	NL    
	+3535#53#5!3##}}w}}}}}}}}      }k 	  :@7 ] IK] LK  ]JL

  

 	 			+553#5!353}w}}}q}}w   } }k  =@:   e ] IK ] LK  ]	JL    
	+7535#535#5!3#3}}}}w}}}}}}}}      }k  +@( ]   LK ]JL    	+5!3####}}}}q}    }k 	 '@$  ]   LK ]JL   	 		+5!3#!}}q}     }k   rK
PX@)  p   ] IK ]LK	]JL@*   ~   ] IK ]LK	]JLY@
	+#53#!#!533q}}w}k}q}}}       }k  >@;  		e]IK  LK ^
JL    	+535#53353#33#!}}}}}}q}}}}}}}        kk 	  A@>  e  ]	LK ] JK ] NL  
 	 	
	+#!#!3##53k}}q}}}}        kk  8@5 ~  e LK JK   ]NL    	+35!!#!3#w}}}qq}}       }k   K
PX@-  p]IK 		 ]  LK ^
JL@.  ~]IK 		 ]  LK ^
JLY@    	+535353353#33#!35#}}}}}}}}}}q}}}}}}}q}     }k   5@2  e ] LK ]JL    		+75#35!3#%!!}}}q}}w}}w}}}}w      }k    K
PX@2  p	e   ] IK 

]LK ] JL@3   ~	e   ] IK 

]LK ] JLY@	+#53#!5#353533#!!q}}}}}}}wk}}}w}}}}      }k     Z@W 	 	ee  ]IK
LK ^ JL  
	  	+#5#53#!5#3535!3#!!}q}}}}}}}w}}w}}}}}}w}}}}     }k    N@K		~ 
 e 		] IK ] LK 

^JL    	+75#3535!33#35#!!}}}}w}}}}}}w}}w}}}q}w    }k     W@T
e ]  IK ] LK 

	]		J	L  
	  	+533535#35!3#%!!}}}}q}}wk}}}}}w}}}}w    }k    K
PX@3  p	e   ]IK 

]LK ] JL@4   ~	e   ]IK 

]LK ] JLY@"  
	  	+#5#!5#353533#!!w}q}}}}}w}}}}w}}}}       }k     K
PX@5
 		pe  ]IK 	]		LK ^ JL@6
 	 	~e  ]IK 	]		LK ^ JLY@	+#53#53#!5#3533533#!!w}}w}}}}}}}}}}wk}}}}}w}}}}      }k    L@Ie
 ]   IK 		] LK ]JL  
	  	+5!5#35!3#%!!}q}}q}}wk}}}w}}}}w    }k    K
PX@7 
p 	 	p 
	
e  e ] LK ^JL@9 

~ 	 	 ~ 
	
e  e ] LK ^JLY@    	+75#35!3#%35#5#3153}}}q}}}}}}}w}}}}}}}     }k    K
PX@5p	  e]IK ]LK 
^

J
L@6~	  e]IK ]LK 
^

J
LY@    	+75#35353353#33#35#!!}}}}}}}}}}}}w}}w}}}}}}}q}w       }k    C@@ 	  	f   e
] LK]JL    	+75#35!3!3%3#35#}}}q}}}}}}}w}}}}}w}}        k 	  5@2  e  e  ]   LKNL  
 	 		+1!3#!!5!}}w}}w       k   ;@8  e  e   IK ] LKNL    		+13!3#!!5!}}w}}w     k 	  5@2  e    e ] LKNL  
 	 		+!5!5#535!!5!q}}w}}w    } }k   +@(    e ]LK JL	+3##3!!5w}}q}q}}    } }k     A@>  e  e   ] IK ]
	LK JL	+#53#533##3!!5q}}}}}}}}k}}}q}}    } }k   K
PX@3  p  n 
 	
e]IK  ]  LK		J	L@5 ~   | 
 	
e]IK  ]  LK		J	LY@    	+735#53353#3!#35#}}}}}}}}}q}}}}}}}}}     }  kk   D@A  U
	 e  ]   LK ] JK ] NL	+3#3##535#3!!5w}}}}}}}}}}}q}}     }k  C@@  e  e   e ] LK   	]
		J	L    	+55!5!5#535!!!3#q}}q}}}}}}}}}}}}}      }k   K
PX@@ 	 	p  e  e e   ] IK ]
LK ] JL@A 	  	~  e  e e   ] IK ]
LK ] JLY@	+#53#!5!5!5#5353533!!q}}}q}}}k}}}}}}}}}}}}}     }k  K
PX@B p  e  f   e	]IK ]
LK   ]JL@C ~  e  f   e	]IK ]
LK   ]JLY@    	+55!5!5#53535#53353#3!!3#q}}}}}}}}}}}}}}}}}}}}}}}}}}      kk   Y@V  		e 
 
e   e e ] LK JK ] NL    	+###5!5!5!5#535!!!3#k}}}q}}q}}}}}}}}}}}}}       }k   K
PX@@p  e  	f 	 
 	
e ] IK ] LK   ]JL@A~  e  	f 	 
 	
e ] IK ] LK   ]JLY@    	+55!5!5#53535!3!!3#35#q}}}w}}}}}}}}}}}}}}}}q}     } }k  T@Q   e  e U 	e ] IK ]
JL    	+#3##535#535#3##35!k}}}}}}}}}k}}}}}}}} w }k  %@" ] IK   ]JL    	+%35!#w}w}}}  } }k  )@& IK  ]LKJL    	+%#53533#w}}}   } }k  =@:  e   	 e IK]LK
		J	L    	+%5#535#53533#3#w}}}}}}}}}}}     } }k    D@A	e  ]
IK ] JL  
	  	+#5#53###5353w}}}}}}}}}w}   }  k   =@:  ]	LK ] IK JK ] NL    
	+##5##53533#k}}}}w}}       }k 	 '@$   ]LK ^JL   	 		+75#3!3}}w}}     }k    =@:  e   ] IK ]	LK ^ JL
	+#53#53!5#3!q}}}}}w}wk}}}}     }k     O@L  e  ]IK ]
LK 		^ JL  
	  	+#5#53!5!!5#3!}q}}}w}w}}}}}}}       }k   I@F  e	 e ] IK 
^

J
L    	+535!3#5#5#3!3}}w}}}w}}}}}}}ww     }k    H@E
	 ]  IK ]LK ^JL  
	  	+533535#3!3}}}wk}}}}}    }k    G@D 	e   ] IK ]
LK ^ JL
		+#5353!!5#3!w}}}w}wk}}}}     }k     J@G 

e  ]IK ]	LK ^ JL	+#53#53!5#353!5#5w}}w}}}}}}w}k}}}}}}}}      }k   =@: ]   IK ]LK ^JL  
	  		+5!5#3!3}q}wk}}}     k    K
PX@2   p   f ]IK ] JK 		
]

N
L@3   ~   f ]IK ] JK 		
]

N
LY@    	+!#5#5#3!3#53k}}w}}}}}}}}}}       }k    c@`
 
 ~e ] IK ]LK   ]LK 		^JL    	+75#3535!3335#!35#!5#3}}}}w}}}}}w}}}}}}}}}}q}w}}}}       }k    E@B	 e  ]IK ]LK 

^ JL	+#533#%#53!5#353!w}}w}}}}}}wk}}}}}}}   } }k  _K
PX@   p]LK ]JL@!  ~]LK ]JLY@    		+%5#5#333##w}}}}}}}ww}}     }k    :@7]	
LK  ]JL	+73#5#33#!##53}}}}}}}}}     }k     T@Q 	 e	
	e ] IK]JL	+#535!3#5#3#5#33#!##53w}w}}}}}}}}}}}}}}}ww}}w    }k # K
PX@<
p p  e e	]LK  ^JL@>
~~  e e	]LK  ^JLY@"   # #"! 	+553535#5#53335353##33#5#5##}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}     k  7@4  e ]LK JK   ]NL    		+35!5!5#3!3#}}w}}}}ww}     k    O@L  	e 
 
e   ] IK 	]		LK JK ] NL	+#53#53#!5!5!5#3!q}}}}}w}}wk}}}}}}}ww      k   _@\ 	 e 
	U 
 
e ] IK		] JK ]NL    	+535!3#5#5!5!5#53!53#}}w}}}w}}}}}}}}}}}     k    [@X  
e ]  IK ]	LK 

JK ]NL  
	  	+533535!5!5#3!3#}}}w}k}}}}}}}ww}       }k  K
PX@3 p | |   n] LK  	^
		J	L@5 ~ | |   |] LK  	^
		J	LY@    	+55353535!5!###!}}}k}}}w}}}}}}}}}}}       }k   K
PX@F   ~ 	p 		| | n   ] IK
]LK^ JL@H   ~ 		~ 		| | |   ] IK
]LK^ JLY@	+#53###!!5353535!5!53q}}}}}w}}}w}k}}}}}}}}}}}}}      }k  K
PX@H ~ p | |   n	]IK]
LK  ^JL@J ~ ~ | |   |	]IK]
LK  ^JLY@    	+55353535!535#53353#3###!}}}}}}}}}w}}}}}}}}}}}}}}}}}      }k   K
PX@> p 		| 		| n ]   IK] LK
^JL@@ ~ 		| 		| | ]   IK] LK
^JLY@"  
	  	+535353535!5!###!w}}}k}}}wk}}}}}}}}}}}}     }k  7@4 ] IK  ]LK ]	JL    
	+7#53535!#!##}}}}w}}}}}}    }k   9@6 ] IK  ]LK ]	JL    
	+7#53535!##35#}}}}q}}}}q}  }   wK
PX@+ ~ n b ] aK   ] d L@, ~ | b ] aK   ] d LY@    	
+5#535#5!3%35#}}}}}}}}}}}}}     }   2@/  e a ] aL    	
+5#535!3#'35#}}w}}}}}}}}}      }k   K
PX@/
	 p	 
	n  e 

] K  KL@1
	
	~	 
	 |  e 

] K  KLY@    +53535!33#5!!5#5##}}w}}w}}}}q}}}}w}}    }k   ;@8  e  e  ]   K ]L    	+5!!!3#%!5!}}w}k}}}}     }k    G@D  e  		e  e  ]   K ]
L    +5!3#3#!5!!5!}}}}ww}k}}}   } }k  KK
PX@ p  ]   KL@ ~  ]   KLY@    +7!#5!}}}k}    } }k   tK
PX@*  p p   ] K ]K L@,   ~ ~   ] K ]K LY@	+#53#5!#353q}}}}k}}q}}   } }k  @  f   K L+3!#!q          C@@   ~ ] K  ^ K  ^	L    
+15353!3#5!73#}}q}}}}q    }k  /@,  e  ]   K ]L    +5!!!!!kq}k}}}     }k   K
PX@1  p  e   ]
K ]	K ] L@2   ~  e   ]
K ]	K ] LY@  
	  +#5!!!!!!53w}qqw}}}}}}}}q}}     }k    Q@N  e
 ]  K ] K 	]			L  
	  +53353!!!!!}}kqk}}}}q}}}}}      }k     # K
PX@8
  ppe	]K^L@:
  ~~e	]K^LY@1  ##"! 
	  +#5#53###533!##3#5333}}}}}}}}w}}}}}}}}w}w}ww}       }k  Y@V 
U	 

e  e  U   e ] K ]L    +75#53!5!5!5!#535!3#3#}}ww}q}}}}}}}}}}}}}}}       }k  =@:  e  e  K ] K
	L    +533535353####}}}}}}}k}}w}}}     }k   Q@N  e  		e ]   KK ^
L  
	  +5!33535353#5##}q}}}}}k}}q}}}}}      }k    [@X e  	e 
 
e   ] KK 		^L
	+#5353!#5##!3353535w}}}w}}}}}k}}}}}q}}}       }k   Y@V ~   e V	 f 

]K   K ^L+3333#5#5##33##535w}}}}}}}}}}}}kw}}}}      }k     K
PX@: p  
e f   ] K 
]

K ^	L@; ~  
e f   ] K 
]

K ^	LY@+#53#53333#5!#33%#5q}}}}}}}}wk}}}}q}}       }k  jK
PX@&   p   ~ ] K   ^L@'   ~   ~ ] K   ^LY@    +55353!###}}q}}}}       }k  7@4e  K ] K
	L    +53335353###5#}}}}}}}k}}}}       }k  '@$  e  KL    +53!3#!w}kww       }k   5@2  e ] K ]L    	+75#35!3#%!!}}}q}}w}}q}}}}q      }k  !@  ]   KL    +5!#!k}k       }k 	  5@2  e  e  ]   KL  
 	 	+5!3#!!!}}w}k}}ww       }k  Q@Ne	 
	 e ] K ] K 

^L    +75#5#3535!3#5##3353#}}}}}}}}}}}w}}}}}}}}}}   } }k  !@  ] KL    +%#5!#w}}}    }k  =@:  e   e ]K 	]
			L    +75#53!5!5#3!3#}}w}w}}}}}}ww}      k   P@M  e
 ]   K ]K K 	]			L  
	  +5!5!5!5#3!3#}q}w}k}}}}}ww}       }k    I@Fe
 	
 e K]K			L    +%5#5#3535333##'3#3#w}}}}}}}}}}}}w}}}}}}ww    }k # K
PX@>
p p  e	]K]K  ^L@@
~~  e	]K]K  ^LY@"   # #"! +553535#5#53335353##33#5#5##}}}}}}}}}}}}}}}}}}}}}}}}}    }k  +@(    e ]KL    +%!5#3!3q}w}w}ww       k  /@,K ^   K^L    +!5!3333q}}k     }k  %@"  K^L    +533333}}}}k          4@1K ^   K^L    	+!5!333333}}}}}k       k  )@&K  ^  KL    +!5!3!3!ww}k}     }k 	  7@4  e   K ] K ^L  
 	 	+53!3#%!!}}w}k}}}w     }k   =@:  e   ] K ] K ]L    	+7#5!!3#%3#}}ww}}}}}}}w       }k  	  8@5  K ] K ^L  
		  	+53333%3#}}}}kk}w       }k   B@? ] K ] K   ]K ]L    	+553!3!#%3#}}w}}}q}w     }k   ;@8  e  K ] K ^	L    
+53333!#%3#}}w}}}kww}w       }k  Y@V U 
e 
 
e  U   e 		] K ]L    +75#53!5!5#535!3#5!!3#}}w}}q}}}}}}}}}}}}}}       }k  ]@Ze 	 
	
e  e ] K ] K ^L    +75#5#3535!3#5##!!3353#}}}}}}}}}}}w}}}}}}}}}}}}}    }k  ]@Z		e  e  e 
] 

K ] K ^L    +75#533535!5!5#5##535!33##}}}}}}}}}}}}}}}}}}}}}}}}}  } }k  )@&] K  ]L    +753#5!#3}}}q}}}   } }k    K@H
 ]  K] K	]			L  
	  +5335353#5!#3}k}}}}}w}}}       }k  .@+   U  ] K ]L    +75#53!3#}}w}}}}}}    }k  5@2  ] K ] K ]L    	+7#5!#!3##}}qw}}}}}}      }k   C@@  e
e  ]  K 

]	L    +533535!3#!5#5#%3#}}}w}}}}w}}}k}}}}}q    }k   K
PX@6 

~   p  e  e 		] K   ^L@7 

~   ~  e  e 		] K   ^LY@    +553535#35!#5#3!3}}}}}}}}w}ww      k  A@>] K ] K ]K   	]
			L    +!53###5!#!3#}}qw}}}}}}}}      }k   C@@e  		e  
 e K 

^ L    +#!#53533#!##3k}}}w}}q}}}}}}       }k      # K
PX@@  p	p 		e ]K]K
^


L@B  ~		~ 		e ]K]K
^


LY@0  ##"! 
	  +#5!#53#!53!!####3#5333k}}}}}}w}}}}}}}}}}}}}}ww}      }k    H@E 		~   |  e ] K ^
L    +75#35!3#%!!!5!}}}q}}w}q}}q}}}}q}     }k  K
PX@4	p
  e ]K ]K ]L@5	~
  e ]K ]K ]LY@    +%5#5#5#333533###w}}}}}}}}}}}}}}}}}       }k  cK
PX@"   pe ]K L@#   ~e ]K LY@    	+#5!3###53k}}}}}w}w  }  k  K
PX@0   p  e 	]
		K ]K ] L@1   ~  e 	]
		K ]K ] LY@    +#5!!3##53##k}w}}}}}}}wk          ' K
PX@F	  pe]
K]K^K ^ L@G	  ~e]
K]K^K ^ LY@1  '&%$#"! 
	  +#5#5###5333#3#3#533#5#33}}q}}}}}}}}}}}}}}}w}ww}}w}      k  c@`  U  
 e 
 	
	e U e ] K ]K L    +#3###5#5#53!5!5!5!#535!k}}}}}ww}qk}}}}}}}}}}}}        k   ]@Z ~   e V	 f 

]K   K K ^ L+3333#5#5##33##535w}}}}}}}}}}kw}}}}      }k    K
PX@;   ~ p  e

]	K ] K ^L@<   ~ ~  e

]	K ] K ^LY@+3##5##33537#3#33}}}}}}}}}q}}}k}}w}w}     }k   K
PX@; 
	
p   ~   e]K 	]		K ^L@< 
	
	~   ~   e]K 	]		K ^LY@    +33#5#5###5!357#53q}}}}}w}}}}}}}}}          -@*   eKK   ] L+%3#5#!#3!3k}}w}wkw       '@$ ] KK   ] L+%3#5#!#!k}}k}k     k  ^@[  e
U ] K ] K]	K ] L    +#5##3353###5#5#5#3535!k}}}}}}}}}k}}}}}}}}}}}w}}}    }  k  -@*  ]K K ] L    +#3#5##5k}}}}}  } }k  _K
PX@   p]K ]L@!  ~]K ]LY@    	+%#5#333##w}}}}}w}ww}     } }k  yK
PX@*
 pe  	]		K 

] L@+

~e  	]		K 

] LY@    +##3##5#535#5#33k}}}}}}}}}}}}}}}}ww         1@.   e ]K K   ] L+%3#5#!5#3!3k}}}w}w}ww     }k  ;@8e ]
	K ] K    L    +###5#5#33533k}}}}}}w}}}w}}w     } }  +@(  e   K ]L    +73!3#!}}}k}w     } }k  )@&] K  ]L    +753#5!#3}}}q}}}     }k   ^@[e ]   K	]K
]L  
	  +5!535#53353353#3#5##5#}q}}}}}}}}}}k}}}}       1@.   e ]K K   ] L+%3#5#!5#3!3k}}}w}w}ww     }k    K
PX@:pn 
 
e ]   K ] K^	L@<~| 
 
e ]   K ] K^	LY@&  
	  +5!3535!33#5!5!5#5##}q}}w}}w}}}k}}w}}}}}}}}}     }k     K
PX@=pn  
	
e ]  K ] K	^			L@?~|  
	
e ]  K ] K	^			LY@.  
	  +533533535!33#5!5!5#5##}}}}w}}w}}}k}}}}w}}}}}}}}}      }k   F@C  e ]   K ] K ]	L  
	  
+5!!!!!!}qkqk}}q}}}}}      }k   K@H U  	 	e 
 e ] K

] L    +#!5#!5!#535!5!k}}q}q}k}}w}}}}     }k   # i@f	e ]  K]
K]L  ##"! 
	  +53353535#53353353#3#5##5#}}}}}}}}}}}}k}}}}}}    }k   # u@r

e  ee ]  K 		] K ]L  ##"! 
	  +533535#53!5#535!#535!3#3#}}}w}q}}}}k}}}}}}}}}}}}}}}}}}     }k   Q@N  e  		e ]   KK ^
L  
	  +5!33535353#5##}q}}}}}k}}q}}}}}      }k    \@Y  

e  	e ]  KK 	^			L  
	  +5335333535353#5##}}}}}}}k}}}}q}}}}}      }k     W@T
e ]  K ] K 

	]			L  
	  +533535#35!3#%!!}}}}q}}wk}}}}}w}}}}w    }k    H@E 		~   |  e ] K ^
L    +75#35!3#%!!!5!}}}q}}w}q}}q}}}}q}     }k   V@S  e
 ]   K ]K ]K 	]			L  
	  +5!5!5!5#53!53#}q}w}k}}}}}}    }k    a@^  
e ]  K ]	K 

]	K ]L  
	  +533535!5!5#53!53#}}}w}k}}}}}}}}    }k     ^@[ e  f  ]K 		]
K ]
K ] L+#53#533#!5!5!5#5353!#5w}}w}}}}}}}w}k}}}}}}}}w}}     }k    M@J  	e
 ]  K ]K			L  
	  +533535!5#53!53}}}}wk}}}}}    }  k  aK
PX@"   p ]K K ] L@#   ~ ]K K ] LY@    +#5!3#5#k}}}}}k       }k      U@R  
	
e ]  KK 		^L  
	  +533533333%35#}}}}}k}}}}q}q}      }k    N@K 
	 
 ee ] K]L    +##!5#35!#!35#5353k}}}}q}}}}k}}}q}}}}}}     }k  9@6
  e 		]KL    +75#33333##5#5##}}}}}}}}}}}}}}}}}      }k   D@A ~  e    e ] K ^	L    
+75#535!5!5!3%!5!}}}q}w}}}}}}}}}       }k  O@L 

U U	e   ]K ] K ] L    +!3#!#5!3#!5#35k}}ww}}}}}}w}}}}q}     }k    G@D  e  		e  e  ]   K ]
L    +5!3#3#!5!!5!}}}}ww}q}}}}}w}}   } }k  KK
PX@ p  ]   KL@ ~  ]   KLY@    +7!#5!}}}q}    } }k   tK
PX@*  p p   ] K ]K L@,   ~ ~   ] K ]K LY@	+#53#5!#!53}}}}w}k}}q}}  } }kk  ?K
PX@   n ] K L@    ] K LY+3!#!qkq        qK
PX@+   p ] K  ^ K  ^L@,   ~ ] K  ^ K  ^LY@	+%3#5!#5353!3#k}}}q}}}ww      }k   =@:   f   e ] K ]	L    
+75#35!3!!!5!}}}q}w}}w}}}}w}     }k    K
PX@:  p  f
 e   ]K ]	K ] L@;   ~  f
 e   ]K ]	K ] LY@$  
	  +#5!!!5#353533#!!w}q}}}}w}}}}}w}}}}}       }k     `@]  f 	e ]  K ] K 		
]


L  
	  +533535#35!3!!!5!}}}}q}wk}}}}}w}}}}w}      }k  C@@
 
e]K  	]			L    +5535#53353353#3#5##5#}}}}}}}}}}}}}       }k  O@L	
e  e  e ] K ]L    +75#53!5#535!#535!3#3#}}w}q}}}}}}}}}}}}}}}}}}}       }k    =@:  e  	 	e    e
KL+3##3!##5353#}}q}}}}w}}qw}}}      }k     V@S  
e 
 
e  e   ]K	KL  
	  +!53##3!##5353#}}}q}}}}}}}}qw}}}       }k      `@] e 
 	
	e  e  e   ] KKL
	+#53533##3!##5353#w}}}}}q}}}}k}}}}}qw}}}    }k   qK
PX@(   p f ]
	K ^L@)   ~ f ]
	K ^LY@+333#5!#33%#5}}}wq}}q}}    }k     K
PX@: p  
e f   ] K 
]

K ^	L@; ~  
e f   ] K 
]

K ^	LY@+#53#53333#5!#33%#5q}}}}}}}}wk}}}}q}}       }k  jK
PX@& p   ~ ]K  ^   L@' ~   ~ ]K  ^   LY@    +####53535k}}}}}      }k    @@=
  e  		eKL  
	  +##3%##5353#w}q}}}}q}q}}w}}    }k  '@$  e  KL    +53!53#5!w}q       }k   5@2  e ] K ]L    	+75#35!3#%!!}}}q}}w}}w}}}}w      }k  !@  ]   KL    +5!#!k}q        k  @@=  U
	   e ]K ] K L    +#!#33#!#5!k}}}wwq}}}}w}}     }k  =@: e   e ] K 	]
			L    +75#35!3#5!!53#}}}q}w}}}w}}}}}}}     } }k  !@  ] KL    +%#5!#w}}}     k  7@4  e ]K K   ]L    	+35!5!5#3!3#}}w}}}}ww}     k   P@M  e
 ]   K ]K K 	]			L  
	  +5!5!5!5#3!3#}q}w}k}}}}}ww}        kk    K@H
e]K

 ]  K 	]			L    +!5#5#3535333##'3#3#w}}}}}}}}}}}w}}}}}}ww       }k # K
PX@<
p p  e e	]K  ^L@>
~~  e e	]K  ^LY@"   # #"! +553535#5#53335353##33#5#5##}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}    }k  +@(    e ]KL    +%5!5#53!53q}w}}       k  /@,K ^   K^L    +!5!3333q}}q     }k  %@"  K^L    +533333}}}}q          4@1K ^   K^L    	+!5!333333}}}}}q       k  )@&K  ^  KL    +!5!3!3!ww}q}     }k 	  5@2  e  e   K ^L  
 	 	+53!3#%!5!}}w}q}}}}}     }k   ;@8  e  e   ] K ]L    	+7#5!!3#%35#}}ww}}}}}}}}}       }k  	  6@3  e  K ^L  
		  	+53333%35#}}}}qq}}      }k   @@=   e ] K   ]K ]L    	+553!3!#%35#}}w}}}w}}    }k   9@6  e  e  K ^	L    
+533533!5#%35#}}w}}}q}}      }k  C@@  e  e   e ] K   	]
			L    +55!5!5#535!!!3#q}}q}}}}}}}}}}}}}      }k  I@F e  	e 	
 	 e ] K ]L    +75#35!3#5!3#!53#}}}q}w}}}w}}}}}}}}}}    }k  I@F	 e  e 
  e ] K ]L    +75#53!5#535!#535!3#}}w}q}}}}}}}}}}}}}}  } }k   =@: ]   K ] K]L  
	  	+5353#5!3w}wk}}}w}}    } }k    H@E
	 ]  K ] K]L  
	  +5335353#5!3}}}wk}}}}}w}}    }     A@> ]   K ] K K ]L  
	  	+535!#5!#w}w}k}}}}}     }k  9@6  e  e K ]
	L    +7#53533#!3##}}}w}}q}}}}}}w       }k   C@@  e
e  ]  K 

]	L    +533535!3#!5#5#%3#}}}w}}}}w}}}q}}}}}}}w      }k   =@:  e   e ] K   ]	L    
+5535#535!#5!!5!}}}w}}}}w}      k  G@De  	e K 		]
K   ]L    +!53###53533#!3#}}}w}}}wq}}}}}}}     }k   E@B  		e  
 e K]K 

^ L    +#!#53533#!##3k}}}w}w}}}}}}}     }k     K
PX@,  p 	
e  ] K

]L@-  ~ 	
e  ] K

]LY@+!#5#5!##!!##5#53!#53q}}k}}w}}}qq}}}}}}      }k    K
PX@- 		p  n  e ] K ^
L@/ 		~   |  e ] K ^
LY@    +75#35!3#%!!!5!}}}q}}w}q}}w}}}}w}    } }k  sK
PX@*  p ]K ]K ]L@+  ~ ]K ]K ]LY@    	+%5#5#333##w}}}}}}}ww}}     }k  cK
PX@"   pe ]K L@#   ~e ]K LY@    	+#5!3##5#535k}}}}}}}     }  k  =@:    e	] K ]K ] L    
+!3##535##!ww}}}q}}}}q}          L@I

e	]		K]K   ^ L+%3#5#5##5##535#53353353#3k}}}}}}}}}}}}}}}     k  T@Q 
 e 
 	
	ee ] K ]K L+#3###5#5#53!5#535!#535!3k}}}}}w}q}}}}}}}}}}}}}}}}        K
PX@7 
p 	  	p 	V 

]K^K   ^ L@9 

~ 	 	 ~ 	V 

]K^K   ^ LY@+%3#5#5!#335333#5k}}}}}}q}}}w}}       }k    K
PX@1  
p  e  e

]	K ]L@2   ~  e  e

]	K ]LY@+3##5##33533#53#53}}}}}}}}}}q}}}    }k   uK
PX@)   p f	]
K ^L@*   ~ f	]
K ^LY@+333#5###5!3%#5}}}}w}wq}}}}}       -@*   eKK   ] L+%3#5#5!#3!53k}}w}q       '@$ ] KK   ] L+%3#5#!#!k}}k}q     k  B@?	  	 e e 
] 

K ]K L+#5!!53###5#5#35!3kw}}}}q}}}}}}}}w}}  }  k  -@*  ]K K ] L    +#3#5##5k}}}}}  }  k  _K
PX@  p  ]K ] L@!~  ]K ] LY@    	+###5#5#33k}}}}}}ww  }  k  }K
PX@,
 p  	]		K]K 

] L@-

~  	]		K]K 

] LY@    +##3##5#535#5#5335k}}}}}}}}}}}}}}}}         1@.   e ]K K   ] L+%3#5#5!5#53!53k}}}w}}     }k  9@6e   e ]
	K    L    +#5##5#5#5335335k}}}}}}}}}}}     }k   6@3  U K ] K  ]L	+3##3##5!}}qwq}k}}  } }k 	 '@$ ] K  ]L   	 	+753#5!3}}w}}q}}       }k   ^@[e ]   K	]K
]L  
	  +5!535#53353353#3#5##5#}q}}}}}}}}}}k}}}}       1@.   e ]K K   ] L+%3#5#5!5#53!53k}}}w}}     }k    \@Y ~  

e  	e ]   K ] K 		^L  
	  +5!5#535!5!5!3%!5!}q}}q}wk}}}}}}}}}}    }k     g@d 		~  e  e ]  K ] K 
^


L  
	  +533535#535!5!5!3%!5!}}}}q}wk}}}}}}}}}}}}    }k    U@R 	 	f e ]   K 

] K ]L  
	  +5!5#35!3!!!5!}q}}q}wk}}}w}}}}w}      }k   =@:   e   e ] K ]	L    
+75#5!5!5!3#%!5!}}qq}}w}}}}}}}}      }k   # i@f	e ]  K]
K]L  ##"! 
	  +53353535#53353353#3#5##5#}}}}}}}}}}}}k}}}}}}    }k   # u@r

e  ee ]  K 		] K ]L  ##"! 
	  +533535#53!5#535!#535!3#3#}}}w}q}}}}k}}}}}}}}}}}}}}}}}}     }k     I@F  
e 
 
e  e   ] K	KL+!5!3##3!##5353#q}}q}}}}k}}}qw}}}      }k      O@L 
 	
	e  e  e  ]KKL+#53#533##3!##5353#ww}}q}}}}k}}}}}qw}}}      }k     W@T
e ]  K ] K 

	]			L  
	  +533535#35!3#%!!}}}}q}}wk}}}}}w}}}}w    }k    K
PX@- 		p  n  e ] K ^
L@/ 		~   |  e ] K ^
LY@    +75#35!3#%!!!5!}}}q}}w}q}}w}}}}w}       k   P@M  e
 ]   K ]K K 	]			L  
	  +5!5!5!5#3!3#}q}w}k}}}}}ww}        k    [@X  
e ]  K ]	K 

K ]L  
	  +533535!5!5#3!3#}}}w}k}}}}}}}ww}        k     ]@Z
 	
e  f  ]K 	]		K K ] L+#53#53#!5!5!5#353!5#5w}}w}}}}}}}w}k}}}}}}}w}w}}}     }k    M@J  	e
 ]  K ]K			L  
	  +533535!5#53!53}}}}wk}}}}}    }  k  aK
PX@"   p ]K K ] L@#   ~ ]K K ] LY@    +#5!3#5#k}}}}}q       }k      U@R  
	
e ]  KK 		^L  
	  +533533333%35#}}}}}k}}}}qq}}       k 	  5@2  e    e ] KL  
 	 	+!5!5#535!!5!q}}w}}w      }k    :@7]	
K  ]L+73#5#33#!##53}}}}}}}}}     }k  \K
PX@! p  e  ]  KL@" ~  e  ]  KLY@+!#5####33w}}}}}wk     }k  \K
PX@! p  e  ]  KL@" ~  e  ]  KLY@+!#5##5##33w}}}}}q    }k   K
PX@9  p  n  
e 
 
e ] K   K ]	L@; ~   |  
e 
 
e ] K   K ]	LY@    +53535!#3#3!5#35#}}q}}}}q}}}}}w    }k    O@L  e
e    e] K	]			L    +75#53535#5!3##335#35#}}}q}}}}}}}}}}}}}}}}}w}}     }k   K
PX@/
	 p	 
	n  e 

] 1K  4K2L@1
	
	~	 
	 |  e 

] 1K  4K2LY@    +53535!33#5!!5#5##}}w}}w}}}}q}}}}w}}    }k    G@D  e  		e  e  ]   1K ]
2L    +5!3#3#!5!!5!}}}}ww}k}}}   } }k  @  ]   1K2L    +7!!}}k}      }k   }K
PX@,~	 n ] 1K  4K ^
2L@-~	  | ] 1K  4K ^
2LY@    +53535!33%!#5##}}w}}w}}}}q}}}}}}}    }k  /@,  e  ]   1K ]2L    +5!!!!!kq}k}}}    }k  w      }k  '@$  e  1K2L    +53!3#!w}kww       }k    A@>  	 	e  e ] 1K ]
2L    +75#35!3#!5!!5!}}}q}}ww}}q}}}   } }k  )@&] 1K  ]2L    +753#5!#3}}}q}}}     }k  K
PX@H p ~ 	
	p  e  	e  ]  1K ] 4K 

^2L@J ~ ~ 		~  e  	e  ]  1K ] 4K 

^2LY@    +533535353###333!5#5#}}}}}}}}}}}}k}}}}}}}}}}}}       }k  pK
PX@' p n ] 1K  4K
	2L@)~  | ] 1K  4K
	2LY@    +53535!33##5##}}w}}}}}}q}}}}q}}     }k  7@4e  1K ] 4K
	2L    +53335353###5#}}}}}}}k}}}}      }k  C      }k    =@: e ]   1K ]2L  
	  	+5!5!5!kqkk}}}}}}       }k   5@2  e ] 1K ]2L    	+75#35!3#%!!}}}q}}w}}q}}}}q      }k  !@  ]   1K2L    +5!#!k}k       }k 	  5@2  e  e  ]   1K2L  
 	 	+5!3#!!!}}w}k}}ww       }k  K
PX@J	p 	
	
~ ~  p 
 
e] 1K 	] 		4K  ^2L@L		~ 	
	
~ ~  ~ 
 
e] 1K 	] 		4K  ^2LY@    +55353535#5#5#5!#5#33##353}}}}}}k}}}}}}}}}}}}}}}}}     } }k  !@  ] 1K2L    +%#5!#w}}}  } }k  _K
PX@   p]1K ]2L@!  ~]1K ]2LY@    	+%#5#333##w}}}}}w}ww}       }k    I@Fe
 	
 e 1K]4K		2	L    +%5#5#3535333##'3#3#w}}}}}}}}}}}}w}}}}}}ww   }k  r      }  =@:	 e]1K
  ^2L    +7535#5#33333##3}}}}}}}}}www}}      }k  K
PX@<~n
  
p ] 1K]4K  	^		2	L@>~|
 
 ~ ] 1K]4K  	^		2	LY@    +5535#3535!33#3!53#5##3}}}}w}}}}}}}}}}}}w}}}}}}w}}      }k     P@M

e   e ]	1K4K  2 L    +#5##353533%#53#5#3k}}}}}}}qq}}}}}}}}}}      }   =@:  e  e  ]	1K ] 2L    
+!3#!!#53#}}}}}}}}}}       }   9@6  e   e ]	1K  2 L    
+####5!33#}w}}w}w}}       }k    9@6  		e ]
  1K] 2L+3#%#3!53#53#}}}}}}}}}}}}}}q}}}    }     O@L 		Ue
  ]1K ] 2L  
	  +#5#!5#35!!3#%#3}k}}}}}}}}}}q}}}}     }   K
PX@4 p 	 
 	
e ]1K  ]1K ] 2L@5~ 	 
 	
e ]1K  ]1K ] 2LY@    +####5#5#5!33#}}}}}w}}}w}}w}}     }  # ' K
PX@; pe]1K
  ]4K	^2L@<  ~e]1K
  ]4K	^2LY@*$$  $'$'&%#"!   +#3!53#5##3!535#3535!3%#53#5}}}}}}}}}}}w}}}}}}}w}}}}w}}}}}}}}}    } }k    K@H
 ]  1K] 4K	]		2	L  
	  +5335353#5!#3}k}}}}}w}}}     } }k    K
PX@.
p ]  1K	]4K ]2L@/
~ ]  1K	]4K ]2LY@&  
	  +533535#5#53353##}}}}}k}}}}}}    }k   1@.    e ] 4K ]2L  
	  +75#35!%!!}}}w}}w}}w       k    R@O  U  e  
e 		] 1K 

] 2K  ]6L    +135!3#3#!!5!!5!}q}}}}wwk}}}}}q     k  A@>  	 e ]4K]4K 	]
		6	L    +!5#5#5#53333##w}}}}}}}}}w}      }k   P@M  e e 	  e ] 1K 4K 
^

2
L    +75#535!5#535!#33#%!5!}}}w}}w}}}w}}}}}}}}}}}    }k  C@@  e  e    e ] 4K 	]
		2	L    +75#535#535!!!!!}}}}}q}}}}}}}}}}}      k  K
PX@E p 		~  
e 
 
f] 1K 4K ] 2K   ]6L@F ~ 		~  
e 
 
f] 1K 4K ] 2K   ]6LY@    +!535!5#53535#5!###!3#}}}}}q}}}}}}}}}}}}}}}}        k   8@5]4K  ] 2K  ] 6L	+3##53##5!}}qwq}}q}}       }k   # K
PX@Dp p 
 
e  e ] 1K]4K 	^		2	L@F~  ~ 
 
e  e ] 1K]4K 	^		2	LY@"  #"!   +75#5#3535!33##!5#5##3535!3}}}}w}}}}w}}}}}}}}}}w}}}}}}}}}}}}   } } 	 .@+   ~ ] 4K ]2L   	 	+%5##5!3w}}w}}w}}       }k  K
PX@6 p 
	p  

e  		e  ]  4K ^2L@8 ~ 
	
	~  

e  		e  ]  4K ^2LY@    +5335353##33#5#5#}}}}}}}q}}}}}}}}}       }k  K
PX@@ p p U  e ] 1K ] 4K	  
^

2
L@B ~~ U  e ] 1K ] 4K	  
^

2
LY@    +553535#5#5333333#5#5##}}}}}}}}}}}}}}}}}}}}}}}       k   1@. ]4K  ]2K 6L	+73##3#5#3q}}}}}    }k  A@>  	 e ]4K]4K 	]
		2	L    +%5#5#5#53333##w}}}}}}}}}}}w}}        K
PX@Q 	p 

~ 
|  e  f] 1K 

	] 		4K ] 2K   ]6L@R 		~ 

~ 
|  e  f] 1K 

	] 		4K ] 2K   ]6LY@    +!535!5#53535#5#5!!3##!3#w}}}}}}}w}}}}}}}}}}}}}}}}}}      }k   5@2  e ] 4K ]2L    	+75#35!3#%!!}}}q}}w}}w}}}}w      }k  6@3   ~] 4K  ]	2L    
+553#5!#3#5##}}k}}}}}}w}}}}w        k   :@7  U  e ] 4K  ]6L    	+135!3#!!5!}q}}wq}}}w      k  E@B  e  e ] 4K ] 2K   	]
		6	L    +35!5!5#535!!!3#}}}q}}}}}}}}}}    }k   ~K
PX@- p  U   e	] 4K ]
2L@. ~  U   e	] 4K ]
2LY@    +75#35!#3#%35#5#}}}}}}}}}w}}}}}}   } }k  0@-   ~] 4K ]2L    +%5##5!#3}}}w}}}     }k  7@4  e]4K 	^
		2	L    +75##5333#533#}}}}}}}}w}}w}}}       k  G@D  U 

]4K	^2K] 6L    +###5#5#353333#53k}}}}}}}}}q}}}}w}ww}}       k # K
PX@<
p p  e e	]4K  ^6L@>
~~  e e	]4K  ^6LY@"   # #"! +153535#5#53335353##33#5#5##}}}}}}}}}}}}}}}}}}}}}}}}}}}}      k  9@6]4K ]  2K 	]
		6	L    +!5#5#33333##w}}}}}}q}}      }k 	   >@;	
 e4K  ^2L



+73#5#353##533##}}}}q}}}}}}w}}}}}w  } }   =@:  e   ] 1K ]4K	^ 2L
+#53!5##53533}}}}}}}k}}}w}}}       }    O@L ~
	 ]  1K ] 4K ]2L  
	  +533535##5!3}}}wk}}}}}w}}     }     L@I  e  ]1K 		
]

4K ^ 2L+#53#533#53!5##53533}}}w}}}}}}}}}k}}}}}}}w}}}    }k    \@Y e	
	e   ] 1K]4K 

^ 2L
	+#53#5#!5##5333#53q}}}}}}}}}k}}}}}}w}}w}}       }k    ]@Ze ]  1K	]
4K ^2L  
	  +533535##5333#533#}}}}}}}}k}}}}}w}}w}}}    }k     # ]@Z  e
e  ]1K]4K 	^ 		2	L##"! +#53#53#53#53#!5##5333#53}}}w}}}}}}}}}}}k}}}}}}}}w}}w}}       }k    K
PX@2  p	e   ] 1K 

]4K ] 2L@3   ~	e   ] 1K 

]4K ] 2LY@+#53#!5#353533#!!q}}}}}}}wk}}}w}}}}      }k      X@U  e	e   ] 1K4K^
2L+#53#533#5#353##533##q}}}}}}}}}q}}}}k}}}}w}}}}}w     }k    K
PX@0  p  	e   ] 1K ]
4K 		] 2L@1   ~  	e   ] 1K ]
4K 		] 2LY@+#53!5#35353!!q}}}}}}wk}}w}}}}    }k   K
PX@@  p 
 	
	e  e  e   ] 1K ]4K ] 2L@A   ~ 
 	
	e  e  e   ] 1K ]4K ] 2LY@+#53!!!!!5#535#535353q}}q}}}}}k}}}}}}}}}}}}}       k    K
PX@6  p   ] 1K	]
4K] 2K] 6L@7   ~   ] 1K	]
4K] 2K] 6LY@+#53##533!3##53q}}}}}k}q}}}   w      8dD@-   eU] M    + D%#5#5}w}}}}}    }k   K
PX@: p  
p 
 e ] IK]LK 

	^		J	L@< ~   ~ 
 e ] IK]LK 

	^		J	LY@    	+75#5#3535!33##'3#5#3}}}}w}}}}}}}}}w}}}}}}}}     } }k  +@(   e IK  ^JL    	+753#53533}}}}}}}}    }k  K
PX@H 

~ |   p U 		e   f ] IK LK ^JL@I 

~ |   ~ U 		e   f ] IK LK ^JLY@    	+5535353535!#535!3###!}}}}q}}}}}}}}}}}}}}}}      }k  K
PX@; 		p
 f  U   e] IK LK ^JL@< 		~
 f  U   e] IK LK ^JLY@    	+75#53!5!53535!5!##33#}}w}}}}}}}}}}}}}}}}}}}}      }k   K
PX@/ 
p  

e  f 		] IK LKJL@0 

~  

e  f 		] IK LKJLY@    	+%5!5353535!3#35##}}}w}}}}}}}}}w}     }k  D@A  U   e ] IK ] LK 	]
		J	L    	+75#53!!!!!3#}}w}}}}}}ww}}}}     }k   K
PX@= ~ n  e   U ] IK  ] LK 

	^		J	L@> ~ |  e   U ] IK  ] LK 

	^		J	LY@    	+75#3535!!#!3#%!5!}}}}}}}w}}}}}}}}}}    }k  K
PX@6p ~  n ] IK ] LK   	^
		J	L@8~ ~ | ] IK ] LK   	^
		J	LY@    	+7353535!#5!###}}}k}}}}w}}}}}}       }k    ]@Z
e 
  
e  e ] IK ] LK 	]		J	L    	+75#535#535!3#3#35!3!5#5#}}}}}}}}}}}}}}}}}}}    }k   K
PX@;  p   | 
U 
 
e e ] IK   	^		J	L@< ~   | 
U 
 
e e ] IK   	^		J	LY@    	+75!535!5#535!3##!5!}w}}}q}}}w}}}}}}}}}       (@%   e  b aL    
+535#53533}}}}}}}}}       4@1  e  b ] aK dL    	
+53535#5!3#3}}w}}}}}}}}}}}       iK
PX@% p   a] aK ] dL@& ~   a] aK ] dLY@    	
+535#5#5!#3#}}}}}}}}}}}}}    q 	 VK
PX@ p   ] dK] aL@ ~   ] dK] aLY@   	 	
+5#535353}}}}}}}    }k        e@b  e  e  	
	e 
 
e   ]IK ] LK ] JL  
	  	+#53##3##3##3##3##3#k}}}}}}}}}}}}}}}}}}}}}}}}}}}}  
   }k       ! % - 1 dD@ ee  	
	e
 
 e e eU^N  10/.-,+*)('&%$#"! 
	  	+ D#5#535!#53##3##3#353#5!3##3#%33!53!3#}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}  	   }k      ! % ) - dD@ ee  	
	e
 
 e ef U ]M  -,+*)('&%$#"! 
	  	+ D#5#535!#53##3##3#%3#5#5353!3##3##3#}}}}}}}}}}}}}w}}}}}}}}}}}}}}}}}}}}}}}}}}}     }k        ) - 1 5 dD@e  	 e
		ee ef U ]M  543210/.-,+*)('&%$#"! 
	  	+ D#5#5!%#53##5;###5!3#%3#5#5353!3##3##3#}}w}}}}}}}}}w}}w}}}}}}}}}}}}k}}}}}}}}}}}}}}}}}}}}}}      kk  F@Ce	e
  a ] LL    	+7535#535#53353#3#3#5#}}}}}}}}}}}}}}}}}}}}}       }k        @ e 	e	 	e 

e   ]IK ]LK] JL  
	  	+#5#5#5#5#5#5#5}}}}}}}}}}}}}}}}}}}}}}}}}}}}     wq  @   U   ] M    	+53w       '@$  e] LL    	+%5#53533#w}}}}}}}}    k   /@,   e U ]M    	+5353q   }  w  %@" ] JK   ]NL    	+35353#}}}}}     }kw    /@,  ]JL  
	  		+553353353}}}}      }q  	 5@2~  ]   IK ]JL  		  	+!#53w}wq}}    }q  	 3@0 ]   IK LK ^JL  		  	+53353w}k}}w     }k   G@De	
  eIKJL    	+75#53#53533533#3##5#53#}}}}}}}}}}}}}}}}w}}}}}}}}}}w    }w  @   ]JL    	+753}    }k   K
PX@7  p   |e  	
 	f ] IK 

]JL@8 ~   |e  	
 	f ] IK 

]JLY@    	+53535!#535!3##5!}}q}}}ww}}}}}}}}}}      }k   K
PX@9 ~ n	
e ]   IK ] LK ^JL@: ~ |	
e ]   IK ] LK ^JLY@"  
	  	+5!5#53535!##!53#w}}}w}w}k}}}}}}}}}}   }q   $@! ]  IL    	+333}}qww    q  @ ]   IL    	+3qw   } }k   6@3   e  e ]JL  
	  	+535353#}}q}}     }k        e@b  e  e  	
	e 
 
e   ]IK ] LK ] JL  
	  	+#53##3##3##3##3##3#k}}}}}}}}}}}}}}}}}}}}}}}}}}}}      k }  &dD@   U   ] M    	+ D15!k}}   }  K@H ~   ~  e    e ] IK 	^
		J	L    	+%5#5#535353##33}}}}}}}}}}}}}}}   } }q  K@H ~ ~  e   e ] IK   	^
		J	L    	+753535#5#5333##}}}}}}}}}}}}}}}}     }  %@"  ]   IK ]JL    	+7!#3}k}}   } }q  %@" ] IK   ]JL    	+753#5!}}}q}    }  K
PX@6 p  p    e ] IK ] LK 	^
		J	L@8 ~   ~    e ] IK ] LK 	^
		J	LY@    	+%5#5#35353##33}}}}}}}}}}}w}}}}}}  } }q  K
PX@6 p  p   e ] IK ] LK   	^
		J	L@8 ~ ~   e ] IK ] LK   	^
		J	LY@    	+75353#5#5333##}}}}}}}}}}}}w}}}}}}    q  @   U   ] M    	+5!}}     kq  @   U   ] M    	+5!k}}     kq  @   U   ] M    	+5!k}}    }kq  @   U   ] M    	+5!}}}   }kq  @   U   ] M    	+5!}}}     kk  ' K
PX@;p	 
	pe	e

b  ]L L@=~	 	 ~e	e

b  ]L LY@&  '&%$#"!   	+75#5#535353353##33#5#'35#535##3}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}      kk  ' K
PX@;p	
 pe		e  b

]L
L@=~	
	
~e		e  b

]L
LY@&  '&%$#"!   	+553535#5#5335333###5#73535#5#3#}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}      k  K
PX@1 p  p  e  e 
		b   ] L L@3 ~   ~  e  e 
		b   ] L LY@    	+%5#5#535353##33}}}}}}}}}}}}}}}}}}  } qk  K
PX@1 p  p  e  e  
	 	b ] LL@3 ~ ~  e  e  
	 	b ] LLY@    	+753535#5#5333##}}}}}}}}}}}}}}}}}}}     }   4@1	  e]JL  
	  
	+##535!##535w}}q}}}}}}  }qk   3@0a  ]	I L  
	  
	+##535!##535}}q}}}}}}   }qk   6@3  ]	IK]LL  
	  
	+##535!##535}}q}}}}}}    qq  "@   a ] IL    	+5353#}}q}}    qq  %@" ] IK ]   LL    	+5353#}}q}}      }q  #@    e   ]JL    	+75353#}}}}}    wq  @   U   ] M    +53w    } }k   6@3   e  e ]2L  
	  +535353#}}q}}   } }w   $@!  ]JL    	+753353}}}       }k   U@Re 
	
e	 	 e IK ]LKJL    	+%5#5#3535333#5#353##'3#w}}}}}}}}}}}}w}}}}}}}}}}w   } kk         ]@Z  e

a	]LL  
	  	+#5#533#5#!3#!3#73#!53}}}w}}}}w}k}}}}}}}w}}}}}      }k   # a@^e	
	e 
 
e  e IK ] LKJL  #"!   	+%5!5!5#5#5353533#33##35#35#ww}}}}}}}}}}}}}}}}}}}}}}}}}}      k  	    Z@W	U
U   ] IK ] LK^JK

] NL	+#533!33##5#333#53#w}}}}}}}}}}}}k}}}}q}}w      }k # c@`   ee 
e ] IK]LK 	] 		J	L   # #"! 	+#5#3#3#353#!5#5#535#53535!k}}}}}}}}}wk}}}}}}}}}}}}}}}}}}    } }k  G@D ~   ~ ] IK]LK   	^
		J	L    	+753#53535!#3##}}w}}}w}}}}}}}       }k   K
PX@8   p 		p
	e ] IK  ]  LK ] JL@:   ~ 		~
	e ] IK  ]  LK ] JLY@	+3!5!5!5!3!!!5#5#5}}}w}}}}}}}}}}}}}      }   H@E
  
 eee 	] 		IK JL    	+#!3##5#535#53!#!!}}}}}}wk}}}}}}}}w}    }k  C@@ e	 e ] IK
  ^JL    	+5535#53535!3#5#!!!}}}}}w}}}}}}}}}     } }k   6@3 ]   IK] LKJL  
	  	+5!#5!#}k}}}}   } }k  M@J 	 	e  e  e
  ]IK ] LK JL    	+#3#3##5#535#535#5k}}}}}}}}}}}}}}}}}}    } }k  I@F	
e  e]IK LKJL    	+%5#535#535#53353#3#3#w}}}}}}}}}}}}}}}      }k     } kk  ,@) U  e ]M    	+%5#53533#w}} 	 } k         # t@q  e  	
	e

ea]LL     # #"!
	  	+#5!#5#533##3##3#353!3#!53}q}}}}}}}}}}}}}}k}}}}}}}}}}}}}}}  } kk    @@=   e e U ]M  
	  		+535!53w}}}}}}     wk   )@& a ]   LL    	+5!5!kkq}}}}      }k    
 0+#533!!!#5#5!5!5!3#k}}}}w}}wq}}}}}}}}}}}}}}}     } }  K
PX@F p  p  	e 	 
	
e   e ] IK ] LK   ^JL@H ~ ~  	e 	 
	
e   e ] IK ] LK   ^JLY@    	+75353535#5#5#53333###}}}}}}}}}}}}}}}}}}}}}}}}}}}}     } }  K
PX@F p  p  		e  
e 
  
 e ] IK ] LK ^JL@H ~   ~  		e  
e 
  
 e ] IK ] LK ^JLY@    	+%5#5#5#53535353###333}}}}}}}}}}}}}}}}}}}}}}}}}}}     }   	 0+53535#5#5333##5!}}}}}}}}w}}}}}}}}}}}}   }   	 0+5#5#535353##335!}}}}}}}}w}}}}}}}}}}}}    } }k   <@9  ]LK] IK ]	JL    
	+5#53533#5!ww}}}}      k         @
 0+#5!#53#%3##5!3#!3#%3#wq}}}w}}}}wk}}}}}}}}}}}}}}}      wk    BdD@7  e
	 e   U   ^  N	+ D3!5#5#5!3!3#%#5q}}}w}}}k}}}}}}}}}}  }wk  @    ] L L    	+5!5!qw}     k        @	 0+#53#53#5!#5!#53#%3#ww}}}wq}}}}}}}    }  k    
 0+###5335#5#5}}}}w}}}}}}}}}}}      }k    0+53535!33%!#5##}}w}}w}}}}q}}}}}}}     }k   0+5!#!k}k      }k   0+55353535#5#5#5!#5#33##353}}}}}}k}}}}}}}}}}}}}}}}}       }k  	 0+75#5#533!#}}}}}}}}q}     k   1@. ]LK  ]JK NL		+73##3#5#3q}}}}}    }k    0+75#535!5#5##535!33#%!5!}}}}}}}}w}}}}}}}}}}}}    }k  	      % ) / 3 @	e  eee  ]IK]
LK^JL3210/.-,+*)('&%$#"! 
			+#53#%#5#533%3##3##3##3#%3#5#!3#!3#533#}}q}}}w}}}}}}}}}}}w}}}}}}}}k}}}}}}}}}}}}}}}  
   }  	      / 3 7 @	e  eee  ]IK
]LK^JL  76543210 / /.-,+*)('&%$#"!	+#53#%#53#533!#53#53#53#5!#5#3!5335#53##3#}}q}}}}}}}}}}}}}}}}}}}}}}}}}k}}}}}}}}}}}}}}}}}}}      k  	 0+3#53535353333#}}}}}}}}}}}}}}}      }   0+%5!!53333###}}}}}}}}w}}}}}}}        k  	 0+!5#5#5#53!3###w}}}w}}}}}}}}}}}    }   0+%5#5#5#53535353!!w}}}}}}}}}}}}}}}       }k         # ' + / @.,*(%$" 	 0+#53#5353#5353!#5!#5#5!3###533##3#}}}}}}}}}w}}k}}}}}}}}}}k}}}}}}}}}}}}}}}}}}}}}}     }k   0+553535353333}}}}}}}}}}    }k   0+53333###}}k}}}}}}}       }k   0+%5#5#5#5!###w}}}k}}}}}}     }k   0+%5#5#5#53535353}}}}}}}}}     }k  	 0+7535#5#5!53!##3#5#5##}}}}w}w}}}}}}}}}}}}}}}}}}     }k    # @
	 0+#53#5#5!%##5#533#5!#53533}}}}w}}}}}}}}}}}}}}}}}}}}}}}}      }k   0+7535#53535353333#3}}}}}}}}}}}}}}}}}}}}}     } }k     @
	 0+#53#5!#533!53q}}}}    }k  	 0+%5#5#5#3533533###w}}}}}}}}}}}}}w}}}}}}}    }k   0+%5#5#5#53535353333###w}}}}}}}}}}}}}}}}}}}}}}}}}}}}      }k     @
0+###5#53533#5#53#q}}}}}}}}}}k}}}}}}}}}}}}}}       }  # 	 0+#53###5##5#5#35!353##3535q}}w}}}}}}}w}}}}}k}}}}}}}w}}}}}}    }k      ]@Z	 f 
e   ]IK ] LK 

]JL  
	  	+!53#!!3#35!}}}kw}}}q}}}qww}}}      }k    # K
PX@A   p	e  e U
 e ] IK^ JL@B   ~	e  e U
 e ] IK^ JLY@"   # #"!	+33!5#535#535!3#3%35##5#3%#5q}}}}}}w}}}}}}}w}w}}}}}}}}}}}    } }k    K
PX@2 	
	p 

n  e  f] IKJL@4 	
	
~ 

|  e  f] IKJLY@    	+%5#5#35!#5#3##33#}}q}}}}}}}}}}w}ww}}}w   } }k  # v@s 		~ 

|   e
 
e e ] IK] LK ^ JL  ##"!   	+#5#3##5#535!533#!5#5335#5k}}}}}}}}k}}}}}}}}}}}}}}}}                 # ' + dD@    ee 		e  e 
ee U ] M  +*)('&%$ # #"!	+ D!5!#5353!#!3#%#3#53!#5!3#!!!}}}}wq}}}}}q}}k}}}}}}}}}}}}}}}               ! % ) - 1 dD@    ee 		e 
e 
 
e ee U ] M&&""10/.-,+*&)&)('"%"%$#!!  	+ D!5!#5353!#!#3##5353!#5!3#!!!}}}}wq}}}}}q}}k}}}}}}}}}}}}}}}}}     }k   0+#5!#5###}}}}}w}w   qq     GdD@<    e	e U ] M
	
	+ D#53#5!#53#}}}}w}}}}k}}}}}}}}    w }q  @   IKJL    	+%3w}k  w }q   ,@) ]   IK ]JL    	+33wqww     } }k  )@& IK  ]LKJL    	+%#53533#w}}}   } }k  7@4 	 e IK]LK
		J	L    	+%5#535#53533#3#w}}}}}}}     }k  	      ]@Z
	e  e  ]IK ]JL  
	  	+###533##!#3#!!}}}}}}w}w}}}}}w}k}}}ww}}}     }  5dD@*   e  U  ] M    	+ D535!3#5#}}w}}}}}}}}    }q  &dD@   U   ] M    	+ D5!}q}}  :4   8dD@-   eU] M    	+ D#5#5}}}}}}}    2dD@'   e U ] M    	+ D#53#}}}}}}}}      0dD@%   e   U   ] M    	+ D5353#}}}}    g   &dD@   U   ] M    	+ D5!g}}   q   NdDK
PX@o   U   ]  M@   U   ]  MY@    	+ D3#}qw}    }k  &dD@   U   ] M    	+ D5!}qk}}  wq   8dD@-   eU] M    	+ D#5#5}}}}}}} wq   2dD@'   e U ] M    	+ D#53#q}}}}}}}}   wq   2dD@'   e U ] M    	+ D#53#q}}}}}}}}    }    =dD@2  e U ] M  
	  	+ D#5!#5!!}q}w}}}}}}    }  4dD@)  e U ]M    	+ D5#53353#}}}}}}}}}    q    2dD@'   e U ] M    	+ D%#53#q}}}}}     }  5dD@*   e  U  ] M    	+ D535!3#5#}}w}}}}}}}}    }k   2dD@'  U  ] M    	+ D53353}}k}}}} wkq  &dD@   U   ] M    	+ D53wk}}  wq   8dD@-   eU] M    	+ D#5#5}}}}}}}  }     =dD@2  eU]M
			+ D3#%#53#%3#}}}}}w}}}}}}}}}}     }k  &dD@   U   ] M    	+ D5!}qk}}     qw    BdD@7    e eU] M
		+ D%#53#5#5}}}}w}}}}}}}     }q   @dD@5  e  e U ]M    		+ D5#535!3#'35#}}w}}}}q}}}}}}}}  }    ;dD@0 e  U  ] M		+ D3#5#533#53#}}}}}k}}}}}}}   wq   2dD@'   e U ] M    + D#53#q}}}}}}}}    }k     :dD@/  e U ] M	+ D3#%3#%#53#}}}w}}w}}}}}}}}}}}   G    

 0+#5!#5!!S}q}w}}}}}}  } }k    
 0+7!!!!#35#}ww}}}kww}}}  } }w   0+7535!}w}}}        oX5_<     '     v                                   }                                                                                           }   } } } } } } } } }         } } } } }                                                               } } } }                               } } } }                                                                         }                 } } } } } } }   } } } } }       }     }   }                                           } } } }           }w } } } }                       }                           } }       } } }                                     }                                   } }                     }                 } } }     } }                                 }             } } }                                     }                                   } } }               }   }                 } } }       }                                 }                   }           }                   } }                       } }                 }                     }           }                    w   }                                    }            }  }      }  }  }       } }      }   } }     }   }   }       }       } } }   } } }     } }   }     }   }                                         }             } }     } ww } }   } }  :         }www } }  } }ww } }  } }w }   } }     $ $ $ $ 
 4F^`Hv	\	
\

`0|(jv Lx2x\*h$PBtL>*~l :   !!f!"":"~""#$#v#$
$R$$%R%&&b&'''(N() )**++J+,V,-2-.
./ /00P0~01F11202f233V34
4j455p56@677R778N899H99: :(:f::;<;~;<<j<<=F=>H>>??r??@@H@p@A
ALAAB BBC4CCDvDE2EEF$F\FFGGnGGHnHIHIJJ:JdJJK"KJKKL"LfLLM2MN NJNNO,OOP2PPQBQRNRSS<SST.ThTTU<U^UUV4VWWfWWXDXYYbYYZ Z$ZZZZ[[T[\$\R\\\]]B]~]]^2^^_6_`__`
`P``a>abbbc4cd4dee~eef4f`fgg@g~ggh0hdhipiij`jkknkl
lVlm
mRmmn<n|no
oPoopphpq$qqrrTrss\st$tftttu,ujuuvv^vw
w8wbwwwx2xhxxyydyyz(zdzz{"{h{||||}}X}}~h~.^BFnN<Zh
hJPt8fn&`|8@ T^X>X8&(`,f0l44dFZ|"X*x0Brx.``pj0f@\\\"*T&XX~ bJdT
,Ln4\.`~Z>h6V0P~<hNnH      8  $   @ Q         >        m          m        {                                       	       	 	                                 	     	    	    	  >  	  ,  	  .  	  (H  	  p  	 	   	  ,  	  ,  	    	  4Copyright 2012 The Press Start 2P Project Authors (cody@zone38.net), with Reserved Font Name "Press Start 2P"Press Start 2PRegular3.000;CYRE;PressStart2P-RegularPress Start 2P RegularVersion 3.000PressStart2P-RegularCodeMan38CodeMan38http://www.zone38.net/http://www.zone38.net/This Font Software is licensed under the SIL Open Font License, Version 1.1. This license is available with a FAQ at: http://scripts.sil.org/OFLhttp://scripts.sil.org/OFL C o p y r i g h t   2 0 1 2   T h e   P r e s s   S t a r t   2 P   P r o j e c t   A u t h o r s   ( c o d y @ z o n e 3 8 . n e t ) ,   w i t h   R e s e r v e d   F o n t   N a m e   " P r e s s   S t a r t   2 P " P r e s s   S t a r t   2 P R e g u l a r 3 . 0 0 0 ; C Y R E ; P r e s s S t a r t 2 P - R e g u l a r P r e s s   S t a r t   2 P   R e g u l a r V e r s i o n   3 . 0 0 0 P r e s s S t a r t 2 P - R e g u l a r C o d e M a n 3 8 C o d e M a n 3 8 h t t p : / / w w w . z o n e 3 8 . n e t / h t t p : / / w w w . z o n e 3 8 . n e t / T h i s   F o n t   S o f t w a r e   i s   l i c e n s e d   u n d e r   t h e   S I L   O p e n   F o n t   L i c e n s e ,   V e r s i o n   1 . 1 .   T h i s   l i c e n s e   i s   a v a i l a b l e   w i t h   a   F A Q   a t :   h t t p : / / s c r i p t s . s i l . o r g / O F L h t t p : / / s c r i p t s . s i l . o r g / O F L          2                         $   b  c   % &   d ' 	 ( e
    ) *  + ,      - . /  0 1 !" f 2 #  g $%    3  4 5&'( 6)  * 7+,- 8 .  h /0123 9 :4 ; < 5  =6 7 D i8 k l j9: n m  E F   o;< G = H p>? r s@ qAB I J CDE KFG L  tH v w uIJKL MM NNO OPQRS  P QTUVW x R yX { | zYZ  }  S  T U[\] V^  _ ` Wabc X ~d   efghi Y Zj [ \ k  ]l m    nopqrstuvwxyz{|}~ 	
 !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTU VWXYZ[\]^_`abcdefghij          klmn      ?          "   
   B ^ ` > @    o p          qrst   uv wx yz {       !      a   |   }   ~  # 	       _    A        C     NULLAbreveAmacronAogonekCcircumflex
CdotaccentDcaronDcroatEbreveEcaron
EdotaccentEmacronEogonekGcircumflexGcommaaccent
GdotaccentHbarHcircumflexIJIbreveImacronIogonekItildeJcircumflexKcommaaccentLacuteLcaronLcommaaccentLdotNacuteNcaronNcommaaccentEngObreveOhungarumlautOmacronRacuteRcaronRcommaaccentSacuteScircumflexTbarTcaronuni021AUbreveUhungarumlautUmacronUogonekUringUtildeWcircumflexYcircumflexZacute
Zdotaccentabreveamacronaogonekccircumflex
cdotaccentdcaronebreveecaron
edotaccentemacroneogonekgcircumflexgcommaaccent
gdotaccenthbarhcircumflexibreveijimacroniogonekitildejcircumflexkcommaaccentkgreenlandiclacutelcaronlcommaaccentldotnacutencaronncommaaccentengobreveohungarumlautomacronracutercaronrcommaaccentsacutescircumflexlongstbartcaronuni021Bubreveuhungarumlautumacronuogonekuringutildewcircumflexycircumflexzacute
zdotaccentuni0410uni0411uni0412uni0413uni0403uni0490uni0414uni0415uni0400uni0401uni0416uni0417uni0418uni0419uni040Duni041Auni040Cuni041Buni041Cuni041Duni041Euni041Funi0420uni0421uni0422uni0423uni040Euni0424uni0425uni0427uni0426uni0428uni0429uni040Funi042Cuni042Auni042Buni0409uni040Auni0405uni0404uni042Duni0406uni0407uni0408uni040Buni042Euni042Funi0402uni0462uni046Auni0472uni0474uni0492uni0494uni0496uni0498uni049Auni049Cuni04A0uni04A2uni0524uni04AAuni04ACuni04AEuni04B0uni04B6uni04B8uni04BAuni04C0uni04C1uni04CBuni04D0uni04D2uni04D6uni04D8uni04DCuni04DEuni04E2uni04E4uni04E6uni04E8uni04EEuni04F0uni04F2uni04F4uni04F6uni04F8uni051Auni051Cuni0430uni0431uni0432uni0433uni0453uni0491uni0434uni0435uni0450uni0451uni0436uni0437uni0438uni0439uni045Duni043Auni045Cuni043Buni043Cuni043Duni043Euni043Funi0440uni0441uni0442uni0443uni045Euni0444uni0445uni0447uni0446uni0448uni0449uni045Funi044Cuni044Auni044Buni0459uni045Auni0455uni0454uni044Duni0456uni0457uni0458uni045Buni044Euni044Funi0452uni0463uni046Buni0473uni0475uni0493uni0495uni0497uni0499uni049Buni049Duni04A1uni04A3uni0525uni04ABuni04ADuni04AFuni04B1uni04B7uni04B9uni04BBuni04CFuni04C2uni04CCuni04D1uni04D3uni04D7uni04D9uni04DDuni04DFuni04E3uni04E5uni04E7uni04E9uni04EFuni04F1uni04F3uni04F5uni04F7uni04F9uni051Buni051Duni04A4uni04A5uni04D4uni04D5AlphaBetaGammauni0394EpsilonZetaEtaThetaIotaKappaLambdaMuNuXiOmicronPiRhoSigmaTauUpsilonPhiChiPsiuni03A9
AlphatonosEpsilontonosEtatonos	IotatonosOmicrontonosUpsilontonos
OmegatonosIotadieresisUpsilondieresisalphabetagammadeltaepsilonzetaetathetaiotakappalambdauni03BCnuxiomicronrhouni03C2sigmatauupsilonphichipsiomega	iotatonosiotadieresisiotadieresistonosupsilontonosupsilondieresisupsilondieresistonosomicrontonos
omegatonos
alphatonosepsilontonosetatonosuni037Auni00B9uni00B2uni00B3uni2074uni2015uni00AD	anoteleiauni037Euni00A0DELuni20AFEurouni20B4uni20BDuni20B8uni20AEuni2215uni2206uni00B5arrowup
arrowright	arrowdown	arrowlefttriagupuni25B6triagdnuni25C0uni2605uni2606spadeclubheartdiamondmusicalnoteuniF8FFuni2116uni02D7	gravecomb	acutecombuni0326uni0335uni02BCuni02C9uni02CBuni02CAtonosdieresistonosbrevecombcyuniF100uniF101                                              q  } }w ] } }   } }    q  } }w ] } }   } }    q  } }w ] } }   } }    q  } }w ] } }   } }     ,  UXEY  K QKSZX4(Y`f UX%a  cc#b!! Y C#D  C`B-, `f-, d P&Z(
CEcEEX!%YR[X!#!X PPX!@Y 8PX!8YY 
CEcEad(PX!
CEcE 0PX!0Y PX f a 
PX`  PX!
` 6PX!6``YYY+YY# PXeYY-, E %ad CPX#B#B!!Y`-,#!#! dbB #BEX
CEc
C`Ec*! C  +0%&QX`PaRYX#Y!Y @SX+!@Y# PXeY-,C+  C`B-,#B#  #Babfc`*-,  E Cc b  PX@`Yfc`D`-, CEB*!  C`B-	, C#D  C`B-
,  E +# C%` E#a d  PX! 0PX @YY# PXeY%#aDD`-,  E +# C%` E#a d$PX @Y# PXeY%#aDD`-,  #B
EX!#!Y*!-,EdaD-,`  CJ PX #BYCJ RX #BY-, bfc  c#aC` ` #B#-,KTXdDY$e#x-,KQXKSXdDY!Y$e#x-, CUXCaB+Y C%B%B%B# %PX C`%B #a*!#a #a*! C`%B%a*!YCGCG`b  PX@`Yfc Cc b  PX@`Yfc`  #DC >C`B-,  ETX#B E#B
#`B `a  BB`++"Y-, +-,+-,+-,+-,+-,+-,+-,+-,+-,	+-),# bfc`KTX# .]!!Y-*,# bfc`KTX# .q!!Y-+,# bfc&`KTX# .r!!Y-, + ETX#B E#B
#`B `a  BB`++"Y-, +- ,+-!,+-",+-#,+-$,+-%,+-&,+-',+-(,	+-,, <`--, `` C#`C%a`,*!-.,-+-*-/,  G  Cc b  PX@`Yfc`#a8# UX G  Cc b  PX@`Yfc`#a8!Y-0,  ETX/*EX0Y"Y-1, + ETX/*EX0Y"Y-2, 5`-3, Ec b  PX@`Yfc+Cc b  PX@`Yfc+      D>#82*!-4, < G Cc b  PX@`Yfc` Ca8-5,.<-6, < G Cc b  PX@`Yfc` CaCc8-7, % . G #B%IG#G#a Xb!Y#B6*-8, #B%%G#G#a	C+e.#  <8-9, #B%% .G#G#a #B	C+ `PX @QX  &YBB# C #G#G#a#F`Cb  PX@`Yfc` + a C`d#CadPXCaC`Y%b  PX@`Yfca#  &#Fa8#CF%CG#G#a` Cb  PX@`Yfc`# +#C`+%a%b  PX@`Yfc&a %`d#%`dPX!#!Y#  &#Fa8Y-:, #B   & .G#G#a#<8-;, #B #B   F#G+#a8-<, #B%%G#G#a TX. <#!%%G#G#a %%G#G#a%%I%a  cc# Xb!Yc b  PX@`Yfc`#.#  <8#!Y-=, #B C .G#G#a ` `fb  PX@`Yfc#  <8->,# .F%FCXPRYX <Y..+-?,# .F%FCXRPYX <Y..+-@,# .F%FCXPRYX <Y# .F%FCXRPYX <Y..+-A,8+# .F%FCXPRYX <Y..+-B,9+  <#B8# .F%FCXPRYX <Y..+C..+-C, %& .G#G#a	C+# < .#8.+-D,%B %% .G#G#a #B	C+ `PX @QX  &YBB# GCb  PX@`Yfc` + a C`d#CadPXCaC`Y%b  PX@`Yfca%Fa8# <#8!  F#G+#a8!Y.+-E, 8+..+-F, 9+!#  <#B#8.+C..+-G,  G #B .4*-H,  G #B .4*-I, 5*-J,7*-K, E# . F#a8.+-L,#BK+-M,  D+-N, D+-O, D+-P,D+-Q,  E+-R, E+-S, E+-T,E+-U,   A+-V,  A+-W,  A+-X, A+-Y,  A+-Z, A+-[, A+-\,A+-],  C+-^, C+-_, C+-`,C+-a,  F+-b, F+-c, F+-d,F+-e,   B+-f,  B+-g,  B+-h, B+-i,  B+-j, B+-k, B+-l,B+-m, :+..+-n, :+>+-o, :+?+-p,  :+@+-q,:+>+-r,:+?+-s, :+@+-t, ;+..+-u, ;+>+-v, ;+?+-w, ;+@+-x,;+>+-y,;+?+-z,;+@+-{, <+..+-|, <+>+-}, <+?+-~, <+@+-,<+>+-,<+?+-,<+@+-, =+..+-, =+>+-, =+?+-, =+@+-,=+>+-,=+?+-,=+@+-,	EX!#!YB+e$PxEX0Y-   K RXY  cp BlT<$ * B@
]
E
-
	* B@
iQ9"* B   	* B      	* D$QX@XdD&QX @cTX DYYYY@
aI1* Dd DD          PNG

   IHDR         E  IDATx[;N19K%pt$qCKGCid&oRdfw34oC)aaaaq[EFW Wt W}}X1[\[{nG3{&e;9<H?;-J7Z+M^!6fE3 ?@qBMPhc`k"*"Hw?=eg8fl8e3y-ZZ,"@XDk?B,~+&jbv`>?4ocF (G(W`
:81Y|^:]6,>,}c6P?2Gk?A0Cw\}N?k[GQTPGQT(`O\gg9z6q`O\5gfp T{OQD[,M/^R    IENDB`PNG

   IHDR         E   kIDATx	 @Q,2#{j%R=<         <@_4  iw;I>Zp - /_
#D  D`	p:6    IENDB`PNG

   IHDR            qIDATxd;dwaaFAx"#@RdCE!'m`	X/([\s^<V.?{u{{Uus         lsTj  ^  {xvQ;c }O`=^WFgS]k/OuqT._Y!iTo_d?)6s ."gm[6g  {1 ={0"uH3k\m8 \L/O`jWcou>j?w_\#a@;p0"uH:#KaVqv0 HiE[u>3t2*8
hk A?>zm S"	54Pfq.umtnLeoxC4DG/]o\C[TD6} ]y	eem  g? d^C_20=1 Gz{7c>5dek]n?\oW?uL_[{,` 0 t 9 ?s@to".-% }\fty .!t5xzd~?7wucC W=d
U?# Gj~R:4f5${ht$~I[?~3]{1\}YQe 2<SYe (Y!5 i:g)D{{	Qo1Qo;dN\nh@sD8otvk Vdlf}..g]'Ytts C@ 9,}z]BVdSN"?PA  S?"vE>^~XzOg"Gove0}   ` 0  . \ p[nm    Pj?f Y_  H=hm/  W7 m(
d  j/	h/Yx1/3d=Mo9cG 3^Q}?v ?l_4z} `2^  8C	F+r6mt @dO= ,MS  ` 1KGYGiv .l  r~3)  .N.?{` 8~{c. .2@~ l@R{s	   K= p# s .n gn}7=  .r 82?pN.Uh  bG`~Q p..   \>o4?_   pU@}f}a .w (/ E=Fv,?Esk})_~Xs1 D_> eg6 ?@p3?{ ]cG5 0&= ?1   @	YG}#C}m 0~ Ga`i    ,C@zG~c.g2  e=KM K?r )cT2=y  } K_kckF }ov`S J+#@_WF :D/.  _Rh5 D(c!% >/ 5 ?z!  )Lg @s} ]

Kkm
d 0  ! m:t;q>a ? Eys~`0   ` ?w@d0?0c^plSo@n?v  : ,]tn|I%@-_C5 }6oO
 p,j;^7s;#_]b                   %tM__LW`Ff@okg 	xm d^k z;k zSe` 0J+lg `@}0`G 8l@?={Z
  z?s 6  XoGzdMg  JFKtk_MCz#   vkC@F@-=}X5o7t  p~V@\ }TZ5 # !}n:x  \e4365 KGDh +
Y}GkM{@?S71 a oW:6 Dvd|q	 p#^M~=r[.)es#0 + n~|no?i/ 0()7 l Z ]-
 + j8;wve1%gK `Tn PMoP Xoc  pQ^x<ju  2   ggh2= 2   @!4k1 -                 >3\_}=  +	vh   <NFZLj?p7wNj? Cpog!*	  8p;r;#WTop[kemg? YlRZ_(d **{;!=pQ  0 mvF LdR{6{;Yo=2   i0;DGn_n 8"4Gx:EX?h[Y!=~G:  m2Cz\{]1@T0.?)CzK7  l	Z}vQCT}Mw $ ]BtR5|@G7o?	}`> @p,=!9gS2_mvBtd3BzV pi;3~"i p`!q.F  \/OsoGqQQ: p@TwGIO                   *zjq p_*38YY
!7;8Y _nsGMn7wNj?wyD  \ icpz-DG<*g 7^-jGFvpG *v!
i#?7   3ei98 )Tf[=up   )|%x37GCyo  \}?Rh|[g.8	Kk>u6c;K<s}97  $ lbm0vD^ v6%K !MyMt\r{l~do
[0  @|j7eX
Y@.Q@o)8GEtGF  W7 <o 
/x70TK _{ ]9;gOT  pYmm'r  |x{z} ,GQS/? U 5XoG#o?}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          3FO    IENDB`PNG

   IHDR         Xw  IDATxY1j]AW.mHcbp+I@|_..R\gGf$5~3Faachwh~l_wNO>lso<=.9:tVk{nTF=1 d#ekkknnokO ; ?we@-v{H<7E 9X$ *= }_}%`&$+w X= v~P22 !* j' !$,C0T
=<LF L z3-rHU ^tTWzF>;@`Dj@	P'oIy o?X9Q74 SYwQ&VD@&PDX*,a 2EV*2`0_ Vh(}vv$G~/Kl D  *;T]iY-f+Tlx1G/["0"RDcP!KlJb(DF$ J2A8rX#X=+] 6p$+m`+$T_t%" J= x    IENDB`local anim8 = {
  _VERSION     = 'anim8 v2.3.0',
  _DESCRIPTION = 'An animation library for LVE',
  _URL         = 'https://github.com/kikito/anim8',
  _LICENSE     = [[
    MIT LICENSE

    Copyright (c) 2011 Enrique Garca Cota

    Permission is hereby granted, free of charge, to any person obtaining a
    copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be included
    in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
    OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
    IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
    CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
    TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
    SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
  ]]
}

local Grid = {}

local _frames = {}

local function assertPositiveInteger(value, name)
  if type(value) ~= 'number' then error(("%s should be a number, was %q"):format(name, tostring(value))) end
  if value < 1 then error(("%s should be a positive number, was %d"):format(name, value)) end
  if value ~= math.floor(value) then error(("%s should be an integer, was %d"):format(name, value)) end
end

local function createFrame(self, x, y)
  local fw, fh = self.frameWidth, self.frameHeight
  return love.graphics.newQuad(
    self.left + (x-1) * fw + x * self.border,
    self.top  + (y-1) * fh + y * self.border,
    fw,
    fh,
    self.imageWidth,
    self.imageHeight
  )
end

local function getGridKey(...)
  return table.concat( {...} ,'-' )
end

local function getOrCreateFrame(self, x, y)
  if x < 1 or x > self.width or y < 1 or y > self.height then
    error(("There is no frame for x=%d, y=%d"):format(x, y))
  end
  local key = self._key
  _frames[key]       = _frames[key]       or {}
  _frames[key][x]    = _frames[key][x]    or {}
  _frames[key][x][y] = _frames[key][x][y] or createFrame(self, x, y)
  return _frames[key][x][y]
end

local function parseInterval(str)
  if type(str) == "number" then return str,str,1 end
  str = str:gsub('%s', '') -- remove spaces
  local min, max = str:match("^(%d+)-(%d+)$")
  assert(min and max, ("Could not parse interval from %q"):format(str))
  min, max = tonumber(min), tonumber(max)
  local step = min <= max and 1 or -1
  return min, max, step
end

function Grid:getFrames(...)
  local result, args = {}, {...}
  local minx, maxx, stepx, miny, maxy, stepy

  for i=1, #args, 2 do
    minx, maxx, stepx = parseInterval(args[i])
    miny, maxy, stepy = parseInterval(args[i+1])
    for y = miny, maxy, stepy do
      for x = minx, maxx, stepx do
        result[#result+1] = getOrCreateFrame(self,x,y)
      end
    end
  end

  return result
end

local Gridmt = {
  __index = Grid,
  __call  = Grid.getFrames
}

local function newGrid(frameWidth, frameHeight, imageWidth, imageHeight, left, top, border)
  assertPositiveInteger(frameWidth,  "frameWidth")
  assertPositiveInteger(frameHeight, "frameHeight")
  assertPositiveInteger(imageWidth,  "imageWidth")
  assertPositiveInteger(imageHeight, "imageHeight")

  left   = left   or 0
  top    = top    or 0
  border = border or 0

  local key  = getGridKey(frameWidth, frameHeight, imageWidth, imageHeight, left, top, border)

  local grid = setmetatable(
    { frameWidth  = frameWidth,
      frameHeight = frameHeight,
      imageWidth  = imageWidth,
      imageHeight = imageHeight,
      left        = left,
      top         = top,
      border      = border,
      width       = math.floor(imageWidth/frameWidth),
      height      = math.floor(imageHeight/frameHeight),
      _key        = key
    },
    Gridmt
  )
  return grid
end

-----------------------------------------------------------

local Animation = {}

local function cloneArray(arr)
  local result = {}
  for i=1,#arr do result[i] = arr[i] end
  return result
end

local function parseDurations(durations, frameCount)
  local result = {}
  if type(durations) == 'number' then
    for i=1,frameCount do result[i] = durations end
  else
    local min, max, step
    for key,duration in pairs(durations) do
      assert(type(duration) == 'number', "The value [" .. tostring(duration) .. "] should be a number")
      min, max, step = parseInterval(key)
      for i = min,max,step do result[i] = duration end
    end
  end

  if #result < frameCount then
    error("The durations table has length of " .. tostring(#result) .. ", but it should be >= " .. tostring(frameCount))
  end

  return result
end

local function parseIntervals(durations)
  local result, time = {0},0
  for i=1,#durations do
    time = time + durations[i]
    result[i+1] = time
  end
  return result, time
end

local Animationmt = { __index = Animation }
local nop = function() end

local function newAnimation(frames, durations, onLoop)
  local td = type(durations);
  if (td ~= 'number' or durations <= 0) and td ~= 'table' then
    error("durations must be a positive number. Was " .. tostring(durations) )
  end
  onLoop = onLoop or nop
  durations = parseDurations(durations, #frames)
  local intervals, totalDuration = parseIntervals(durations)
  return setmetatable({
      frames         = cloneArray(frames),
      durations      = durations,
      intervals      = intervals,
      totalDuration  = totalDuration,
      onLoop         = onLoop,
      timer          = 0,
      position       = 1,
      status         = "playing",
      flippedH       = false,
      flippedV       = false
    },
    Animationmt
  )
end

function Animation:clone()
  local newAnim = newAnimation(self.frames, self.durations, self.onLoop)
  newAnim.flippedH, newAnim.flippedV = self.flippedH, self.flippedV
  return newAnim
end

function Animation:flipH()
  self.flippedH = not self.flippedH
  return self
end

function Animation:flipV()
  self.flippedV = not self.flippedV
  return self
end

local function seekFrameIndex(intervals, timer)
  local high, low, i = #intervals-1, 1, 1

  while(low <= high) do
    i = math.floor((low + high) / 2)
    if     timer >  intervals[i+1] then low  = i + 1
    elseif timer <= intervals[i]   then high = i - 1
    else
      return i
    end
  end

  return i
end

function Animation:update(dt)
  if self.status ~= "playing" then return end

  self.timer = self.timer + dt
  local loops = math.floor(self.timer / self.totalDuration)
  if loops ~= 0 then
    self.timer = self.timer - self.totalDuration * loops
    local f = type(self.onLoop) == 'function' and self.onLoop or self[self.onLoop]
    f(self, loops)
  end

  self.position = seekFrameIndex(self.intervals, self.timer)
end

function Animation:pause()
  self.status = "paused"
end

function Animation:gotoFrame(position)
  self.position = position
  self.timer = self.intervals[self.position]
end

function Animation:pauseAtEnd()
  self.position = #self.frames
  self.timer = self.totalDuration
  self:pause()
end

function Animation:pauseAtStart()
  self.position = 1
  self.timer = 0
  self:pause()
end

function Animation:resume()
  self.status = "playing"
end

function Animation:draw(image, x, y, r, sx, sy, ox, oy, kx, ky)
  love.graphics.draw(image, self:getFrameInfo(x, y, r, sx, sy, ox, oy, kx, ky))
end

function Animation:getFrameInfo(x, y, r, sx, sy, ox, oy, kx, ky)
  local frame = self.frames[self.position]
  if self.flippedH or self.flippedV then
    r,sx,sy,ox,oy,kx,ky = r or 0, sx or 1, sy or 1, ox or 0, oy or 0, kx or 0, ky or 0
    local _,_,w,h = frame:getViewport()

    if self.flippedH then
      sx = sx * -1
      ox = w - ox
      kx = kx * -1
      ky = ky * -1
    end

    if self.flippedV then
      sy = sy * -1
      oy = h - oy
      kx = kx * -1
      ky = ky * -1
    end
  end
  return frame, x, y, r, sx, sy, ox, oy, kx, ky
end

function Animation:getDimensions()
  local _,_,w,h = self.frames[self.position]:getViewport()
  return w,h
end

-----------------------------------------------------------

anim8.newGrid       = newGrid
anim8.newAnimation  = newAnimation

return anim8
-- bresenham.lua - v1.0 (2012-05)
-- Copyright (c) 2011 Enrique Garca Cota
-- Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
-- The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

local function los(x0,y0,x1,y1, callback)

  local sx,sy,dx,dy

  if x0 < x1 then
    sx = 1
    dx = x1 - x0
  else
    sx = -1
    dx = x0 - x1
  end

  if y0 < y1 then
    sy = 1
    dy = y1 - y0
  else
    sy = -1
    dy = y0 - y1
  end

  local err, e2 = dx-dy, nil

  if not callback(x0, y0) then return false end

  while not(x0 == x1 and y0 == y1) do
    e2 = err + err
    if e2 > -dy then
      err = err - dy
      x0  = x0 + sx
    end
    if e2 < dx then
      err = err + dx
      y0  = y0 + sy
    end
    if not callback(x0, y0) then return false end
  end

  return true
end

local function line(x0,y0,x1,y1,callback)
  local points = {}
  local count = 0
  local result = los(x0,y0,x1,y1, function(x,y)
    if callback and not callback(x,y) then return false end
    count = count + 1
    points[count] = {x,y}
    return true
  end)
  return points, result
end

return {
  los = los,
  line = line,
}
local bump = {
  _VERSION     = 'bump v3.1.5',
  _URL         = 'https://github.com/kikito/bump.lua',
  _DESCRIPTION = 'A collision detection library for Lua',
  _LICENSE     = [[
    MIT LICENSE

    Copyright (c) 2014 Enrique Garca Cota

    Permission is hereby granted, free of charge, to any person obtaining a
    copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be included
    in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
    OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
    IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
    CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
    TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
    SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
  ]]
}

------------------------------------------
-- Auxiliary functions
------------------------------------------
local DELTA = 1e-10 -- floating-point margin of error

local abs, floor, ceil, min, max = math.abs, math.floor, math.ceil, math.min, math.max

local function sign(x)
  if x > 0 then return 1 end
  if x == 0 then return 0 end
  return -1
end

local function nearest(x, a, b)
  if abs(a - x) < abs(b - x) then return a else return b end
end

local function assertType(desiredType, value, name)
  if type(value) ~= desiredType then
    error(name .. ' must be a ' .. desiredType .. ', but was ' .. tostring(value) .. '(a ' .. type(value) .. ')')
  end
end

local function assertIsPositiveNumber(value, name)
  if type(value) ~= 'number' or value <= 0 then
    error(name .. ' must be a positive integer, but was ' .. tostring(value) .. '(' .. type(value) .. ')')
  end
end

local function assertIsRect(x,y,w,h)
  assertType('number', x, 'x')
  assertType('number', y, 'y')
  assertIsPositiveNumber(w, 'w')
  assertIsPositiveNumber(h, 'h')
end

local defaultFilter = function()
  return 'slide'
end

------------------------------------------
-- Rectangle functions
------------------------------------------

local function rect_getNearestCorner(x,y,w,h, px, py)
  return nearest(px, x, x+w), nearest(py, y, y+h)
end

-- This is a generalized implementation of the liang-barsky algorithm, which also returns
-- the normals of the sides where the segment intersects.
-- Returns nil if the segment never touches the rect
-- Notice that normals are only guaranteed to be accurate when initially ti1, ti2 == -math.huge, math.huge
local function rect_getSegmentIntersectionIndices(x,y,w,h, x1,y1,x2,y2, ti1,ti2)
  ti1, ti2 = ti1 or 0, ti2 or 1
  local dx, dy = x2-x1, y2-y1
  local nx, ny
  local nx1, ny1, nx2, ny2 = 0,0,0,0
  local p, q, r

  for side = 1,4 do
    if     side == 1 then nx,ny,p,q = -1,  0, -dx, x1 - x     -- left
    elseif side == 2 then nx,ny,p,q =  1,  0,  dx, x + w - x1 -- right
    elseif side == 3 then nx,ny,p,q =  0, -1, -dy, y1 - y     -- top
    else                  nx,ny,p,q =  0,  1,  dy, y + h - y1 -- bottom
    end

    if p == 0 then
      if q <= 0 then return nil end
    else
      r = q / p
      if p < 0 then
        if     r > ti2 then return nil
        elseif r > ti1 then ti1,nx1,ny1 = r,nx,ny
        end
      else -- p > 0
        if     r < ti1 then return nil
        elseif r < ti2 then ti2,nx2,ny2 = r,nx,ny
        end
      end
    end
  end

  return ti1,ti2, nx1,ny1, nx2,ny2
end

-- Calculates the minkowsky difference between 2 rects, which is another rect
local function rect_getDiff(x1,y1,w1,h1, x2,y2,w2,h2)
  return x2 - x1 - w1,
         y2 - y1 - h1,
         w1 + w2,
         h1 + h2
end

local function rect_containsPoint(x,y,w,h, px,py)
  return px - x > DELTA      and py - y > DELTA and
         x + w - px > DELTA  and y + h - py > DELTA
end

local function rect_isIntersecting(x1,y1,w1,h1, x2,y2,w2,h2)
  return x1 < x2+w2 and x2 < x1+w1 and
         y1 < y2+h2 and y2 < y1+h1
end

local function rect_getSquareDistance(x1,y1,w1,h1, x2,y2,w2,h2)
  local dx = x1 - x2 + (w1 - w2)/2
  local dy = y1 - y2 + (h1 - h2)/2
  return dx*dx + dy*dy
end

local function rect_detectCollision(x1,y1,w1,h1, x2,y2,w2,h2, goalX, goalY)
  goalX = goalX or x1
  goalY = goalY or y1

  local dx, dy      = goalX - x1, goalY - y1
  local x,y,w,h     = rect_getDiff(x1,y1,w1,h1, x2,y2,w2,h2)

  local overlaps, ti, nx, ny

  if rect_containsPoint(x,y,w,h, 0,0) then -- item was intersecting other
    local px, py    = rect_getNearestCorner(x,y,w,h, 0, 0)
    local wi, hi    = min(w1, abs(px)), min(h1, abs(py)) -- area of intersection
    ti              = -wi * hi -- ti is the negative area of intersection
    overlaps = true
  else
    local ti1,ti2,nx1,ny1 = rect_getSegmentIntersectionIndices(x,y,w,h, 0,0,dx,dy, -math.huge, math.huge)

    -- item tunnels into other
    if ti1 and ti1 < 1 and (0 < ti1 + DELTA or 0 == ti1 and ti2 > 0) then
      ti, nx, ny = ti1, nx1, ny1
      overlaps   = false
    end
  end

  if not ti then return end

  local tx, ty

  if overlaps then
    if dx == 0 and dy == 0 then
      -- intersecting and not moving - use minimum displacement vector
      local px, py = rect_getNearestCorner(x,y,w,h, 0,0)
      if abs(px) < abs(py) then py = 0 else px = 0 end
      nx, ny = sign(px), sign(py)
      tx, ty = x1 + px, y1 + py
    else
      -- intersecting and moving - move in the opposite direction
      local ti1, _
      ti1,_,nx,ny = rect_getSegmentIntersectionIndices(x,y,w,h, 0,0,dx,dy, -math.huge, 1)
      if not ti1 then return end
      tx, ty = x1 + dx * ti1, y1 + dy * ti1
    end
  else -- tunnel
    tx, ty = x1 + dx * ti, y1 + dy * ti
  end

  return {
    overlaps  = overlaps,
    ti        = ti,
    move      = {x = dx, y = dy},
    normal    = {x = nx, y = ny},
    touch     = {x = tx, y = ty},
    itemRect  = {x = x1, y = y1, w = w1, h = h1},
    otherRect = {x = x2, y = y2, w = w2, h = h2}
  }
end

------------------------------------------
-- Grid functions
------------------------------------------

local function grid_toWorld(cellSize, cx, cy)
  return (cx - 1)*cellSize, (cy-1)*cellSize
end

local function grid_toCell(cellSize, x, y)
  return floor(x / cellSize) + 1, floor(y / cellSize) + 1
end

-- grid_traverse* functions are based on "A Fast Voxel Traversal Algorithm for Ray Tracing",
-- by John Amanides and Andrew Woo - http://www.cse.yorku.ca/~amana/research/grid.pdf
-- It has been modified to include both cells when the ray "touches a grid corner",
-- and with a different exit condition

local function grid_traverse_initStep(cellSize, ct, t1, t2)
  local v = t2 - t1
  if     v > 0 then
    return  1,  cellSize / v, ((ct + v) * cellSize - t1) / v
  elseif v < 0 then
    return -1, -cellSize / v, ((ct + v - 1) * cellSize - t1) / v
  else
    return 0, math.huge, math.huge
  end
end

local function grid_traverse(cellSize, x1,y1,x2,y2, f)
  local cx1,cy1        = grid_toCell(cellSize, x1,y1)
  local cx2,cy2        = grid_toCell(cellSize, x2,y2)
  local stepX, dx, tx  = grid_traverse_initStep(cellSize, cx1, x1, x2)
  local stepY, dy, ty  = grid_traverse_initStep(cellSize, cy1, y1, y2)
  local cx,cy          = cx1,cy1

  f(cx, cy)

  -- The default implementation had an infinite loop problem when
  -- approaching the last cell in some occassions. We finish iterating
  -- when we are *next* to the last cell
  while abs(cx - cx2) + abs(cy - cy2) > 1 do
    if tx < ty then
      tx, cx = tx + dx, cx + stepX
      f(cx, cy)
    else
      -- Addition: include both cells when going through corners
      if tx == ty then f(cx + stepX, cy) end
      ty, cy = ty + dy, cy + stepY
      f(cx, cy)
    end
  end

  -- If we have not arrived to the last cell, use it
  if cx ~= cx2 or cy ~= cy2 then f(cx2, cy2) end

end

local function grid_toCellRect(cellSize, x,y,w,h)
  local cx,cy = grid_toCell(cellSize, x, y)
  local cr,cb = ceil((x+w) / cellSize), ceil((y+h) / cellSize)
  return cx, cy, cr - cx + 1, cb - cy + 1
end

------------------------------------------
-- Responses
------------------------------------------

local touch = function(world, col, x,y,w,h, goalX, goalY, filter)
  return col.touch.x, col.touch.y, {}, 0
end

local cross = function(world, col, x,y,w,h, goalX, goalY, filter)
  local cols, len = world:project(col.item, x,y,w,h, goalX, goalY, filter)
  return goalX, goalY, cols, len
end

local slide = function(world, col, x,y,w,h, goalX, goalY, filter)
  goalX = goalX or x
  goalY = goalY or y

  local tch, move  = col.touch, col.move
  local sx, sy     = tch.x, tch.y
  if move.x ~= 0 or move.y ~= 0 then
    if col.normal.x == 0 then
      sx = goalX
    else
      sy = goalY
    end
  end

  col.slide = {x = sx, y = sy}

  x,y          = tch.x, tch.y
  goalX, goalY = sx, sy
  local cols, len  = world:project(col.item, x,y,w,h, goalX, goalY, filter)
  return goalX, goalY, cols, len
end

local bounce = function(world, col, x,y,w,h, goalX, goalY, filter)
  goalX = goalX or x
  goalY = goalY or y

  local tch, move = col.touch, col.move
  local tx, ty = tch.x, tch.y

  local bx, by = tx, ty

  if move.x ~= 0 or move.y ~= 0 then
    local bnx, bny = goalX - tx, goalY - ty
    if col.normal.x == 0 then bny = -bny else bnx = -bnx end
    bx, by = tx + bnx, ty + bny
  end

  col.bounce   = {x = bx,  y = by}
  x,y          = tch.x, tch.y
  goalX, goalY = bx, by

  local cols, len    = world:project(col.item, x,y,w,h, goalX, goalY, filter)
  return goalX, goalY, cols, len
end

------------------------------------------
-- World
------------------------------------------

local World = {}
local World_mt = {__index = World}

-- Private functions and methods

local function sortByWeight(a,b) return a.weight < b.weight end

local function sortByTiAndDistance(a,b)
  if a.ti == b.ti then
    local ir, ar, br = a.itemRect, a.otherRect, b.otherRect
    local ad = rect_getSquareDistance(ir.x,ir.y,ir.w,ir.h, ar.x,ar.y,ar.w,ar.h)
    local bd = rect_getSquareDistance(ir.x,ir.y,ir.w,ir.h, br.x,br.y,br.w,br.h)
    return ad < bd
  end
  return a.ti < b.ti
end

local function addItemToCell(self, item, cx, cy)
  self.rows[cy] = self.rows[cy] or setmetatable({}, {__mode = 'v'})
  local row = self.rows[cy]
  row[cx] = row[cx] or {itemCount = 0, x = cx, y = cy, items = setmetatable({}, {__mode = 'k'})}
  local cell = row[cx]
  self.nonEmptyCells[cell] = true
  if not cell.items[item] then
    cell.items[item] = true
    cell.itemCount = cell.itemCount + 1
  end
end

local function removeItemFromCell(self, item, cx, cy)
  local row = self.rows[cy]
  if not row or not row[cx] or not row[cx].items[item] then return false end

  local cell = row[cx]
  cell.items[item] = nil
  cell.itemCount = cell.itemCount - 1
  if cell.itemCount == 0 then
    self.nonEmptyCells[cell] = nil
  end
  return true
end

local function getDictItemsInCellRect(self, cl,ct,cw,ch)
  local items_dict = {}
  for cy=ct,ct+ch-1 do
    local row = self.rows[cy]
    if row then
      for cx=cl,cl+cw-1 do
        local cell = row[cx]
        if cell and cell.itemCount > 0 then -- no cell.itemCount > 1 because tunneling
          for item,_ in pairs(cell.items) do
            items_dict[item] = true
          end
        end
      end
    end
  end

  return items_dict
end

local function getCellsTouchedBySegment(self, x1,y1,x2,y2)

  local cells, cellsLen, visited = {}, 0, {}

  grid_traverse(self.cellSize, x1,y1,x2,y2, function(cx, cy)
    local row  = self.rows[cy]
    if not row then return end
    local cell = row[cx]
    if not cell or visited[cell] then return end

    visited[cell] = true
    cellsLen = cellsLen + 1
    cells[cellsLen] = cell
  end)

  return cells, cellsLen
end

local function getInfoAboutItemsTouchedBySegment(self, x1,y1, x2,y2, filter)
  local cells, len = getCellsTouchedBySegment(self, x1,y1,x2,y2)
  local cell, rect, l,t,w,h, ti1,ti2, tii0,tii1
  local visited, itemInfo, itemInfoLen = {},{},0
  for i=1,len do
    cell = cells[i]
    for item in pairs(cell.items) do
      if not visited[item] then
        visited[item]  = true
        if (not filter or filter(item)) then
          rect           = self.rects[item]
          l,t,w,h        = rect.x,rect.y,rect.w,rect.h

          ti1,ti2 = rect_getSegmentIntersectionIndices(l,t,w,h, x1,y1, x2,y2, 0, 1)
          if ti1 and ((0 < ti1 and ti1 < 1) or (0 < ti2 and ti2 < 1)) then
            -- the sorting is according to the t of an infinite line, not the segment
            tii0,tii1    = rect_getSegmentIntersectionIndices(l,t,w,h, x1,y1, x2,y2, -math.huge, math.huge)
            itemInfoLen  = itemInfoLen + 1
            itemInfo[itemInfoLen] = {item = item, ti1 = ti1, ti2 = ti2, weight = min(tii0,tii1)}
          end
        end
      end
    end
  end
  table.sort(itemInfo, sortByWeight)
  return itemInfo, itemInfoLen
end

local function getResponseByName(self, name)
  local response = self.responses[name]
  if not response then
    error(('Unknown collision type: %s (%s)'):format(name, type(name)))
  end
  return response
end


-- Misc Public Methods

function World:addResponse(name, response)
  self.responses[name] = response
end

function World:project(item, x,y,w,h, goalX, goalY, filter)
  assertIsRect(x,y,w,h)

  goalX = goalX or x
  goalY = goalY or y
  filter  = filter  or defaultFilter

  local collisions, len = {}, 0

  local visited = {}
  if item ~= nil then visited[item] = true end

  -- This could probably be done with less cells using a polygon raster over the cells instead of a
  -- bounding rect of the whole movement. Conditional to building a queryPolygon method
  local tl, tt = min(goalX, x),       min(goalY, y)
  local tr, tb = max(goalX + w, x+w), max(goalY + h, y+h)
  local tw, th = tr-tl, tb-tt

  local cl,ct,cw,ch = grid_toCellRect(self.cellSize, tl,tt,tw,th)

  local dictItemsInCellRect = getDictItemsInCellRect(self, cl,ct,cw,ch)

  for other,_ in pairs(dictItemsInCellRect) do
    if not visited[other] then
      visited[other] = true

      local responseName = filter(item, other)
      if responseName then
        local ox,oy,ow,oh   = self:getRect(other)
        local col           = rect_detectCollision(x,y,w,h, ox,oy,ow,oh, goalX, goalY)

        if col then
          col.other    = other
          col.item     = item
          col.type     = responseName

          len = len + 1
          collisions[len] = col
        end
      end
    end
  end

  table.sort(collisions, sortByTiAndDistance)

  return collisions, len
end

function World:countCells()
  local count = 0
  for _,row in pairs(self.rows) do
    for _,_ in pairs(row) do
      count = count + 1
    end
  end
  return count
end

function World:hasItem(item)
  return not not self.rects[item]
end

function World:getItems()
  local items, len = {}, 0
  for item,_ in pairs(self.rects) do
    len = len + 1
    items[len] = item
  end
  return items, len
end

function World:countItems()
  local len = 0
  for _ in pairs(self.rects) do len = len + 1 end
  return len
end

function World:getRect(item)
  local rect = self.rects[item]
  if not rect then
    error('Item ' .. tostring(item) .. ' must be added to the world before getting its rect. Use world:add(item, x,y,w,h) to add it first.')
  end
  return rect.x, rect.y, rect.w, rect.h
end

function World:toWorld(cx, cy)
  return grid_toWorld(self.cellSize, cx, cy)
end

function World:toCell(x,y)
  return grid_toCell(self.cellSize, x, y)
end


--- Query methods

function World:queryRect(x,y,w,h, filter)

  local cl,ct,cw,ch = grid_toCellRect(self.cellSize, x,y,w,h)
  local dictItemsInCellRect = getDictItemsInCellRect(self, cl,ct,cw,ch)

  local items, len = {}, 0

  local rect
  for item,_ in pairs(dictItemsInCellRect) do
    rect = self.rects[item]
    if (not filter or filter(item))
    and rect_isIntersecting(x,y,w,h, rect.x, rect.y, rect.w, rect.h)
    then
      len = len + 1
      items[len] = item
    end
  end

  return items, len
end

function World:queryPoint(x,y, filter)
  local cx,cy = self:toCell(x,y)
  local dictItemsInCellRect = getDictItemsInCellRect(self, cx,cy,1,1)

  local items, len = {}, 0

  local rect
  for item,_ in pairs(dictItemsInCellRect) do
    rect = self.rects[item]
    if (not filter or filter(item))
    and rect_containsPoint(rect.x, rect.y, rect.w, rect.h, x, y)
    then
      len = len + 1
      items[len] = item
    end
  end

  return items, len
end

function World:querySegment(x1, y1, x2, y2, filter)
  local itemInfo, len = getInfoAboutItemsTouchedBySegment(self, x1, y1, x2, y2, filter)
  local items = {}
  for i=1, len do
    items[i] = itemInfo[i].item
  end
  return items, len
end

function World:querySegmentWithCoords(x1, y1, x2, y2, filter)
  local itemInfo, len = getInfoAboutItemsTouchedBySegment(self, x1, y1, x2, y2, filter)
  local dx, dy        = x2-x1, y2-y1
  local info, ti1, ti2
  for i=1, len do
    info  = itemInfo[i]
    ti1   = info.ti1
    ti2   = info.ti2

    info.weight  = nil
    info.x1      = x1 + dx * ti1
    info.y1      = y1 + dy * ti1
    info.x2      = x1 + dx * ti2
    info.y2      = y1 + dy * ti2
  end
  return itemInfo, len
end


--- Main methods

function World:add(item, x,y,w,h)
  local rect = self.rects[item]
  if rect then
    error('Item ' .. tostring(item) .. ' added to the world twice.')
  end
  assertIsRect(x,y,w,h)

  self.rects[item] = {x=x,y=y,w=w,h=h}

  local cl,ct,cw,ch = grid_toCellRect(self.cellSize, x,y,w,h)
  for cy = ct, ct+ch-1 do
    for cx = cl, cl+cw-1 do
      addItemToCell(self, item, cx, cy)
    end
  end

  return item
end

function World:remove(item)
  local x,y,w,h = self:getRect(item)

  self.rects[item] = nil
  local cl,ct,cw,ch = grid_toCellRect(self.cellSize, x,y,w,h)
  for cy = ct, ct+ch-1 do
    for cx = cl, cl+cw-1 do
      removeItemFromCell(self, item, cx, cy)
    end
  end
end

function World:update(item, x2,y2,w2,h2)
  local x1,y1,w1,h1 = self:getRect(item)
  w2,h2 = w2 or w1, h2 or h1
  assertIsRect(x2,y2,w2,h2)

  if x1 ~= x2 or y1 ~= y2 or w1 ~= w2 or h1 ~= h2 then

    local cellSize = self.cellSize
    local cl1,ct1,cw1,ch1 = grid_toCellRect(cellSize, x1,y1,w1,h1)
    local cl2,ct2,cw2,ch2 = grid_toCellRect(cellSize, x2,y2,w2,h2)

    if cl1 ~= cl2 or ct1 ~= ct2 or cw1 ~= cw2 or ch1 ~= ch2 then

      local cr1, cb1 = cl1+cw1-1, ct1+ch1-1
      local cr2, cb2 = cl2+cw2-1, ct2+ch2-1
      local cyOut

      for cy = ct1, cb1 do
        cyOut = cy < ct2 or cy > cb2
        for cx = cl1, cr1 do
          if cyOut or cx < cl2 or cx > cr2 then
            removeItemFromCell(self, item, cx, cy)
          end
        end
      end

      for cy = ct2, cb2 do
        cyOut = cy < ct1 or cy > cb1
        for cx = cl2, cr2 do
          if cyOut or cx < cl1 or cx > cr1 then
            addItemToCell(self, item, cx, cy)
          end
        end
      end

    end

    local rect = self.rects[item]
    rect.x, rect.y, rect.w, rect.h = x2,y2,w2,h2

  end
end

function World:move(item, goalX, goalY, filter)
  local actualX, actualY, cols, len = self:check(item, goalX, goalY, filter)

  self:update(item, actualX, actualY)

  return actualX, actualY, cols, len
end

function World:check(item, goalX, goalY, filter)
  filter = filter or defaultFilter

  local visited = {[item] = true}
  local visitedFilter = function(itm, other)
    if visited[other] then return false end
    return filter(itm, other)
  end

  local cols, len = {}, 0

  local x,y,w,h = self:getRect(item)

  local projected_cols, projected_len = self:project(item, x,y,w,h, goalX,goalY, visitedFilter)

  while projected_len > 0 do
    local col = projected_cols[1]
    len       = len + 1
    cols[len] = col

    visited[col.other] = true

    local response = getResponseByName(self, col.type)

    goalX, goalY, projected_cols, projected_len = response(
      self,
      col,
      x, y, w, h,
      goalX, goalY,
      visitedFilter
    )
  end

  return goalX, goalY, cols, len
end


-- Public library functions

bump.newWorld = function(cellSize)
  cellSize = cellSize or 64
  assertIsPositiveNumber(cellSize, 'cellSize')
  local world = setmetatable({
    cellSize       = cellSize,
    rects          = {},
    rows           = {},
    nonEmptyCells  = {},
    responses = {}
  }, World_mt)

  world:addResponse('touch', touch)
  world:addResponse('cross', cross)
  world:addResponse('slide', slide)
  world:addResponse('bounce', bounce)

  return world
end

bump.rect = {
  getNearestCorner              = rect_getNearestCorner,
  getSegmentIntersectionIndices = rect_getSegmentIntersectionIndices,
  getDiff                       = rect_getDiff,
  containsPoint                 = rect_containsPoint,
  isIntersecting                = rect_isIntersecting,
  getSquareDistance             = rect_getSquareDistance,
  detectCollision               = rect_detectCollision
}

bump.responses = {
  touch  = touch,
  cross  = cross,
  slide  = slide,
  bounce = bounce
}

return bump
--[[
  UNLICENSE

    This is free and unencumbered software released into the public domain.

    Anyone is free to copy, modify, publish, use, compile, sell, or distribute this
    software, either in source code form or as a compiled binary, for any purpose,
    commercial or non-commercial, and by any means.

    In jurisdictions that recognize copyright laws, the author or authors of this
    software dedicate any and all copyright interest in the software to the public
    domain.  We make this dedication for the benefit of the public at large and to
    the detriment of our heirs and successors.  We intend this dedication to be an
    overt act of relinquishment in perpetuity of all present and future rights to
    this software under copyright law.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTBILITY, FITNESS
    FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT, IN NO EVENT SHALL THE AUTHORS BE
    LIABLE FOR ANY CLAIM, DAMAGES, OR OTHER LIABILITY, WHETHER IN AN ACTION OF
    CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
    SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

    For more information, please refer to <http://unlicense.org/>
]]

-- Code based on https://github.com/icrawler/FPSGraph

local debugGraph = {}

function debugGraph:new(type, x, y, width, height, delay, label, font)
  if ({mem=0, fps=0, custom=0})[type] == nil then
    error('Acceptable types: mem, fps, custom')
  end

  local instance = {
    x = x or 0, -- X position
    y = y or 0, -- Y position
    width = width or 50, -- Graph width
    height = height or 30, -- Graph height
    delay = delay or 0.5, -- Update delay
    label = label or type, -- Graph label
    font = font or love.graphics.newFont(8),
    data = {},
    _max = 0,
    _time = 0,
    _type = type,
  }

  -- Build base data
  for i = 0, math.floor(instance.width / 2) do
    table.insert(instance.data, 0)
  end

  -- Updating the graph
  function instance:update(dt, val)
    local lastTime = self._time
    self._time = (self._time + dt) % self.delay

    -- Check if the minimum amount of time has past
    if dt > self.delay or lastTime > self._time then
      -- Fetch data if needed
      if val == nil then
        if self._type == 'fps' then
          -- Collect fps info and update the label
          val = 0.75 * 1 / dt + 0.25 * love.timer.getFPS()
          self.label = "FPS: " .. math.floor(val * 10) / 10
        elseif self._type == 'mem' then
          -- Collect memory info and update the label
          val = collectgarbage('count')
          self.label = "Memory (KB): " .. math.floor(val * 10) / 10
        else
          -- If the val is nil then we'll just skip this time
          return
        end
      end


      -- pop the old data and push new data
      table.remove(self.data, 1)
      table.insert(self.data, val)

      -- Find the highest value
      local max = 0
      for i=1, #self.data do
        local v = self.data[i]
        if v > max then
          max = v
        end
      end

      self._max = max
    end
  end

  function instance:draw()
    -- Store the currently set font and change the font to our own
    local fontCache = love.graphics.getFont()
    love.graphics.setFont(self.font)

    local max = math.ceil(self._max/10) * 10 + 20
    local len = #self.data
    local steps = self.width / len

    -- Build the line data
    local lineData = {}
    for i=1, len do
      -- Build the X and Y of the point
      local x = steps * (i - 1) + self.x
      local y = self.height * (-self.data[i] / max + 1) + self.y

      -- Append it to the line
      table.insert(lineData, x)
      table.insert(lineData, y)
    end

    -- Draw the line
    love.graphics.line(unpack(lineData))

    -- Print the label
    if self.label ~= '' then
      love.graphics.print(self.label, self.x, self.y + self.height - self.font:getHeight())
    end

    -- Reset the font
    love.graphics.setFont(fontCache)
  end

  return instance
end

return debugGraph---------------
-- ## Delaunay, Lua module for convex polygon triangulation
-- @author Roland Yonaba
-- @copyright 2013-2016
-- @license MIT
-- @script delaunay

-- ================
-- Private helpers
-- ================

local setmetatable = setmetatable
local tostring     = tostring
local assert       = assert
local unpack       = unpack or table.unpack
local remove       = table.remove
local sqrt         = math.sqrt
local max          = math.max

-- Internal class constructor
local class = function(...)
  local klass = {}
  klass.__index = klass
  klass.__call = function(_,...) return klass:new(...) end
  function klass:new(...)
    local instance = setmetatable({}, klass)
    klass.__init(instance, ...)
    return instance
  end
  return setmetatable(klass,{__call = klass.__call})
end

-- Triangle semi-perimeter by Heron's formula
local function quatCross(a, b, c)
  local p = (a + b + c) * (a + b - c) * (a - b + c) * (-a + b + c)
  return sqrt(p)
end


-- Cross product (p1-p2, p2-p3)
local function crossProduct(p1, p2, p3)
  local x1, x2 = p2.x - p1.x, p3.x - p2.x
  local y1, y2 = p2.y - p1.y, p3.y - p2.y
  return x1 * y2 - y1 * x2
end

-- Checks if angle (p1-p2-p3) is flat
local function isFlatAngle(p1, p2, p3)
  return (crossProduct(p1, p2, p3) == 0)
end

-- ================
-- Module classes
-- ================

--- `Edge` class
-- @type Edge
local Edge = class()
Edge.__eq = function(a, b) return (a.p1 == b.p1 and a.p2 == b.p2) end
Edge.__tostring = function(e)
  return (('Edge :\n  %s\n  %s'):format(tostring(e.p1), tostring(e.p2)))
end

--- Creates a new `Edge`
-- @name Edge:new
-- @param p1 a `Point`
-- @param p2 a `Point`
-- @return a new `Edge`
-- @usage
-- local Delaunay = require 'Delaunay'
-- local Edge     = Delaunay.Edge
-- local Point    = Delaunay.Point
-- local e = Edge:new(Point(1,1), Point(2,5))
-- local e = Edge(Point(1,1), Point(2,5)) -- Alias to Edge.new
-- print(e) -- print the edge members p1 and p2
--
function Edge:__init(p1, p2)
  self.p1, self.p2 = p1, p2
end

--- Test if `otherEdge` is similar to self. It does not take into account the direction.
-- @param otherEdge an `Edge`
-- @return `true` or `false`
-- @usage
-- local e1 = Edge(Point(1,1), Point(2,5))
-- local e2 = Edge(Point(2,5), Point(1,1))
-- print(e1:same(e2)) --> true
-- print(e1 == e2)) --> false, == operator considers the direction
--
function Edge:same(otherEdge)
  return ((self.p1 == otherEdge.p1) and (self.p2 == otherEdge.p2))
      or ((self.p1 == otherEdge.p2) and (self.p2 == otherEdge.p1))
end

--- Returns the length.
-- @return the length of self
-- @usage
-- local e = Edge(Point(), Point(10,0))
-- print(e:length()) --> 10
--
function Edge:length()
  return self.p1:dist(self.p2)
end

--- Returns the midpoint coordinates.
-- @return the x-coordinate of self midpoint
-- @return the y-coordinate of self midpoint
-- @usage
-- local e = Edge(Point(), Point(10,0))
-- print(e:getMidPoint()) --> 5, 0
--
function Edge:getMidPoint()
  local x = self.p1.x + (self.p2.x - self.p1.x) / 2
  local y = self.p1.y + (self.p2.y - self.p1.y) / 2
  return x, y
end

--- Point class
-- @type Point
local Point = class()
Point.__eq = function(a,b)  return (a.x == b.x and a.y == b.y) end
Point.__tostring = function(p)
  return ('Point (%s) x: %.2f y: %.2f'):format(p.id, p.x, p.y)
end

--- Creates a new `Point`
-- @name Point:new
-- @param x the x-coordinate
-- @param y the y-coordinate
-- @return a new `Point`
-- @usage
-- local Delaunay = require 'Delaunay'
-- local Point    = Delaunay.Point
-- local p = Point:new(1,1)
-- local p = Point(1,1) -- Alias to Point.new
-- print(p) -- print the point members x and y
--
function Point:__init(x, y)
  self.x, self.y, self.id = x or 0, y or 0, '?'
end

--- Returns the square distance to another `Point`.
-- @param p a `Point`
-- @return the square distance from self to `p`.
-- @usage
-- local p1, p2 = Point(), Point(1,1)
-- print(p1:dist2(p2)) --> 2
--
function Point:dist2(p)
  local dx, dy = (self.x - p.x), (self.y - p.y)
  return dx * dx + dy * dy
end

--- Returns the distance to another `Point`.
-- @param p a `Point`
-- @return the distance from self to `p`.
-- @usage
-- local p1, p2 = Point(), Point(1,1)
-- print(p1:dist2(p2)) --> 1.4142135623731
--
function Point:dist(p)
  return sqrt(self:dist2(p))
end

--- Checks if self lies into the bounds of a circle
-- @param cx the x-coordinate of the circle center
-- @param cy the y-coordinate of the circle center
-- @param r the radius of the circle
-- @return `true` or `false`
-- @usage
-- local p = Point()
-- print(p:isInCircle(0,0,1)) --> true
--
function Point:isInCircle(cx, cy, r)
  local dx = (cx - self.x)
  local dy = (cy - self.y)
  return ((dx * dx + dy * dy) <= (r * r))
end

--- `Triangle` class
-- @type Triangle

local Triangle = class()
Triangle.__tostring = function(t)
  return (('Triangle: \n  %s\n  %s\n  %s')
    :format(tostring(t.p1), tostring(t.p2), tostring(t.p3)))
end

--- Creates a new `Triangle`
-- @name Triangle:new
-- @param p1 a `Point`
-- @param p2 a `Point`
-- @param p3 a `Point`
-- @return a new `Triangle`
-- @usage
-- local Delaunay = require 'Delaunay'
-- local Triangle = Delaunay.Triangle
-- local p1, p2, p3 = Point(), Point(2,0), Point(1,1)
-- local t = Triangle:new(p1, p2, p3)
-- local t = Triangle(p1, p2, p3) -- Alias to Triangle.new
-- print(t) -- print the triangle members p1, p2 and p3
--
function Triangle:__init(p1, p2, p3)
  assert(not isFlatAngle(p1, p2, p3), ("angle (p1, p2, p3) is flat:\n  %s\n  %s\n  %s")
    :format(tostring(p1), tostring(p2), tostring(p3)))
  self.p1, self.p2, self.p3 = p1, p2, p3
  self.e1, self.e2, self.e3 = Edge(p1, p2), Edge(p2, p3), Edge(p3, p1)
end

--- Checks if the triangle is defined clockwise (sequence p1-p2-p3)
-- @return `true` or `false`
-- @usage
-- local p1, p2, p3 = Point(), Point(1,1), Point(2,0)
-- local t = Triangle(p1, p2, p3)
-- print(t:isCW()) --> true
--
function Triangle:isCW()
  return (crossProduct(self.p1, self.p2, self.p3) < 0)
end

--- Checks if the triangle is defined counter-clockwise (sequence p1-p2-p3)
-- @return `true` or `false`
-- @usage
-- local p1, p2, p3 = Point(), Point(2,0), Point(1,1)
-- local t = Triangle(p1, p2, p3)
-- print(t:isCCW()) --> true
--
function Triangle:isCCW()
  return (crossProduct(self.p1, self.p2, self.p3) > 0)
end

--- Returns the length of the edges
-- @return the length of the edge p1-p2
-- @return the length of the edge p2-p3
-- @return the length of the edge p3-p1
-- @usage
-- local p1, p2, p3 = Point(), Point(2,0), Point(1,1)
-- local t = Triangle(p1, p2, p3)
-- print(t:getSidesLength()) --> 2  1.4142135623731  1.4142135623731
--
function Triangle:getSidesLength()
  return self.e1:length(), self.e2:length(), self.e3:length()
end

--- Returns the coordinates of the center
-- @return the x-coordinate of the center
-- @return the y-coordinate of the center
-- @usage
-- local p1, p2, p3 = Point(), Point(2,0), Point(1,1)
-- local t = Triangle(p1, p2, p3)
-- print(t:getCenter()) --> 1 0.33333333333333
--
function Triangle:getCenter()
  local x = (self.p1.x + self.p2.x + self.p3.x) / 3
  local y = (self.p1.y + self.p2.y + self.p3.y) / 3
  return x, y
end

--- Returns the coordinates of the circumcircle center and its radius
-- @return the x-coordinate of the circumcircle center
-- @return the y-coordinate of the circumcircle center
-- @return the radius of the circumcircle
-- @usage
-- local p1, p2, p3 = Point(), Point(2,0), Point(1,1)
-- local t = Triangle(p1, p2, p3)
-- print(t:getCircumCircle()) --> 1  0  1
--
function Triangle:getCircumCircle()
  local x, y = self:getCircumCenter()
  local r = self:getCircumRadius()
  return x, y, r
end

--- Returns the coordinates of the circumcircle center
-- @return the x-coordinate of the circumcircle center
-- @return the y-coordinate of the circumcircle center
-- @usage
-- local p1, p2, p3 = Point(), Point(2,0), Point(1,1)
-- local t = Triangle(p1, p2, p3)
-- print(t:getCircumCenter()) --> 1  0
--
function Triangle:getCircumCenter()
  local p1, p2, p3 = self.p1, self.p2, self.p3
  local D =  ( p1.x * (p2.y - p3.y) +
               p2.x * (p3.y - p1.y) +
               p3.x * (p1.y - p2.y)) * 2
  local x = (( p1.x * p1.x + p1.y * p1.y) * (p2.y - p3.y) +
             ( p2.x * p2.x + p2.y * p2.y) * (p3.y - p1.y) +
             ( p3.x * p3.x + p3.y * p3.y) * (p1.y - p2.y))
  local y = (( p1.x * p1.x + p1.y * p1.y) * (p3.x - p2.x) +
             ( p2.x * p2.x + p2.y * p2.y) * (p1.x - p3.x) +
             ( p3.x * p3.x + p3.y * p3.y) * (p2.x - p1.x))
  return (x / D), (y / D)
end

--- Returns the radius of the circumcircle
-- @return the radius of the circumcircle
-- @usage
-- local p1, p2, p3 = Point(), Point(2,0), Point(1,1)
-- local t = Triangle(p1, p2, p3)
-- print(t:getCircumRadius()) --> 1
--
function Triangle:getCircumRadius()
  local a, b, c = self:getSidesLength()
  return ((a * b * c) / quatCross(a, b, c))
end

--- Returns the area
-- @return the area
-- @usage
-- local p1, p2, p3 = Point(), Point(2,0), Point(1,1)
-- local t = Triangle(p1, p2, p3)
-- print(t:getArea()) --> 1
--
function Triangle:getArea()
  local a, b, c = self:getSidesLength()
  return (quatCross(a, b, c) / 4)
end

--- Checks if a given point lies into the triangle circumcircle
-- @param p a `Point`
-- @return `true` or `false`
-- @usage
-- local p1, p2, p3 = Point(), Point(2,0), Point(1,1)
-- local t = Triangle(p1, p2, p3)
-- print(t:inCircumCircle(Point(1,-1))) --> true
--
function Triangle:inCircumCircle(p)
  return p:isInCircle(self:getCircumCircle())
end

--- Delaunay module
-- @section public

--- Delaunay module
-- @table Delaunay
-- @field Point reference to the `Point` class
-- @field Edge reference to the `Edge` class
-- @field Triangle reference to the `Triangle` class
-- @field convexMultiplier multiplier heuristic for bounding triangle calculation. When small (~1) produces convex-hull, when large, produces concave hulls. Defaults to 1000.
-- @field _VERSION the version of the current module
local Delaunay = {
  Point            = Point,
  Edge             = Edge,
  Triangle         = Triangle,
	convexMultiplier = 1e3,
  _VERSION = "0.1"
}

--- Triangulates a set of given vertices
-- @param ... a `vargarg` list of objects of type `Point`
-- @return a set of objects of type `Triangle`
-- @usage
-- local Delaunay = require 'Delaunay'
-- local Point    = Delaunay.Point 
-- local p1, p2, p3, p4 = Point(), Point(2,0), Point(1,1), Point(1,-1)
-- local triangles = Delaunay.triangulate(p1, p2, p3, p4)
-- for i = 1, #triangles do
--   print(triangles[i])
-- end
--
function Delaunay.triangulate(...)
  local vertices = {...}
  local nvertices = #vertices
  assert(nvertices > 2, "Cannot triangulate, needs more than 3 vertices")
  if nvertices == 3 then
    return {Triangle(unpack(vertices))}
  end

  local trmax = nvertices * 4

  local minX, minY = vertices[1].x, vertices[1].y
  local maxX, maxY = minX, minY

  for i = 1, #vertices do
    local vertex = vertices[i]
    vertex.id = i
    if vertex.x < minX then minX = vertex.x end
    if vertex.y < minY then minY = vertex.y end
    if vertex.x > maxX then maxX = vertex.x end
    if vertex.y > maxY then maxY = vertex.y end
  end

	local convex_mult = Delaunay.convexMultiplier
  local dx, dy = (maxX - minX) * convex_mult, (maxY - minY) * convex_mult
  local deltaMax = max(dx, dy)
  local midx, midy = (minX + maxX) * 0.5, (minY + maxY) * 0.5

  local p1 = Point(midx - 2 * deltaMax, midy - deltaMax)
  local p2 = Point(midx, midy + 2 * deltaMax)
  local p3 = Point(midx + 2 * deltaMax, midy - deltaMax)
  p1.id, p2.id, p3.id = nvertices + 1, nvertices + 2, nvertices + 3
  vertices[p1.id] = p1
  vertices[p2.id] = p2
  vertices[p3.id] = p3

  local triangles = {}
  triangles[#triangles + 1] = Triangle(vertices[nvertices + 1],
                                       vertices[nvertices + 2],
                                       vertices[nvertices + 3]
                              )

  for i = 1, nvertices do
  
    local edges = {}
    local ntriangles = #triangles

    for j = #triangles, 1, -1 do
      local curTriangle = triangles[j]
      if curTriangle:inCircumCircle(vertices[i]) then
        edges[#edges + 1] = curTriangle.e1
        edges[#edges + 1] = curTriangle.e2
        edges[#edges + 1] = curTriangle.e3
        remove(triangles, j)
      end
    end

    for j = #edges - 1, 1, -1 do
      for k = #edges, j + 1, -1 do
        if edges[j] and edges[k] and edges[j]:same(edges[k]) then
          remove(edges, j)
          remove(edges, k-1)
        end
      end
    end

    for j = 1, #edges do
      local n = #triangles
      assert(n <= trmax, "Generated more than needed triangles")
      triangles[n + 1] = Triangle(edges[j].p1, edges[j].p2, vertices[i])
    end
   
  end

  for i = #triangles, 1, -1 do
    local triangle = triangles[i]
    if (triangle.p1.id > nvertices or 
        triangle.p2.id > nvertices or 
        triangle.p3.id > nvertices) then
      remove(triangles, i)
    end
  end

  for _ = 1,3 do remove(vertices) end

  return triangles

end

return Delaunay--
-- flux
--
-- Copyright (c) 2016 rxi
--
-- This library is free software; you can redistribute it and/or modify it
-- under the terms of the MIT license. See LICENSE for details.
--

local flux = { _version = "0.1.5" }
flux.__index = flux

flux.tweens = {}
flux.easing = { linear = function(p) return p end }

local easing = {
  quad    = "p * p",
  cubic   = "p * p * p",
  quart   = "p * p * p * p",
  quint   = "p * p * p * p * p",
  expo    = "2 ^ (10 * (p - 1))",
  sine    = "-math.cos(p * (math.pi * .5)) + 1",
  circ    = "-(math.sqrt(1 - (p * p)) - 1)",
  back    = "p * p * (2.7 * p - 1.7)",
  elastic = "-(2^(10 * (p - 1)) * math.sin((p - 1.075) * (math.pi * 2) / .3))"
}

local makefunc = function(str, expr)
  local load = loadstring or load
  return load("return function(p) " .. str:gsub("%$e", expr) .. " end")()
end

for k, v in pairs(easing) do
  flux.easing[k .. "in"] = makefunc("return $e", v)
  flux.easing[k .. "out"] = makefunc([[
    p = 1 - p
    return 1 - ($e)
  ]], v)
  flux.easing[k .. "inout"] = makefunc([[
    p = p * 2
    if p < 1 then
      return .5 * ($e)
    else
      p = 2 - p
      return .5 * (1 - ($e)) + .5
    end
  ]], v)
end



local tween = {}
tween.__index = tween

local function makefsetter(field)
  return function(self, x)
    local mt = getmetatable(x)
    if type(x) ~= "function" and not (mt and mt.__call) then
      error("expected function or callable", 2)
    end
    local old = self[field]
    self[field] = old and function() old() x() end or x
    return self
  end
end

local function makesetter(field, checkfn, errmsg)
  return function(self, x)
    if checkfn and not checkfn(x) then
      error(errmsg:gsub("%$x", tostring(x)), 2)
    end
    self[field] = x
    return self
  end
end

tween.ease  = makesetter("_ease",
                         function(x) return flux.easing[x] end,
                         "bad easing type '$x'")
tween.delay = makesetter("_delay",
                         function(x) return type(x) == "number" end,
                         "bad delay time; expected number")
tween.onstart     = makefsetter("_onstart")
tween.onupdate    = makefsetter("_onupdate")
tween.oncomplete  = makefsetter("_oncomplete")


function tween.new(obj, time, vars)
  local self = setmetatable({}, tween)
  self.obj = obj
  self.rate = time > 0 and 1 / time or 0
  self.progress = time > 0 and 0 or 1
  self._delay = 0
  self._ease = "quadout"
  self.vars = {}
  for k, v in pairs(vars) do
    if type(v) ~= "number" then
      error("bad value for key '" .. k .. "'; expected number")
    end
    self.vars[k] = v
  end
  return self
end


function tween:init()
  for k, v in pairs(self.vars) do
    local x = self.obj[k]
    if type(x) ~= "number" then
      error("bad value on object key '" .. k .. "'; expected number")
    end
    self.vars[k] = { start = x, diff = v - x }
  end
  self.inited = true
end


function tween:after(...)
  local t
  if select("#", ...) == 2 then
    t = tween.new(self.obj, ...)
  else
    t = tween.new(...)
  end
  t.parent = self.parent
  self:oncomplete(function() flux.add(self.parent, t) end)
  return t
end


function tween:stop()
  flux.remove(self.parent, self)
end



function flux.group()
  return setmetatable({}, flux)
end


function flux:to(obj, time, vars)
  return flux.add(self, tween.new(obj, time, vars))
end


function flux:update(deltatime)
  for i = #self, 1, -1 do
    local t = self[i]
    if t._delay > 0 then
      t._delay = t._delay - deltatime
    else
      if not t.inited then
        flux.clear(self, t.obj, t.vars)
        t:init()
      end
      if t._onstart then
        t._onstart()
        t._onstart = nil
      end
      t.progress = t.progress + t.rate * deltatime
      local p = t.progress
      local x = p >= 1 and 1 or flux.easing[t._ease](p)
      for k, v in pairs(t.vars) do
        t.obj[k] = v.start + x * v.diff
      end
      if t._onupdate then t._onupdate() end
      if p >= 1 then
        flux.remove(self, i)
        if t._oncomplete then t._oncomplete() end
      end
    end
  end
end


function flux:clear(obj, vars)
  for t in pairs(self[obj]) do
    if t.inited then
      for k in pairs(vars) do t.vars[k] = nil end
    end
  end
end


function flux:add(tween)
  -- Add to object table, create table if it does not exist
  local obj = tween.obj
  self[obj] = self[obj] or {}
  self[obj][tween] = true
  -- Add to array
  table.insert(self, tween)
  tween.parent = self
  return tween
end


function flux:remove(x)
  if type(x) == "number" then
    -- Remove from object table, destroy table if it is empty
    local obj = self[x].obj
    self[obj][self[x]] = nil
    if not next(self[obj]) then self[obj] = nil end
    -- Remove from array
    self[x] = self[#self]
    return table.remove(self)
  end
  for i, v in ipairs(self) do
    if v == x then
      return flux.remove(self, i)
    end
  end
end



local bound = {
  to      = function(...) return flux.to(flux.tweens, ...) end,
  update  = function(...) return flux.update(flux.tweens, ...) end,
  remove  = function(...) return flux.remove(flux.tweens, ...) end,
}
setmetatable(bound, flux)

return bound
# Windows - DINPUT
8f0e1200000000000000504944564944,Acme,platform:Windows,x:b2,a:b0,b:b1,y:b3,back:b8,start:b9,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b4,lefttrigger:b5,rightshoulder:b6,righttrigger:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a3,righty:a2,
341a3608000000000000504944564944,Afterglow PS3 Controller,a:b1,b:b2,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:b12,leftshoulder:b4,leftstick:b10,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:b7,rightx:a2,righty:a3,start:b9,x:b0,y:b3,platform:Windows,
ffff0000000000000000504944564944,GameStop Gamepad,a:b0,b:b1,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:,leftshoulder:b4,leftstick:b10,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:b7,rightx:a2,righty:a3,start:b9,x:b2,y:b3,platform:Windows,
6d0416c2000000000000504944564944,Generic DirectInput Controller,a:b1,b:b2,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,leftshoulder:b4,leftstick:b10,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:b7,rightx:a2,righty:a3,start:b9,x:b0,y:b3,platform:Windows,
0d0f6e00000000000000504944564944,HORIPAD 4,a:b1,b:b2,y:b3,x:b0,start:b9,guide:b12,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,platform:Windows,
6d0419c2000000000000504944564944,Logitech F710 Gamepad,a:b1,b:b2,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,leftshoulder:b4,leftstick:b10,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:b7,rightx:a2,righty:a3,start:b9,x:b0,y:b3,platform:Windows,
88880803000000000000504944564944,PS3 Controller,a:b2,b:b1,back:b8,dpdown:h0.8,dpleft:h0.4,dpright:h0.2,dpup:h0.1,guide:b12,leftshoulder:b4,leftstick:b9,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b10,righttrigger:b7,rightx:a3,righty:a4,start:b11,x:b0,y:b3,platform:Windows,
4c056802000000000000504944564944,PS3 Controller,a:b14,b:b13,back:b0,dpdown:b6,dpleft:b7,dpright:b5,dpup:b4,guide:b16,leftshoulder:b10,leftstick:b1,lefttrigger:b8,leftx:a0,lefty:a1,rightshoulder:b11,rightstick:b2,righttrigger:b9,rightx:a2,righty:a3,start:b3,x:b15,y:b12,platform:Windows,
25090500000000000000504944564944,PS3 DualShock,a:b2,b:b1,back:b9,dpdown:h0.8,dpleft:h0.4,dpright:h0.2,dpup:h0.1,guide:,leftshoulder:b6,leftstick:b10,lefttrigger:b4,leftx:a0,lefty:a1,rightshoulder:b7,rightstick:b11,righttrigger:b5,rightx:a2,righty:a3,start:b8,x:b0,y:b3,platform:Windows,
4c05c405000000000000504944564944,PS4 Controller,a:b1,b:b2,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:b12,leftshoulder:b4,leftstick:b10,lefttrigger:a3,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:a4,rightx:a2,righty:a5,start:b9,x:b0,y:b3,platform:Windows,
6d0418c2000000000000504944564944,Logitech RumblePad 2 USB,platform:Windows,x:b0,a:b1,b:b2,y:b3,back:b8,start:b9,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b4,lefttrigger:b6,rightshoulder:b5,righttrigger:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a2,righty:a3,
36280100000000000000504944564944,OUYA Controller,platform:Windows,a:b0,b:b3,y:b2,x:b1,start:b14,guide:b15,leftstick:b6,rightstick:b7,leftshoulder:b4,rightshoulder:b5,dpup:b8,dpleft:b10,dpdown:b9,dpright:b11,leftx:a0,lefty:a1,rightx:a3,righty:a4,lefttrigger:b12,righttrigger:b13,
4f0400b3000000000000504944564944,Thrustmaster Firestorm Dual Power,a:b0,b:b2,y:b3,x:b1,start:b10,guide:b8,back:b9,leftstick:b11,rightstick:b12,leftshoulder:b4,rightshoulder:b6,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b5,righttrigger:b7,platform:Windows,
00f00300000000000000504944564944,RetroUSB.com RetroPad,a:b1,b:b5,x:b0,y:b4,back:b2,start:b3,leftshoulder:b6,rightshoulder:b7,leftx:a0,lefty:a1,platform:Windows,
00f0f100000000000000504944564944,RetroUSB.com Super RetroPort,a:b1,b:b5,x:b0,y:b4,back:b2,start:b3,leftshoulder:b6,rightshoulder:b7,leftx:a0,lefty:a1,platform:Windows,
28040140000000000000504944564944,GamePad Pro USB,platform:Windows,a:b1,b:b2,x:b0,y:b3,back:b8,start:b9,leftshoulder:b4,rightshoulder:b5,leftx:a0,lefty:a1,lefttrigger:b6,righttrigger:b7,
ff113133000000000000504944564944,SVEN X-PAD,platform:Windows,a:b2,b:b3,y:b1,x:b0,start:b5,back:b4,leftshoulder:b6,rightshoulder:b7,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a4,lefttrigger:b8,righttrigger:b9,
8f0e0300000000000000504944564944,Piranha xtreme,platform:Windows,x:b3,a:b2,b:b1,y:b0,back:b8,start:b9,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b6,lefttrigger:b4,rightshoulder:b7,righttrigger:b5,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a3,righty:a2,
8f0e0d31000000000000504944564944,Multilaser JS071 USB,platform:Windows,a:b1,b:b2,y:b3,x:b0,start:b9,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,
10080300000000000000504944564944,PS2 USB,platform:Windows,a:b2,b:b1,y:b0,x:b3,start:b9,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b6,rightshoulder:b7,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a4,righty:a2,lefttrigger:b4,righttrigger:b5,
79000600000000000000504944564944,G-Shark GS-GP702,a:b2,b:b1,x:b3,y:b0,back:b8,start:b9,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a4,lefttrigger:b6,righttrigger:b7,platform:Windows,
4b12014d000000000000504944564944,NYKO AIRFLO,a:b0,b:b1,x:b2,y:b3,back:b8,guide:b10,start:b9,leftstick:a0,rightstick:a2,leftshoulder:a3,rightshoulder:b5,dpup:h0.1,dpdown:h0.0,dpleft:h0.8,dpright:h0.2,leftx:h0.6,lefty:h0.12,rightx:h0.9,righty:h0.4,lefttrigger:b6,righttrigger:b7,platform:Windows,
d6206dca000000000000504944564944,PowerA Pro Ex,a:b1,b:b2,x:b0,y:b3,back:b8,guide:b12,start:b9,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpdown:h0.0,dpleft:h0.8,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,platform:Windows,
a3060cff000000000000504944564944,Saitek P2500,a:b2,b:b3,y:b1,x:b0,start:b4,guide:b10,back:b5,leftstick:b8,rightstick:b9,leftshoulder:b6,rightshoulder:b7,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,platform:Windows,
4f0415b3000000000000504944564944,Thrustmaster Dual Analog 3.2,platform:Windows,x:b1,a:b0,b:b2,y:b3,back:b8,start:b9,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b4,lefttrigger:b5,rightshoulder:b6,righttrigger:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a2,righty:a3,
6f0e1e01000000000000504944564944,Rock Candy Gamepad for PS3,platform:Windows,a:b1,b:b2,x:b0,y:b3,back:b8,start:b9,guide:b12,leftshoulder:b4,rightshoulder:b5,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,
83056020000000000000504944564944,iBuffalo USB 2-axis 8-button Gamepad,a:b1,b:b0,y:b2,x:b3,start:b7,back:b6,leftshoulder:b4,rightshoulder:b5,leftx:a0,lefty:a1,platform:Windows,
10080100000000000000504944564944,PS1 USB,platform:Windows,a:b2,b:b1,x:b3,y:b0,back:b8,start:b9,leftshoulder:b6,rightshoulder:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a3,righty:a2,lefttrigger:b4,righttrigger:b5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,
49190204000000000000504944564944,Ipega PG-9023,a:b0,b:b1,x:b3,y:b4,back:b10,start:b11,leftstick:b13,rightstick:b14,leftshoulder:b6,rightshoulder:b7,dpup:h0.1,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,leftx:a0,lefty:a1,rightx:a3,righty:a4,lefttrigger:b8,righttrigger:b9,platform:Windows,
4f0423b3000000000000504944564944,Dual Trigger 3-in-1,a:b1,b:b2,x:b0,y:b3,back:b8,start:b9,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a5,lefttrigger:b6,righttrigger:b7,platform:Windows,
0d0f4900000000000000504944564944,Hatsune Miku Sho Controller,a:b1,b:b2,x:b0,y:b3,back:b8,guide:b12,start:b9,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,platform:Windows,
9000318000000000000504944564944,Mayflash Wiimote PC Adapter,platform:Windows,a:b2,b:h0.4,x:b0,y:b1,back:b4,start:b5,guide:b11,leftshoulder:b6,rightshoulder:b3,leftx:a0,lefty:a1,
79004318000000000000504944564944,Mayflash GameCube Controller Adapter,platform:Windows,a:b1,b:b2,x:b0,y:b3,back:b0,start:b9,guide:b0,leftshoulder:b4,rightshoulder:b7,leftstick:b0,rightstick:b0,leftx:a0,lefty:a1,rightx:a5,righty:a2,lefttrigger:a3,righttrigger:a4,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,
79000018000000000000504944564944,Mayflash WiiU Pro Game Controller Adapter (DInput),a:b1,b:b2,x:b0,y:b3,back:b8,start:b9,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,platform:Windows,
2509e803000000000000504944564944,Mayflash Wii Classic Controller,a:b1,b:b0,x:b3,y:b2,back:b8,guide:b10,start:b9,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:b11,dpdown:b13,dpleft:b12,dpright:b14,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,platform:Windows,
300f1001000000000000504944564944,Saitek P480 Rumble Pad,a:b2,b:b3,x:b0,y:b1,back:b8,start:b9,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b6,dpup:h0.1,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,leftx:a0,lefty:a1,rightx:a3,righty:a2,lefttrigger:b5,righttrigger:b7,platform:Windows,

# OS X
0500000047532047616d657061640000,GameStop Gamepad,a:b0,b:b1,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:,leftshoulder:b4,leftstick:b10,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:b7,rightx:a2,righty:a3,start:b9,x:b2,y:b3,platform:Mac OS X,
6d0400000000000016c2000000000000,Logitech F310 Gamepad (DInput),a:b1,b:b2,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,leftshoulder:b4,leftstick:b10,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:b7,rightx:a2,righty:a3,start:b9,x:b0,y:b3,platform:Mac OS X,
6d0400000000000018c2000000000000,Logitech F510 Gamepad (DInput),a:b1,b:b2,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,leftshoulder:b4,leftstick:b10,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:b7,rightx:a2,righty:a3,start:b9,x:b0,y:b3,platform:Mac OS X,
6d040000000000001fc2000000000000,Logitech F710 Gamepad (XInput),a:b0,b:b1,back:b9,dpdown:b12,dpleft:b13,dpright:b14,dpup:b11,guide:b10,leftshoulder:b4,leftstick:b6,lefttrigger:a2,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b7,righttrigger:a5,rightx:a3,righty:a4,start:b8,x:b2,y:b3,platform:Mac OS X,
6d0400000000000019c2000000000000,Logitech Wireless Gamepad (DInput),a:b1,b:b2,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,leftshoulder:b4,leftstick:b10,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:b7,rightx:a2,righty:a3,start:b9,x:b0,y:b3,platform:Mac OS X,
4c050000000000006802000000000000,PS3 Controller,a:b14,b:b13,back:b0,dpdown:b6,dpleft:b7,dpright:b5,dpup:b4,guide:b16,leftshoulder:b10,leftstick:b1,lefttrigger:b8,leftx:a0,lefty:a1,rightshoulder:b11,rightstick:b2,righttrigger:b9,rightx:a2,righty:a3,start:b3,x:b15,y:b12,platform:Mac OS X,
4c05000000000000c405000000000000,PS4 Controller,a:b1,b:b2,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:b12,leftshoulder:b4,leftstick:b10,lefttrigger:a3,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:a4,rightx:a2,righty:a5,start:b9,x:b0,y:b3,Platform:Mac OS X,
5e040000000000008e02000000000000,X360 Controller,a:b0,b:b1,back:b9,dpdown:b12,dpleft:b13,dpright:b14,dpup:b11,guide:b10,leftshoulder:b4,leftstick:b6,lefttrigger:a2,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b7,righttrigger:a5,rightx:a3,righty:a4,start:b8,x:b2,y:b3,platform:Mac OS X,
891600000000000000fd000000000000,Razer Onza Tournament,a:b0,b:b1,y:b3,x:b2,start:b8,guide:b10,back:b9,leftstick:b6,rightstick:b7,leftshoulder:b4,rightshoulder:b5,dpup:b11,dpleft:b13,dpdown:b12,dpright:b14,leftx:a0,lefty:a1,rightx:a3,righty:a4,lefttrigger:a2,righttrigger:a5,platform:Mac OS X,
4f0400000000000000b3000000000000,Thrustmaster Firestorm Dual Power,a:b0,b:b2,y:b3,x:b1,start:b10,guide:b8,back:b9,leftstick:b11,rightstick:,leftshoulder:b4,rightshoulder:b6,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b5,righttrigger:b7,platform:Mac OS X,
8f0e0000000000000300000000000000,Piranha xtreme,platform:Mac OS X,x:b3,a:b2,b:b1,y:b0,back:b8,start:b9,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b6,lefttrigger:b4,rightshoulder:b7,righttrigger:b5,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a3,righty:a2,
0d0f0000000000004d00000000000000,HORI Gem Pad 3,platform:Mac OS X,a:b1,b:b2,y:b3,x:b0,start:b9,guide:b12,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,
79000000000000000600000000000000,G-Shark GP-702,a:b2,b:b1,x:b3,y:b0,back:b8,start:b9,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,leftx:a0,lefty:a1,rightx:a3,righty:a4,lefttrigger:b6,righttrigger:b7,platform:Mac OS X,
4f0400000000000015b3000000000000,Thrustmaster Dual Analog 3.2,platform:Mac OS X,x:b1,a:b0,b:b2,y:b3,back:b8,start:b9,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b4,lefttrigger:b5,rightshoulder:b6,righttrigger:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a2,righty:a3,
AD1B00000000000001F9000000000000,Gamestop BB-070 X360 Controller,a:b0,b:b1,back:b9,dpdown:b12,dpleft:b13,dpright:b14,dpup:b11,guide:b10,leftshoulder:b4,leftstick:b6,lefttrigger:a2,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b7,righttrigger:a5,rightx:a3,righty:a4,start:b8,x:b2,y:b3,platform:Mac OS X,
050000005769696d6f74652028303000,Wii Remote,a:b4,b:b5,y:b9,x:b10,start:b6,guide:b8,back:b7,dpup:b2,dpleft:b0,dpdown:b3,dpright:b1,leftx:a0,lefty:a1,lefttrigger:b12,righttrigger:,leftshoulder:b11,platform:Mac OS X,
83050000000000006020000000000000,iBuffalo USB 2-axis 8-button Gamepad,a:b1,b:b0,x:b3,y:b2,back:b6,start:b7,leftshoulder:b4,rightshoulder:b5,leftx:a0,lefty:a1,platform:Mac OS X,
5e04000000000000dd02000000000000,Xbox One Wired Controller,platform:Mac OS X,x:b2,a:b0,b:b1,y:b3,back:b9,guide:b10,start:b8,dpleft:b13,dpdown:b12,dpright:b14,dpup:b11,leftshoulder:b4,lefttrigger:a2,rightshoulder:b5,righttrigger:a5,leftstick:b6,rightstick:b7,leftx:a0,lefty:a1,rightx:a3,righty:a4,
050000005769696d6f74652028313800,Wii U Pro Controller,a:b16,b:b15,x:b18,y:b17,back:b7,guide:b8,start:b6,leftstick:b23,rightstick:b24,leftshoulder:b19,rightshoulder:b20,dpup:b11,dpdown:b12,dpleft:b13,dpright:b14,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b21,righttrigger:b22,platform:Mac OS X,
79000000000000000018000000000000,Mayflash WiiU Pro Game Controller Adapter (DInput),a:b4,b:b8,x:b0,y:b12,back:b32,start:b36,leftstick:b40,rightstick:b44,leftshoulder:b16,rightshoulder:b20,dpup:h0.1,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,leftx:a0,lefty:a4,rightx:a8,righty:a12,lefttrigger:b24,righttrigger:b28,platform:Mac OS X,
2509000000000000e803000000000000,Mayflash Wii Classic Controller,a:b1,b:b0,x:b3,y:b2,back:b8,guide:b10,start:b9,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:b11,dpdown:b13,dpleft:b12,dpright:b14,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,platform:Mac OS X,
351200000000000021ab000000000000,SFC30 Joystick,a:b1,b:b0,x:b4,y:b3,back:b10,start:b11,leftshoulder:b6,rightshoulder:b7,leftx:a0,lefty:a1,platform:Mac OS X,

# Linux
0500000047532047616d657061640000,GameStop Gamepad,a:b0,b:b1,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:,leftshoulder:b4,leftstick:b10,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:b7,rightx:a2,righty:a3,start:b9,x:b2,y:b3,platform:Linux,
03000000ba2200002010000001010000,Jess Technology USB Game Controller,a:b2,b:b1,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:,leftshoulder:b4,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,righttrigger:b7,rightx:a3,righty:a2,start:b9,x:b3,y:b0,platform:Linux,
030000006d04000019c2000010010000,Logitech Cordless RumblePad 2,a:b1,b:b2,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:,leftshoulder:b4,leftstick:b10,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:b7,rightx:a2,righty:a3,start:b9,x:b0,y:b3,platform:Linux,
030000006d0400001dc2000014400000,Logitech F310 Gamepad (XInput),a:b0,b:b1,back:b6,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:b8,leftshoulder:b4,leftstick:b9,lefttrigger:a2,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b10,righttrigger:a5,rightx:a3,righty:a4,start:b7,x:b2,y:b3,platform:Linux,
030000006d0400001ec2000020200000,Logitech F510 Gamepad (XInput),a:b0,b:b1,back:b6,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:b8,leftshoulder:b4,leftstick:b9,lefttrigger:a2,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b10,righttrigger:a5,rightx:a3,righty:a4,start:b7,x:b2,y:b3,platform:Linux,
030000006d04000019c2000011010000,Logitech F710 Gamepad (DInput),a:b1,b:b2,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,leftshoulder:b4,leftstick:b10,lefttrigger:b6,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:b7,rightx:a2,righty:a3,start:b9,x:b0,y:b3,platform:Linux,
030000006d0400001fc2000005030000,Logitech F710 Gamepad (XInput),a:b0,b:b1,back:b6,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:b8,leftshoulder:b4,leftstick:b9,lefttrigger:a2,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b10,righttrigger:a5,rightx:a3,righty:a4,start:b7,x:b2,y:b3,platform:Linux,
030000004c0500006802000011010000,PS3 Controller,a:b14,b:b13,back:b0,dpdown:b6,dpleft:b7,dpright:b5,dpup:b4,guide:b16,leftshoulder:b10,leftstick:b1,lefttrigger:b8,leftx:a0,lefty:a1,rightshoulder:b11,rightstick:b2,righttrigger:b9,rightx:a2,righty:a3,start:b3,x:b15,y:b12,platform:Linux,
030000004c050000c405000011010000,Sony DualShock 4,a:b1,b:b2,y:b3,x:b0,start:b9,guide:b12,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a5,lefttrigger:b6,righttrigger:b7,platform:Linux,
030000006f0e00003001000001010000,EA Sports PS3 Controller,platform:Linux,a:b1,b:b2,y:b3,x:b0,start:b9,guide:b12,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,
03000000de280000ff11000001000000,Valve Streaming Gamepad,a:b0,b:b1,back:b6,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:b8,leftshoulder:b4,leftstick:b9,lefttrigger:a2,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b10,righttrigger:a5,rightx:a3,righty:a4,start:b7,x:b2,y:b3,platform:Linux,
030000005e0400008e02000014010000,X360 Controller,a:b0,b:b1,back:b6,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:b8,leftshoulder:b4,leftstick:b9,lefttrigger:a2,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b10,righttrigger:a5,rightx:a3,righty:a4,start:b7,x:b2,y:b3,platform:Linux,
030000005e0400008e02000010010000,X360 Controller,a:b0,b:b1,back:b6,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:b8,leftshoulder:b4,leftstick:b9,lefttrigger:a2,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b10,righttrigger:a5,rightx:a3,righty:a4,start:b7,x:b2,y:b3,platform:Linux,
030000005e0400001907000000010000,X360 Wireless Controller,a:b0,b:b1,back:b6,dpdown:b14,dpleft:b11,dpright:b12,dpup:b13,guide:b8,leftshoulder:b4,leftstick:b9,lefttrigger:a2,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b10,righttrigger:a5,rightx:a3,righty:a4,start:b7,x:b2,y:b3,platform:Linux,
03000000100800000100000010010000,Twin USB PS2 Adapter,a:b2,b:b1,y:b0,x:b3,start:b9,guide:,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b6,rightshoulder:b7,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a3,righty:a2,lefttrigger:b4,righttrigger:b5,platform:Linux,
03000000a306000023f6000011010000,Saitek Cyborg V.1 Game Pad,a:b1,b:b2,y:b3,x:b0,start:b9,guide:b12,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a4,lefttrigger:b6,righttrigger:b7,platform:Linux,
030000004f04000020b3000010010000,Thrustmaster 2 in 1 DT,a:b0,b:b2,y:b3,x:b1,start:b9,guide:,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b6,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b5,righttrigger:b7,platform:Linux,
030000004f04000023b3000000010000,Thrustmaster Dual Trigger 3-in-1,platform:Linux,x:b0,a:b1,b:b2,y:b3,back:b8,start:b9,dpleft:h0.8,dpdown:h0.0,dpdown:h0.4,dpright:h0.0,dpright:h0.2,dpup:h0.0,dpup:h0.1,leftshoulder:h0.0,leftshoulder:b4,lefttrigger:b6,rightshoulder:b5,righttrigger:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a2,righty:a5,
030000008f0e00000300000010010000,GreenAsia Inc.    USB Joystick     ,platform:Linux,x:b3,a:b2,b:b1,y:b0,back:b8,start:b9,dpleft:h0.8,dpdown:h0.0,dpdown:h0.4,dpright:h0.0,dpright:h0.2,dpup:h0.0,dpup:h0.1,leftshoulder:h0.0,leftshoulder:b6,lefttrigger:b4,rightshoulder:b7,righttrigger:b5,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a3,righty:a2,
030000008f0e00001200000010010000,GreenAsia Inc.      USB  Joystick  ,platform:Linux,x:b2,a:b0,b:b1,y:b3,back:b8,start:b9,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b4,lefttrigger:b5,rightshoulder:b6,righttrigger:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a3,righty:a2,
030000005e0400009102000007010000,X360 Wireless Controller,a:b0,b:b1,y:b3,x:b2,start:b7,guide:b8,back:b6,leftstick:b9,rightstick:b10,leftshoulder:b4,rightshoulder:b5,dpup:b13,dpleft:b11,dpdown:b14,dpright:b12,leftx:a0,lefty:a1,rightx:a3,righty:a4,lefttrigger:a2,righttrigger:a5,platform:Linux,
030000006d04000016c2000010010000,Logitech Logitech Dual Action,platform:Linux,x:b0,a:b1,b:b2,y:b3,back:b8,start:b9,dpleft:h0.8,dpdown:h0.0,dpdown:h0.4,dpright:h0.0,dpright:h0.2,dpup:h0.0,dpup:h0.1,leftshoulder:h0.0,dpup:h0.1,leftshoulder:h0.0,leftshoulder:b4,lefttrigger:b6,rightshoulder:b5,righttrigger:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a2,righty:a3,
03000000260900008888000000010000,GameCube {WiseGroup USB box},a:b0,b:b2,y:b3,x:b1,start:b7,leftshoulder:,rightshoulder:b6,dpup:h0.1,dpleft:h0.8,rightstick:,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:a4,righttrigger:a5,platform:Linux,
030000006d04000011c2000010010000,Logitech WingMan Cordless RumblePad,a:b0,b:b1,y:b4,x:b3,start:b8,guide:b5,back:b2,leftshoulder:b6,rightshoulder:b7,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a3,righty:a4,lefttrigger:b9,righttrigger:b10,platform:Linux,
030000006d04000018c2000010010000,Logitech Logitech RumblePad 2 USB,platform:Linux,x:b0,a:b1,b:b2,y:b3,back:b8,start:b9,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b4,lefttrigger:b6,rightshoulder:b5,righttrigger:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a2,righty:a3,
05000000d6200000ad0d000001000000,Moga Pro,platform:Linux,a:b0,b:b1,y:b3,x:b2,start:b6,leftstick:b7,rightstick:b8,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:a5,righttrigger:a4,
030000004f04000009d0000000010000,Thrustmaster Run N Drive Wireless PS3,platform:Linux,a:b1,b:b2,x:b0,y:b3,start:b9,guide:b12,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,
030000004f04000008d0000000010000,Thrustmaster Run N Drive  Wireless,platform:Linux,a:b1,b:b2,x:b0,y:b3,start:b9,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a5,lefttrigger:b6,righttrigger:b7,
0300000000f000000300000000010000,RetroUSB.com RetroPad,a:b1,b:b5,x:b0,y:b4,back:b2,start:b3,leftshoulder:b6,rightshoulder:b7,leftx:a0,lefty:a1,platform:Linux,
0300000000f00000f100000000010000,RetroUSB.com Super RetroPort,a:b1,b:b5,x:b0,y:b4,back:b2,start:b3,leftshoulder:b6,rightshoulder:b7,leftx:a0,lefty:a1,platform:Linux,
030000006f0e00001f01000000010000,Generic X-Box pad,platform:Linux,x:b2,a:b0,b:b1,y:b3,back:b6,guide:b8,start:b7,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b4,lefttrigger:a2,rightshoulder:b5,righttrigger:a5,leftstick:b9,rightstick:b10,leftx:a0,lefty:a1,rightx:a3,righty:a4,
03000000280400000140000000010000,Gravis GamePad Pro USB ,platform:Linux,x:b0,a:b1,b:b2,y:b3,back:b8,start:b9,leftshoulder:b4,lefttrigger:b6,rightshoulder:b5,righttrigger:b7,leftx:a0,lefty:a1,
030000005e0400008902000021010000,Microsoft X-Box pad v2 (US),platform:Linux,x:b3,a:b0,b:b1,y:b4,back:b6,start:b7,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b5,lefttrigger:a2,rightshoulder:b2,righttrigger:a5,leftstick:b8,rightstick:b9,leftx:a0,lefty:a1,rightx:a3,righty:a4,
030000006f0e00001e01000011010000,Rock Candy Gamepad for PS3,platform:Linux,a:b1,b:b2,x:b0,y:b3,back:b8,start:b9,guide:b12,leftshoulder:b4,rightshoulder:b5,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,
03000000250900000500000000010000,Sony PS2 pad with SmartJoy adapter,platform:Linux,a:b2,b:b1,y:b0,x:b3,start:b8,back:b9,leftstick:b10,rightstick:b11,leftshoulder:b6,rightshoulder:b7,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b4,righttrigger:b5,
030000008916000000fd000024010000,Razer Onza Tournament,a:b0,b:b1,y:b3,x:b2,start:b7,guide:b8,back:b6,leftstick:b9,rightstick:b10,leftshoulder:b4,rightshoulder:b5,dpup:b13,dpleft:b11,dpdown:b14,dpright:b12,leftx:a0,lefty:a1,rightx:a3,righty:a4,lefttrigger:a2,righttrigger:a5,platform:Linux,
030000004f04000000b3000010010000,Thrustmaster Firestorm Dual Power,a:b0,b:b2,y:b3,x:b1,start:b10,guide:b8,back:b9,leftstick:b11,rightstick:b12,leftshoulder:b4,rightshoulder:b6,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b5,righttrigger:b7,platform:Linux,
03000000ad1b000001f5000033050000,Hori Pad EX Turbo 2,a:b0,b:b1,y:b3,x:b2,start:b7,guide:b8,back:b6,leftstick:b9,rightstick:b10,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a3,righty:a4,lefttrigger:a2,righttrigger:a5,platform:Linux,
050000004c050000c405000000010000,PS4 Controller (Bluetooth),a:b1,b:b2,back:b8,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,dpup:h0.1,guide:b12,leftshoulder:b4,leftstick:b10,lefttrigger:a3,leftx:a0,lefty:a1,rightshoulder:b5,rightstick:b11,righttrigger:a4,rightx:a2,righty:a5,start:b9,x:b0,y:b3,platform:Linux,
060000004c0500006802000000010000,PS3 Controller (Bluetooth),a:b14,b:b13,y:b12,x:b15,start:b3,guide:b16,back:b0,leftstick:b1,rightstick:b2,leftshoulder:b10,rightshoulder:b11,dpup:b4,dpleft:b7,dpdown:b6,dpright:b5,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b8,righttrigger:b9,platform:Linux,
050000004c0500006802000000010000,PS3 Controller (Bluetooth),a:b14,b:b13,y:b12,x:b15,start:b3,guide:b16,back:b0,leftstick:b1,rightstick:b2,leftshoulder:b10,rightshoulder:b11,dpup:b4,dpleft:b7,dpdown:b6,dpright:b5,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b8,righttrigger:b9,platform:Linux,
03000000790000000600000010010000,DragonRise Inc.   Generic   USB  Joystick  ,platform:Linux,x:b3,a:b2,b:b1,y:b0,back:b8,start:b9,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b4,lefttrigger:b6,rightshoulder:b5,righttrigger:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a3,righty:a4,
03000000666600000488000000010000,Super Joy Box 5 Pro,platform:Linux,a:b2,b:b1,x:b3,y:b0,back:b9,start:b8,leftshoulder:b6,rightshoulder:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b4,righttrigger:b5,dpup:b12,dpleft:b15,dpdown:b14,dpright:b13,
05000000362800000100000002010000,OUYA Game Controller,a:b0,b:b3,dpdown:b9,dpleft:b10,dpright:b11,dpup:b8,guide:b14,leftshoulder:b4,leftstick:b6,lefttrigger:a2,leftx:a0,lefty:a1,platform:Linux,rightshoulder:b5,rightstick:b7,righttrigger:a5,rightx:a3,righty:a4,x:b1,y:b2,
05000000362800000100000003010000,OUYA Game Controller,a:b0,b:b3,dpdown:b9,dpleft:b10,dpright:b11,dpup:b8,guide:b14,leftshoulder:b4,leftstick:b6,lefttrigger:a2,leftx:a0,lefty:a1,platform:Linux,rightshoulder:b5,rightstick:b7,righttrigger:a5,rightx:a3,righty:a4,x:b1,y:b2,
030000008916000001fd000024010000,Razer Onza Classic Edition,platform:Linux,x:b2,a:b0,b:b1,y:b3,back:b6,guide:b8,start:b7,dpleft:b11,dpdown:b14,dpright:b12,dpup:b13,leftshoulder:b4,lefttrigger:a2,rightshoulder:b5,righttrigger:a5,leftstick:b9,rightstick:b10,leftx:a0,lefty:a1,rightx:a3,righty:a4,
030000005e040000d102000001010000,Microsoft X-Box One pad,platform:Linux,x:b2,a:b0,b:b1,y:b3,back:b6,guide:b8,start:b7,dpleft:h0.8,dpdown:h0.0,dpdown:h0.4,dpright:h0.0,dpright:h0.2,dpup:h0.0,dpup:h0.1,leftshoulder:h0.0,leftshoulder:b4,lefttrigger:a2,rightshoulder:b5,righttrigger:a5,leftstick:b9,rightstick:b10,leftx:a0,lefty:a1,rightx:a3,righty:a4,
030000005e040000dd02000003020000,Microsoft X-Box One pad v2,x:b2,a:b0,b:b1,y:b3,back:b6,guide:b8,start:b7,dpleft:h0.8,dpdown:h0.0,dpdown:h0.4,dpright:h0.0,dpright:h0.2,dpup:h0.0,dpup:h0.1,leftshoulder:h0.0,leftshoulder:b4,lefttrigger:a2,rightshoulder:b5,righttrigger:a5,leftstick:b9,rightstick:b10,leftx:a0,lefty:a1,rightx:a3,righty:a4,platform:Linux,
03000000790000001100000010010000,RetroLink Saturn Classic Controller,platform:Linux,x:b3,a:b0,b:b1,y:b4,back:b5,guide:b2,start:b8,leftshoulder:b6,rightshoulder:b7,leftx:a0,lefty:a1,
050000007e0500003003000001000000,Nintendo Wii U Pro Controller,platform:Linux,a:b0,b:b1,x:b3,y:b2,back:b8,start:b9,guide:b10,leftshoulder:b4,rightshoulder:b5,leftstick:b11,rightstick:b12,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,dpup:b13,dpleft:b15,dpdown:b14,dpright:b16,
030000005e0400008e02000004010000,Microsoft X-Box 360 pad,platform:Linux,a:b0,b:b1,x:b2,y:b3,back:b6,start:b7,guide:b8,leftshoulder:b4,rightshoulder:b5,leftstick:b9,rightstick:b10,leftx:a0,lefty:a1,rightx:a3,righty:a4,lefttrigger:a2,righttrigger:a5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,
030000000d0f00002200000011010000,HORI CO.,LTD. REAL ARCADE Pro.V3,platform:Linux,x:b0,a:b1,b:b2,y:b3,back:b8,guide:b12,start:b9,leftshoulder:b4,lefttrigger:b6,rightshoulder:b5,righttrigger:b7,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,
030000000d0f00001000000011010000,HORI CO.,LTD. FIGHTING STICK 3,platform:Linux,x:b0,a:b1,b:b2,y:b3,back:b8,guide:b12,start:b9,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b4,lefttrigger:b6,rightshoulder:b5,righttrigger:b7
03000000f0250000c183000010010000,Goodbetterbest Ltd USB Controller,platform:Linux,x:b0,a:b1,b:b2,y:b3,back:b8,guide:b12,start:b9,dpleft:h0.8,dpdown:h0.0,dpdown:h0.4,dpright:h0.0,dpright:h0.2,dpup:h0.0,dpup:h0.1,leftshoulder:h0.0,leftshoulder:b4,lefttrigger:b6,rightshoulder:b5,righttrigger:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a2,righty:a3,
0000000058626f782047616d65706100,Xbox Gamepad (userspace driver),platform:Linux,a:b0,b:b1,x:b2,y:b3,start:b7,back:b6,guide:b8,dpup:h0.1,dpdown:h0.4,dpleft:h0.8,dpright:h0.2,leftshoulder:b4,rightshoulder:b5,lefttrigger:a5,righttrigger:a4,leftstick:b9,rightstick:b10,leftx:a0,lefty:a1,rightx:a2,righty:a3,
03000000ff1100003133000010010000,PC Game Controller,a:b2,b:b1,y:b0,x:b3,start:b9,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b5,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b6,righttrigger:b7,platform:Linux,
030000005e0400008e02000020200000,SpeedLink XEOX Pro Analog Gamepad pad,platform:Linux,x:b2,a:b0,b:b1,y:b3,back:b6,guide:b8,start:b7,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b4,lefttrigger:a2,rightshoulder:b5,righttrigger:a5,leftstick:b9,rightstick:b10,leftx:a0,lefty:a1,rightx:a3,righty:a4,
030000006f0e00001304000000010000,Generic X-Box pad,platform:Linux,x:b2,a:b0,b:b1,y:b3,back:b6,guide:b8,start:b7,dpleft:h0.8,dpdown:h0.0,dpdown:h0.4,dpright:h0.0,dpright:h0.2,dpup:h0.0,dpup:h0.1,leftshoulder:h0.0,leftshoulder:b4,lefttrigger:a2,rightshoulder:b5,righttrigger:a5,leftstick:a0,rightstick:a3,leftstick:b9,rightstick:b10,leftx:a0,lefty:a1,rightx:a3,righty:a4,
03000000a306000018f5000010010000,Saitek PLC Saitek P3200 Rumble Pad,platform:Linux,x:b0,a:b1,b:b2,y:b3,back:b8,start:b9,dpleft:h0.8,dpdown:h0.0,dpdown:h0.4,dpright:h0.0,dpright:h0.2,dpup:h0.0,dpup:h0.1,leftshoulder:h0.0,leftshoulder:b4,lefttrigger:a2,rightshoulder:b6,rightshoulder:b5,righttrigger:b7,leftstick:b10,rightstick:b11,leftx:a0,lefty:a1,rightx:a3,righty:a4,
03000000830500006020000010010000,iBuffalo USB 2-axis 8-button Gamepad,a:b1,b:b0,x:b3,y:b2,back:b6,start:b7,leftshoulder:b4,rightshoulder:b5,leftx:a0,lefty:a1,platform:Linux,
03000000c9110000f055000011010000,HJC Game GAMEPAD,leftx:a0,lefty:a1,dpdown:h0.4,rightstick:b11,rightshoulder:b5,rightx:a2,start:b9,righty:a3,dpleft:h0.8,lefttrigger:b6,x:b2,dpup:h0.1,back:b8,leftstick:b10,leftshoulder:b4,y:b3,a:b0,dpright:h0.2,righttrigger:b7,b:b1,platform:Linux,
03000000a30600000c04000011010000,Saitek P2900 Wireless Pad,a:b1,b:b2,y:b3,x:b0,start:b12,guide:b9,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b6,rightshoulder:b7,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a3,righty:a2,lefttrigger:b4,righttrigger:b5,platform:Linux,
03000000341a000005f7000010010000,GameCube {HuiJia USB box},a:b1,b:b2,y:b3,x:b0,start:b9,guide:,back:,leftstick:,rightstick:,leftshoulder:,dpleft:b15,dpdown:b14,dpright:b13,leftx:a0,lefty:a1,rightx:a5,righty:a2,lefttrigger:a3,righttrigger:a4,rightshoulder:b7,dpup:b12,platform:Linux,
030000006e0500000320000010010000,JC-U3613M - DirectInput Mode,platform:Linux,x:b0,a:b2,b:b3,y:b1,back:b10,guide:b12,start:b11,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b4,lefttrigger:b6,rightshoulder:b5,righttrigger:b7,leftstick:b8,rightstick:b9,leftx:a0,lefty:a1,rightx:a2,righty:a3,
030000006f0e00004601000001010000,Rock Candy Wired Controller for Xbox One,platform:Linux,a:b0,b:b1,x:b2,y:b3,leftshoulder:b4,rightshoulder:b5,back:b6,start:b7,guide:b8,leftstick:b9,rightstick:b10,lefttrigger:a2,righttrigger:a5,leftx:a0,lefty:a1,rightx:a3,righty:a4,
03000000380700001647000010040000,Mad Catz Wired Xbox 360 Controller,platform:Linux,x:b2,a:b0,b:b1,y:b3,back:b6,guide:b8,start:b7,dpleft:h0.8,dpdown:h0.0,dpdown:h0.4,dpright:h0.0,dpright:h0.2,dpup:h0.0,dpup:h0.1,leftshoulder:h0.0,leftshoulder:b4,lefttrigger:a2,rightshoulder:b5,righttrigger:a5,leftstick:b9,rightstick:b10,leftx:a0,lefty:a1,rightx:a3,righty:a4,
030000006f0e00003901000020060000,Afterglow Wired Controller for Xbox One,x:b2,a:b0,b:b1,y:b3,back:b6,guide:b8,start:b7,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,dpup:h0.1,leftshoulder:b4,lefttrigger:a2,rightshoulder:b5,righttrigger:a5,leftstick:b9,rightstick:b10,leftx:a0,lefty:a1,rightx:a3,righty:a4,platform:Linux,
030000004f04000015b3000010010000,Thrustmaster Dual Analog 4,platform:Linux,a:b0,b:b2,x:b1,y:b3,start:b9,back:b8,leftstick:b10,rightstick:b11,leftshoulder:b4,rightshoulder:b6,dpup:h0.1,dpleft:h0.8,dpdown:h0.4,dpright:h0.2,leftx:a0,lefty:a1,rightx:a2,righty:a3,lefttrigger:b5,righttrigger:b7,
-- gamera.lua v1.0.1

-- Copyright (c) 2012 Enrique Garca Cota
-- Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
-- The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
-- Based on YaciCode, from Julien Patte and LuaObject, from Sebastien Rocca-Serra

local gamera = {}

-- Private attributes and methods

local gameraMt = {__index = gamera}
local abs, min, max = math.abs, math.min, math.max

local function clamp(x, minX, maxX)
  return x < minX and minX or (x>maxX and maxX or x)
end

local function checkNumber(value, name)
  if type(value) ~= 'number' then
    error(name .. " must be a number (was: " .. tostring(value) .. ")")
  end
end

local function checkPositiveNumber(value, name)
  if type(value) ~= 'number' or value <=0 then
    error(name .. " must be a positive number (was: " .. tostring(value) ..")")
  end
end

local function checkAABB(l,t,w,h)
  checkNumber(l, "l")
  checkNumber(t, "t")
  checkPositiveNumber(w, "w")
  checkPositiveNumber(h, "h")
end

local function getVisibleArea(self, scale)
  scale = scale or self.scale
  local sin, cos = abs(self.sin), abs(self.cos)
  local w,h = self.w / scale, self.h / scale
  w,h = cos*w + sin*h, sin*w + cos*h
  return min(w,self.ww), min(h, self.wh)
end

local function cornerTransform(self, x,y)
  local scale, sin, cos = self.scale, self.sin, self.cos
  x,y = x - self.x, y - self.y
  x,y = -cos*x + sin*y, -sin*x - cos*y
  return self.x - (x/scale + self.l), self.y - (y/scale + self.t)
end

local function adjustPosition(self)
  local wl,wt,ww,wh = self.wl, self.wt, self.ww, self.wh
  local w,h = getVisibleArea(self)
  local w2,h2 = w*0.5, h*0.5

  local left, right  = wl + w2, wl + ww - w2
  local top,  bottom = wt + h2, wt + wh - h2

  self.x, self.y = clamp(self.x, left, right), clamp(self.y, top, bottom)
end

local function adjustScale(self)
  local w,h,ww,wh = self.w, self.h, self.ww, self.wh
  local rw,rh     = getVisibleArea(self, 1)      -- rotated frame: area around the window, rotated without scaling
  local sx,sy     = rw/ww, rh/wh                 -- vert/horiz scale: minimun scales that the window needs to occupy the world
  local rscale    = max(sx,sy)

  self.scale = max(self.scale, rscale)
end

-- Public interface

function gamera.new(l,t,w,h)

  local sw,sh = love.graphics.getWidth(), love.graphics.getHeight()

  local cam = setmetatable({
    x=0, y=0,
    scale=1,
    angle=0, sin=math.sin(0), cos=math.cos(0),
    l=0, t=0, w=sw, h=sh, w2=sw*0.5, h2=sh*0.5
  }, gameraMt)

  cam:setWorld(l,t,w,h)

  return cam
end

function gamera:setWorld(l,t,w,h)
  checkAABB(l,t,w,h)

  self.wl, self.wt, self.ww, self.wh = l,t,w,h

  adjustPosition(self)
end

function gamera:setWindow(l,t,w,h)
  checkAABB(l,t,w,h)

  self.l, self.t, self.w, self.h, self.w2, self.h2 = l,t,w,h, w*0.5, h*0.5

  adjustPosition(self)
end

function gamera:setPosition(x,y)
  checkNumber(x, "x")
  checkNumber(y, "y")

  self.x, self.y = x,y

  adjustPosition(self)
end

function gamera:setScale(scale)
  checkNumber(scale, "scale")

  self.scale = scale

  adjustScale(self)
  adjustPosition(self)
end

function gamera:setAngle(angle)
  checkNumber(angle, "angle")

  self.angle = angle
  self.cos, self.sin = math.cos(angle), math.sin(angle)

  adjustScale(self)
  adjustPosition(self)
end

function gamera:getWorld()
  return self.wl, self.wt, self.ww, self.wh
end

function gamera:getWindow()
  return self.l, self.t, self.w, self.h
end

function gamera:getPosition()
  return self.x, self.y
end

function gamera:getScale()
  return self.scale
end

function gamera:getAngle()
  return self.angle
end

function gamera:getVisible()
  local w,h = getVisibleArea(self)
  return self.x - w*0.5, self.y - h*0.5, w, h
end

function gamera:getVisibleCorners()
  local x,y,w2,h2 = self.x, self.y, self.w2, self.h2

  local x1,y1 = cornerTransform(self, x-w2,y-h2)
  local x2,y2 = cornerTransform(self, x+w2,y-h2)
  local x3,y3 = cornerTransform(self, x+w2,y+h2)
  local x4,y4 = cornerTransform(self, x-w2,y+h2)

  return x1,y1,x2,y2,x3,y3,x4,y4
end

function gamera:draw(f)
  love.graphics.setScissor(self:getWindow())

  love.graphics.push()
    local scale = self.scale
    love.graphics.scale(scale)

    love.graphics.translate((self.w2 + self.l) / scale, (self.h2+self.t) / scale)
    love.graphics.rotate(-self.angle)
    love.graphics.translate(-self.x, -self.y)

    f(self:getVisible())

  love.graphics.pop()

  love.graphics.setScissor()
end

function gamera:toWorld(x,y)
  local scale, sin, cos = self.scale, self.sin, self.cos
  x,y = (x - self.w2 - self.l) / scale, (y - self.h2 - self.t) / scale
  x,y = cos*x - sin*y, sin*x + cos*y
  return x + self.x, y + self.y
end

function gamera:toScreen(x,y)
  local scale, sin, cos = self.scale, self.sin, self.cos
  x,y = x - self.x, y - self.y
  x,y = cos*x + sin*y, -sin*x + cos*y
  return scale * x + self.w2 + self.l, scale * y + self.h2 + self.t
end

return gamera




-----------------------------------------------------------------------------
-- JSON4Lua: JSON encoding / decoding support for the Lua language.
-- json Module.
-- Author: Craig Mason-Jones
-- Homepage: http://github.com/craigmj/json4lua/
-- Version: 1.0.0
-- This module is released under the MIT License (MIT).
-- Please see LICENCE.txt for details.
--
-- USAGE:
-- This module exposes two functions:
--   json.encode(o)
--     Returns the table / string / boolean / number / nil / json.null value as a JSON-encoded string.
--   json.decode(json_string)
--     Returns a Lua object populated with the data encoded in the JSON string json_string.
--
-- REQUIREMENTS:
--   compat-5.1 if using Lua 5.0
--
-- CHANGELOG
--   0.9.20 Introduction of local Lua functions for private functions (removed _ function prefix). 
--          Fixed Lua 5.1 compatibility issues.
--   		Introduced json.null to have null values in associative arrays.
--          json.encode() performance improvement (more than 50%) through table.concat rather than ..
--          Introduced decode ability to ignore /**/ comments in the JSON string.
--   0.9.10 Fix to array encoding / decoding to correctly manage nil/null values in arrays.
-----------------------------------------------------------------------------

-----------------------------------------------------------------------------
-- Imports and dependencies
-----------------------------------------------------------------------------
local math = require('math')
local string = require("string")
local table = require("table")

-----------------------------------------------------------------------------
-- Module declaration
-----------------------------------------------------------------------------
local json = {}             -- Public namespace
local json_private = {}     -- Private namespace

-- Public constants                                                            
json.EMPTY_ARRAY={}                                                           
json.EMPTY_OBJECT={}

-- Public functions

-- Private functions
local decode_scanArray
local decode_scanComment
local decode_scanConstant
local decode_scanNumber
local decode_scanObject
local decode_scanString
local decode_scanWhitespace
local encodeString
local isArray
local isEncodable

-----------------------------------------------------------------------------
-- PUBLIC FUNCTIONS
-----------------------------------------------------------------------------
--- Encodes an arbitrary Lua object / variable.
-- @param v The Lua object / variable to be JSON encoded.
-- @return String containing the JSON encoding in internal Lua string format (i.e. not unicode)
function json.encode (v)
  -- Handle nil values
  if v==nil then
    return "null"
  end
  
  local vtype = type(v)

  -- Handle strings
  if vtype=='string' then    
    return '"' .. json_private.encodeString(v) .. '"'	    -- Need to handle encoding in string
  end
  
  -- Handle booleans
  if vtype=='number' or vtype=='boolean' then
    return tostring(v)
  end
  
  -- Handle tables
  if vtype=='table' then
    local rval = {}
    -- Consider arrays separately
    local bArray, maxCount = isArray(v)
    if bArray then
      for i = 1,maxCount do
        table.insert(rval, json.encode(v[i]))
      end
    else	-- An object, not an array
      for i,j in pairs(v) do
        if isEncodable(i) and isEncodable(j) then
          table.insert(rval, '"' .. json_private.encodeString(i) .. '":' .. json.encode(j))
        end
      end
    end
    if bArray then
      return '[' .. table.concat(rval,',') ..']'
    else
      return '{' .. table.concat(rval,',') .. '}'
    end
  end
  
  -- Handle null values
  if vtype=='function' and v==json.null then
    return 'null'
  end
  
  assert(false,'encode attempt to encode unsupported type ' .. vtype .. ':' .. tostring(v))
end


--- Decodes a JSON string and returns the decoded value as a Lua data structure / value.
-- @param s The string to scan.
-- @param [startPos] Optional starting position where the JSON string is located. Defaults to 1.
-- @param Lua object, number The object that was scanned, as a Lua table / string / number / boolean or nil,
-- and the position of the first character after
-- the scanned JSON object.
function json.decode(s, startPos)
  startPos = startPos and startPos or 1
  startPos = decode_scanWhitespace(s,startPos)
  assert(startPos<=string.len(s), 'Unterminated JSON encoded object found at position in [' .. s .. ']')
  local curChar = string.sub(s,startPos,startPos)
  -- Object
  if curChar=='{' then
    return decode_scanObject(s,startPos)
  end
  -- Array
  if curChar=='[' then
    return decode_scanArray(s,startPos)
  end
  -- Number
  if string.find("+-0123456789.e", curChar, 1, true) then
    return decode_scanNumber(s,startPos)
  end
  -- String
  if curChar==[["]] or curChar==[[']] then
    return decode_scanString(s,startPos)
  end
  if string.sub(s,startPos,startPos+1)=='/*' then
    return json.decode(s, decode_scanComment(s,startPos))
  end
  -- Otherwise, it must be a constant
  return decode_scanConstant(s,startPos)
end

--- The null function allows one to specify a null value in an associative array (which is otherwise
-- discarded if you set the value with 'nil' in Lua. Simply set t = { first=json.null }
function json.null()
  return json.null -- so json.null() will also return null ;-)
end
-----------------------------------------------------------------------------
-- Internal, PRIVATE functions.
-- Following a Python-like convention, I have prefixed all these 'PRIVATE'
-- functions with an underscore.
-----------------------------------------------------------------------------

--- Scans an array from JSON into a Lua object
-- startPos begins at the start of the array.
-- Returns the array and the next starting position
-- @param s The string being scanned.
-- @param startPos The starting position for the scan.
-- @return table, int The scanned array as a table, and the position of the next character to scan.
function decode_scanArray(s,startPos)
  local array = {}	-- The return value
  local stringLen = string.len(s)
  assert(string.sub(s,startPos,startPos)=='[','decode_scanArray called but array does not start at position ' .. startPos .. ' in string:\n'..s )
  startPos = startPos + 1
  -- Infinite loop for array elements
  repeat
    startPos = decode_scanWhitespace(s,startPos)
    assert(startPos<=stringLen,'JSON String ended unexpectedly scanning array.')
    local curChar = string.sub(s,startPos,startPos)
    if (curChar==']') then
      return array, startPos+1
    end
    if (curChar==',') then
      startPos = decode_scanWhitespace(s,startPos+1)
    end
    assert(startPos<=stringLen, 'JSON String ended unexpectedly scanning array.')
    object, startPos = json.decode(s,startPos)
    table.insert(array,object)
  until false
end

--- Scans a comment and discards the comment.
-- Returns the position of the next character following the comment.
-- @param string s The JSON string to scan.
-- @param int startPos The starting position of the comment
function decode_scanComment(s, startPos)
  assert( string.sub(s,startPos,startPos+1)=='/*', "decode_scanComment called but comment does not start at position " .. startPos)
  local endPos = string.find(s,'*/',startPos+2)
  assert(endPos~=nil, "Unterminated comment in string at " .. startPos)
  return endPos+2  
end

--- Scans for given constants: true, false or null
-- Returns the appropriate Lua type, and the position of the next character to read.
-- @param s The string being scanned.
-- @param startPos The position in the string at which to start scanning.
-- @return object, int The object (true, false or nil) and the position at which the next character should be 
-- scanned.
function decode_scanConstant(s, startPos)
  local consts = { ["true"] = true, ["false"] = false, ["null"] = nil }
  local constNames = {"true","false","null"}

  for i,k in pairs(constNames) do
    if string.sub(s,startPos, startPos + string.len(k) -1 )==k then
      return consts[k], startPos + string.len(k)
    end
  end
  assert(nil, 'Failed to scan constant from string ' .. s .. ' at starting position ' .. startPos)
end

--- Scans a number from the JSON encoded string.
-- (in fact, also is able to scan numeric +- eqns, which is not
-- in the JSON spec.)
-- Returns the number, and the position of the next character
-- after the number.
-- @param s The string being scanned.
-- @param startPos The position at which to start scanning.
-- @return number, int The extracted number and the position of the next character to scan.
function decode_scanNumber(s,startPos)
  local endPos = startPos+1
  local stringLen = string.len(s)
  local acceptableChars = "+-0123456789.e"
  while (string.find(acceptableChars, string.sub(s,endPos,endPos), 1, true)
	and endPos<=stringLen
	) do
    endPos = endPos + 1
  end
  local stringValue = 'return ' .. string.sub(s,startPos, endPos-1)
  local stringEval = loadstring(stringValue)
  assert(stringEval, 'Failed to scan number [ ' .. stringValue .. '] in JSON string at position ' .. startPos .. ' : ' .. endPos)
  return stringEval(), endPos
end

--- Scans a JSON object into a Lua object.
-- startPos begins at the start of the object.
-- Returns the object and the next starting position.
-- @param s The string being scanned.
-- @param startPos The starting position of the scan.
-- @return table, int The scanned object as a table and the position of the next character to scan.
function decode_scanObject(s,startPos)
  local object = {}
  local stringLen = string.len(s)
  local key, value
  assert(string.sub(s,startPos,startPos)=='{','decode_scanObject called but object does not start at position ' .. startPos .. ' in string:\n' .. s)
  startPos = startPos + 1
  repeat
    startPos = decode_scanWhitespace(s,startPos)
    assert(startPos<=stringLen, 'JSON string ended unexpectedly while scanning object.')
    local curChar = string.sub(s,startPos,startPos)
    if (curChar=='}') then
      return object,startPos+1
    end
    if (curChar==',') then
      startPos = decode_scanWhitespace(s,startPos+1)
    end
    assert(startPos<=stringLen, 'JSON string ended unexpectedly scanning object.')
    -- Scan the key
    key, startPos = json.decode(s,startPos)
    assert(startPos<=stringLen, 'JSON string ended unexpectedly searching for value of key ' .. key)
    startPos = decode_scanWhitespace(s,startPos)
    assert(startPos<=stringLen, 'JSON string ended unexpectedly searching for value of key ' .. key)
    assert(string.sub(s,startPos,startPos)==':','JSON object key-value assignment mal-formed at ' .. startPos)
    startPos = decode_scanWhitespace(s,startPos+1)
    assert(startPos<=stringLen, 'JSON string ended unexpectedly searching for value of key ' .. key)
    value, startPos = json.decode(s,startPos)
    object[key]=value
  until false	-- infinite loop while key-value pairs are found
end

-- START SoniEx2
-- Initialize some things used by decode_scanString
-- You know, for efficiency
local escapeSequences = {
  ["\\t"] = "\t",
  ["\\f"] = "\f",
  ["\\r"] = "\r",
  ["\\n"] = "\n",
  ["\\b"] = "\b"
}
setmetatable(escapeSequences, {__index = function(t,k)
  -- skip "\" aka strip escape
  return string.sub(k,2)
end})
-- END SoniEx2

--- Scans a JSON string from the opening inverted comma or single quote to the
-- end of the string.
-- Returns the string extracted as a Lua string,
-- and the position of the next non-string character
-- (after the closing inverted comma or single quote).
-- @param s The string being scanned.
-- @param startPos The starting position of the scan.
-- @return string, int The extracted string as a Lua string, and the next character to parse.
function decode_scanString(s,startPos)
  assert(startPos, 'decode_scanString(..) called without start position')
  local startChar = string.sub(s,startPos,startPos)
  -- START SoniEx2
  -- PS: I don't think single quotes are valid JSON
  assert(startChar == [["]] or startChar == [[']],'decode_scanString called for a non-string')
  --assert(startPos, "String decoding failed: missing closing " .. startChar .. " for string at position " .. oldStart)
  local t = {}
  local i,j = startPos,startPos
  while string.find(s, startChar, j+1) ~= j+1 do
    local oldj = j
    i,j = string.find(s, "\\.", j+1)
    local x,y = string.find(s, startChar, oldj+1)
    if not i or x < i then
      i,j = x,y-1
    end
    table.insert(t, string.sub(s, oldj+1, i-1))
    if string.sub(s, i, j) == "\\u" then
      local a = string.sub(s,j+1,j+4)
      j = j + 4
      local n = tonumber(a, 16)
      assert(n, "String decoding failed: bad Unicode escape " .. a .. " at position " .. i .. " : " .. j)
      -- math.floor(x/2^y) == lazy right shift
      -- a % 2^b == bitwise_and(a, (2^b)-1)
      -- 64 = 2^6
      -- 4096 = 2^12 (or 2^6 * 2^6)
      local x
      if n < 0x80 then
        x = string.char(n % 0x80)
      elseif n < 0x800 then
        -- [110x xxxx] [10xx xxxx]
        x = string.char(0xC0 + (math.floor(n/64) % 0x20), 0x80 + (n % 0x40))
      else
        -- [1110 xxxx] [10xx xxxx] [10xx xxxx]
        x = string.char(0xE0 + (math.floor(n/4096) % 0x10), 0x80 + (math.floor(n/64) % 0x40), 0x80 + (n % 0x40))
      end
      table.insert(t, x)
    else
      table.insert(t, escapeSequences[string.sub(s, i, j)])
    end
  end
  table.insert(t,string.sub(j, j+1))
  assert(string.find(s, startChar, j+1), "String decoding failed: missing closing " .. startChar .. " at position " .. j .. "(for string at position " .. startPos .. ")")
  return table.concat(t,""), j+2
  -- END SoniEx2
end

--- Scans a JSON string skipping all whitespace from the current start position.
-- Returns the position of the first non-whitespace character, or nil if the whole end of string is reached.
-- @param s The string being scanned
-- @param startPos The starting position where we should begin removing whitespace.
-- @return int The first position where non-whitespace was encountered, or string.len(s)+1 if the end of string
-- was reached.
function decode_scanWhitespace(s,startPos)
  local whitespace=" \n\r\t"
  local stringLen = string.len(s)
  while ( string.find(whitespace, string.sub(s,startPos,startPos), 1, true)  and startPos <= stringLen) do
    startPos = startPos + 1
  end
  return startPos
end

--- Encodes a string to be JSON-compatible.
-- This just involves back-quoting inverted commas, back-quotes and newlines, I think ;-)
-- @param s The string to return as a JSON encoded (i.e. backquoted string)
-- @return The string appropriately escaped.

local escapeList = {
    ['"']  = '\\"',
    ['\\'] = '\\\\',
    ['/']  = '\\/', 
    ['\b'] = '\\b',
    ['\f'] = '\\f',
    ['\n'] = '\\n',
    ['\r'] = '\\r',
    ['\t'] = '\\t'
}

function json_private.encodeString(s)
 local s = tostring(s)
 return s:gsub(".", function(c) return escapeList[c] end) -- SoniEx2: 5.0 compat
end

-- Determines whether the given Lua type is an array or a table / dictionary.
-- We consider any table an array if it has indexes 1..n for its n items, and no
-- other data in the table.
-- I think this method is currently a little 'flaky', but can't think of a good way around it yet...
-- @param t The table to evaluate as an array
-- @return boolean, number True if the table can be represented as an array, false otherwise. If true,
-- the second returned value is the maximum
-- number of indexed elements in the array. 
function isArray(t)
  -- Next we count all the elements, ensuring that any non-indexed elements are not-encodable 
  -- (with the possible exception of 'n')
  if (t == json.EMPTY_ARRAY) then return true, 0 end
  if (t == json.EMPTY_OBJECT) then return false end
  
  local maxIndex = 0
  for k,v in pairs(t) do
    if (type(k)=='number' and math.floor(k)==k and 1<=k) then	-- k,v is an indexed pair
      if (not isEncodable(v)) then return false end	-- All array elements must be encodable
      maxIndex = math.max(maxIndex,k)
    else
      if (k=='n') then
        if v ~= (t.n or #t) then return false end  -- False if n does not hold the number of elements
      else -- Else of (k=='n')
        if isEncodable(v) then return false end
      end  -- End of (k~='n')
    end -- End of k,v not an indexed pair
  end  -- End of loop across all pairs
  return true, maxIndex
end

--- Determines whether the given Lua object / table / variable can be JSON encoded. The only
-- types that are JSON encodable are: string, boolean, number, nil, table and json.null.
-- In this implementation, all other types are ignored.
-- @param o The object to examine.
-- @return boolean True if the object should be JSON encoded, false if it should be ignored.
function isEncodable(o)
  local t = type(o)
  return (t=='string' or t=='boolean' or t=='number' or t=='nil' or t=='table') or
     (t=='function' and o==json.null) 
end

return json
--
-- lume
--
-- Copyright (c) 2016 rxi
--
-- This library is free software; you can redistribute it and/or modify it
-- under the terms of the MIT license. See LICENSE for details.
--

local lume = { _version = "2.2.3" }

local pairs, ipairs = pairs, ipairs
local type, assert, unpack = type, assert, unpack or table.unpack
local tostring, tonumber = tostring, tonumber
local math_floor = math.floor
local math_ceil = math.ceil
local math_atan2 = math.atan2 or math.atan
local math_sqrt = math.sqrt
local math_abs = math.abs

local noop = function()
end

local identity = function(x)
  return x
end

local patternescape = function(str)
  return str:gsub("[%(%)%.%%%+%-%*%?%[%]%^%$]", "%%%1")
end

local absindex = function(len, i)
  return i < 0 and (len + i + 1) or i
end

local iscallable = function(x)
  if type(x) == "function" then return true end
  local mt = getmetatable(x)
  return mt and mt.__call ~= nil
end

local getiter = function(x)
  if lume.isarray(x) then
    return ipairs
  elseif type(x) == "table" then
    return pairs
  end
  error("expected table", 3)
end

local iteratee = function(x)
  if x == nil then return identity end
  if iscallable(x) then return x end
  if type(x) == "table" then
    return function(z)
      for k, v in pairs(x) do
        if z[k] ~= v then return false end
      end
      return true
    end
  end
  return function(z) return z[x] end
end



function lume.clamp(x, min, max)
  return x < min and min or (x > max and max or x)
end


function lume.round(x, increment)
  if increment then return lume.round(x / increment) * increment end
  return x >= 0 and math_floor(x + .5) or math_ceil(x - .5)
end


function lume.sign(x)
  return x < 0 and -1 or 1
end


function lume.lerp(a, b, amount)
  return a + (b - a) * lume.clamp(amount, 0, 1)
end


function lume.smooth(a, b, amount)
  local t = lume.clamp(amount, 0, 1)
  local m = t * t * (3 - 2 * t)
  return a + (b - a) * m
end


function lume.pingpong(x)
  return 1 - math_abs(1 - x % 2)
end


function lume.distance(x1, y1, x2, y2, squared)
  local dx = x1 - x2
  local dy = y1 - y2
  local s = dx * dx + dy * dy
  return squared and s or math_sqrt(s)
end


function lume.angle(x1, y1, x2, y2)
  return math_atan2(y2 - y1, x2 - x1)
end


function lume.vector(angle, magnitude)
  return math.cos(angle) * magnitude, math.sin(angle) * magnitude
end


function lume.random(a, b)
  if not a then a, b = 0, 1 end
  if not b then b = 0 end
  return a + math.random() * (b - a)
end


function lume.randomchoice(t)
  return t[math.random(#t)]
end


function lume.weightedchoice(t)
  local sum = 0
  for _, v in pairs(t) do
    assert(v >= 0, "weight value less than zero")
    sum = sum + v
  end
  assert(sum ~= 0, "all weights are zero")
  local rnd = lume.random(sum)
  for k, v in pairs(t) do
    if rnd < v then return k end
    rnd = rnd - v
  end
end


function lume.isarray(x)
  return (type(x) == "table" and x[1] ~= nil) and true or false
end


function lume.push(t, ...)
  local n = select("#", ...)
  for i = 1, n do
    t[#t + 1] = select(i, ...)
  end
  return ...
end


function lume.remove(t, x)
  local iter = getiter(t)
  for i, v in iter(t) do
    if v == x then
      if lume.isarray(t) then
        table.remove(t, i)
        break
      else
        t[i] = nil
        break
      end
    end
  end
  return x
end


function lume.clear(t)
  local iter = getiter(t)
  for k in iter(t) do
    t[k] = nil
  end
  return t
end


function lume.extend(t, ...)
  for i = 1, select("#", ...) do
    local x = select(i, ...)
    if x then
      for k, v in pairs(x) do
        t[k] = v
      end
    end
  end
  return t
end


function lume.shuffle(t)
  local rtn = {}
  for i = 1, #t do
    local r = math.random(i)
    if r ~= i then
      rtn[i] = rtn[r]
    end
    rtn[r] = t[i]
  end
  return rtn
end


function lume.sort(t, comp)
  local rtn = lume.clone(t)
  if comp then
    if type(comp) == "string" then
      table.sort(rtn, function(a, b) return a[comp] < b[comp] end)
    else
      table.sort(rtn, comp)
    end
  else
    table.sort(rtn)
  end
  return rtn
end


function lume.array(...)
  local t = {}
  for x in ... do t[#t + 1] = x end
  return t
end


function lume.each(t, fn, ...)
  local iter = getiter(t)
  if type(fn) == "string" then
    for _, v in iter(t) do v[fn](v, ...) end
  else
    for _, v in iter(t) do fn(v, ...) end
  end
  return t
end


function lume.map(t, fn)
  fn = iteratee(fn)
  local iter = getiter(t)
  local rtn = {}
  for k, v in iter(t) do rtn[k] = fn(v) end
  return rtn
end


function lume.all(t, fn)
  fn = iteratee(fn)
  local iter = getiter(t)
  for _, v in iter(t) do
    if not fn(v) then return false end
  end
  return true
end


function lume.any(t, fn)
  fn = iteratee(fn)
  local iter = getiter(t)
  for _, v in iter(t) do
    if fn(v) then return true end
  end
  return false
end


function lume.reduce(t, fn, first)
  local acc = first
  local started = first and true or false
  local iter = getiter(t)
  for _, v in iter(t) do
    if started then
      acc = fn(acc, v)
    else
      acc = v
      started = true
    end
  end
  assert(started, "reduce of an empty table with no first value")
  return acc
end


function lume.set(t)
  local rtn = {}
  for k in pairs(lume.invert(t)) do
    rtn[#rtn + 1] = k
  end
  return rtn
end


function lume.filter(t, fn, retainkeys)
  fn = iteratee(fn)
  local iter = getiter(t)
  local rtn = {}
  if retainkeys then
    for k, v in iter(t) do
      if fn(v) then rtn[k] = v end
    end
  else
    for _, v in iter(t) do
      if fn(v) then rtn[#rtn + 1] = v end
    end
  end
  return rtn
end


function lume.reject(t, fn, retainkeys)
  fn = iteratee(fn)
  local iter = getiter(t)
  local rtn = {}
  if retainkeys then
    for k, v in iter(t) do
      if not fn(v) then rtn[k] = v end
    end
  else
    for _, v in iter(t) do
      if not fn(v) then rtn[#rtn + 1] = v end
    end
  end
  return rtn
end


function lume.merge(...)
  local rtn = {}
  for i = 1, select("#", ...) do
    local t = select(i, ...)
    local iter = getiter(t)
    for k, v in iter(t) do
      rtn[k] = v
    end
  end
  return rtn
end


function lume.concat(...)
  local rtn = {}
  for i = 1, select("#", ...) do
    local t = select(i, ...)
    if t ~= nil then
      local iter = getiter(t)
      for _, v in iter(t) do
        rtn[#rtn + 1] = v
      end
    end
  end
  return rtn
end


function lume.find(t, value)
  local iter = getiter(t)
  for k, v in iter(t) do
    if v == value then return k end
  end
  return nil
end


function lume.match(t, fn)
  fn = iteratee(fn)
  local iter = getiter(t)
  for k, v in iter(t) do
    if fn(v) then return v, k end
  end
  return nil
end


function lume.count(t, fn)
  local count = 0
  local iter = getiter(t)
  if fn then
    fn = iteratee(fn)
    for _, v in iter(t) do
      if fn(v) then count = count + 1 end
    end
  else
    if lume.isarray(t) then
      return #t
    end
    for _ in iter(t) do count = count + 1 end
  end
  return count
end


function lume.slice(t, i, j)
  i = i and absindex(#t, i) or 1
  j = j and absindex(#t, j) or #t
  local rtn = {}
  for x = i < 1 and 1 or i, j > #t and #t or j do
    rtn[#rtn + 1] = t[x]
  end
  return rtn
end


function lume.first(t, n)
  if not n then return t[1] end
  return lume.slice(t, 1, n)
end


function lume.last(t, n)
  if not n then return t[#t] end
  return lume.slice(t, -n, -1)
end


function lume.invert(t)
  local rtn = {}
  for k, v in pairs(t) do rtn[v] = k end
  return rtn
end


function lume.pick(t, ...)
  local rtn = {}
  for i = 1, select("#", ...) do
    local k = select(i, ...)
    rtn[k] = t[k]
  end
  return rtn
end


function lume.keys(t)
  local rtn = {}
  local iter = getiter(t)
  for k in iter(t) do rtn[#rtn + 1] = k end
  return rtn
end


function lume.clone(t)
  local rtn = {}
  for k, v in pairs(t) do rtn[k] = v end
  return rtn
end


function lume.fn(fn, ...)
  assert(iscallable(fn), "expected a function as the first argument")
  local args = { ... }
  return function(...)
    local a = lume.concat(args, { ... })
    return fn(unpack(a))
  end
end


function lume.once(fn, ...)
  local f = lume.fn(fn, ...)
  local done = false
  return function(...)
    if done then return end
    done = true
    return f(...)
  end
end


local memoize_fnkey = {}
local memoize_nil = {}

function lume.memoize(fn)
  local cache = {}
  return function(...)
    local c = cache
    for i = 1, select("#", ...) do
      local a = select(i, ...) or memoize_nil
      c[a] = c[a] or {}
      c = c[a]
    end
    c[memoize_fnkey] = c[memoize_fnkey] or {fn(...)}
    return unpack(c[memoize_fnkey])
  end
end


function lume.combine(...)
  local n = select('#', ...)
  if n == 0 then return noop end
  if n == 1 then
    local fn = select(1, ...)
    if not fn then return noop end
    assert(iscallable(fn), "expected a function or nil")
    return fn
  end
  local funcs = {}
  for i = 1, n do
    local fn = select(i, ...)
    if fn ~= nil then
      assert(iscallable(fn), "expected a function or nil")
      funcs[#funcs + 1] = fn
    end
  end
  return function(...)
    for _, f in ipairs(funcs) do f(...) end
  end
end


function lume.call(fn, ...)
  if fn then
    return fn(...)
  end
end


function lume.time(fn, ...)
  local start = os.clock()
  local rtn = {fn(...)}
  return (os.clock() - start), unpack(rtn)
end


local lambda_cache = {}

function lume.lambda(str)
  if not lambda_cache[str] then
    local args, body = str:match([[^([%w,_ ]-)%->(.-)$]])
    assert(args and body, "bad string lambda")
    local s = "return function(" .. args .. ")\nreturn " .. body .. "\nend"
    lambda_cache[str] = lume.dostring(s)
  end
  return lambda_cache[str]
end


local serialize

local serialize_map = {
  [ "boolean" ] = tostring,
  [ "nil"     ] = tostring,
  [ "string"  ] = function(v) return string.format("%q", v) end,
  [ "number"  ] = function(v)
    if      v ~=  v     then return  "0/0"      --  nan
    elseif  v ==  1 / 0 then return  "1/0"      --  inf
    elseif  v == -1 / 0 then return "-1/0" end  -- -inf
    return tostring(v)
  end,
  [ "table"   ] = function(t, stk)
    stk = stk or {}
    if stk[t] then error("circular reference") end
    local rtn = {}
    stk[t] = true
    for k, v in pairs(t) do
      rtn[#rtn + 1] = "[" .. serialize(k, stk) .. "]=" .. serialize(v, stk)
    end
    stk[t] = nil
    return "{" .. table.concat(rtn, ",") .. "}"
  end
}

setmetatable(serialize_map, {
  __index = function(_, k) error("unsupported serialize type: " .. k) end
})

serialize = function(x, stk)
  return serialize_map[type(x)](x, stk)
end

function lume.serialize(x)
  return serialize(x)
end


function lume.deserialize(str)
  return lume.dostring("return " .. str)
end


function lume.split(str, sep)
  if not sep then
    return lume.array(str:gmatch("([%S]+)"))
  else
    assert(sep ~= "", "empty separator")
    local psep = patternescape(sep)
    return lume.array((str..sep):gmatch("(.-)("..psep..")"))
  end
end


function lume.trim(str, chars)
  if not chars then return str:match("^[%s]*(.-)[%s]*$") end
  chars = patternescape(chars)
  return str:match("^[" .. chars .. "]*(.-)[" .. chars .. "]*$")
end


function lume.wordwrap(str, limit)
  limit = limit or 72
  local check
  if type(limit) == "number" then
    check = function(s) return #s >= limit end
  else
    check = limit
  end
  local rtn = {}
  local line = ""
  for word, spaces in str:gmatch("(%S+)(%s*)") do
    local s = line .. word
    if check(s) then
      table.insert(rtn, line .. "\n")
      line = word
    else
      line = s
    end
    for c in spaces:gmatch(".") do
      if c == "\n" then
        table.insert(rtn, line .. "\n")
        line = ""
      else
        line = line .. c
      end
    end
  end
  table.insert(rtn, line)
  return table.concat(rtn)
end


function lume.format(str, vars)
  if not vars then return str end
  local f = function(x)
    return tostring(vars[x] or vars[tonumber(x)] or "{" .. x .. "}")
  end
  return (str:gsub("{(.-)}", f))
end


function lume.trace(...)
  local info = debug.getinfo(2, "Sl")
  local t = { info.short_src .. ":" .. info.currentline .. ":" }
  for i = 1, select("#", ...) do
    local x = select(i, ...)
    if type(x) == "number" then
      x = string.format("%g", lume.round(x, .01))
    end
    t[#t + 1] = tostring(x)
  end
  print(table.concat(t, " "))
end


function lume.dostring(str)
  return assert((loadstring or load)(str))()
end


function lume.uuid()
  local fn = function(x)
    local r = math.random(16) - 1
    r = (x == "x") and (r + 1) or (r % 4) + 9
    return ("0123456789abcdef"):sub(r, r)
  end
  return (("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"):gsub("[xy]", fn))
end


function lume.hotswap(modname)
  local oldglobal = lume.clone(_G)
  local updated = {}
  local function update(old, new)
    if updated[old] then return end
    updated[old] = true
    local oldmt, newmt = getmetatable(old), getmetatable(new)
    if oldmt and newmt then update(oldmt, newmt) end
    for k, v in pairs(new) do
      if type(v) == "table" then update(old[k], v) else old[k] = v end
    end
  end
  local err = nil
  local function onerror(e)
    for k in pairs(_G) do _G[k] = oldglobal[k] end
    err = lume.trim(e)
  end
  local ok, oldmod = pcall(require, modname)
  oldmod = ok and oldmod or nil
  xpcall(function()
    package.loaded[modname] = nil
    local newmod = require(modname)
    if type(oldmod) == "table" then update(oldmod, newmod) end
    for k, v in pairs(oldglobal) do
      if v ~= _G[k] and type(v) == "table" then
        update(v, _G[k])
        _G[k] = v
      end
    end
  end, onerror)
  package.loaded[modname] = oldmod
  if err then return nil, err end
  return oldmod
end


local ripairs_iter = function(t, i)
  i = i - 1
  local v = t[i]
  if v then return i, v end
end

function lume.ripairs(t)
  return ripairs_iter, t, (#t + 1)
end


function lume.color(str, mul)
  mul = mul or 1
  local r, g, b, a
  r, g, b = str:match("#(%x%x)(%x%x)(%x%x)")
  if r then
    r = tonumber(r, 16) / 0xff
    g = tonumber(g, 16) / 0xff
    b = tonumber(b, 16) / 0xff
    a = 1
  elseif str:match("rgba?%s*%([%d%s%.,]+%)") then
    local f = str:gmatch("[%d.]+")
    r = (f() or 0) / 0xff
    g = (f() or 0) / 0xff
    b = (f() or 0) / 0xff
    a = f() or 1
  else
    error(("bad color string '%s'"):format(str))
  end
  return r * mul, g * mul, b * mul, a * mul
end


function lume.rgba(color)
  local a = math_floor((color / 16777216) % 256)
  local r = math_floor((color /    65536) % 256)
  local g = math_floor((color /      256) % 256)
  local b = math_floor((color) % 256)
  return r, g, b, a
end


local chain_mt = {}
chain_mt.__index = lume.map(lume.filter(lume, iscallable, true),
  function(fn)
    return function(self, ...)
      self._value = fn(self._value, ...)
      return self
    end
  end)
chain_mt.__index.result = function(x) return x._value end

function lume.chain(value)
  return setmetatable({ _value = value }, chain_mt)
end

setmetatable(lume,  {
  __call = function(_, ...)
    return lume.chain(...)
  end
})


return lume
local lua = {
  debug = debug,
  type = type
}
local getfenv, setfenv, dump
-- do
--  local _obj_0 = require("moonscript.util")
--  getfenv, setfenv, dump = _obj_0.getfenv, _obj_0.setfenv, _obj_0.dump
-- end
local p, is_object, type, debug, run_with_scope, bind_methods, defaultbl, extend, copy, mixin, mixin_object, mixin_table, fold
p = function(...)
  return print(dump(...))
end
is_object = function(value)
  return lua.type(value) == "table" and value.__class
end
type = function(value)
  local base_type = lua.type(value)
  if base_type == "table" then
    local cls = value.__class
    if cls then
      return cls
    end
  end
  return base_type
end
debug = setmetatable({
  upvalue = function(fn, k, v)
    local upvalues = { }
    local i = 1
    while true do
      local name = lua.debug.getupvalue(fn, i)
      if name == nil then
        break
      end
      upvalues[name] = i
      i = i + 1
    end
    if not upvalues[k] then
      error("Failed to find upvalue: " .. tostring(k))
    end
    if not v then
      local _, value = lua.debug.getupvalue(fn, upvalues[k])
      return value
    else
      return lua.debug.setupvalue(fn, upvalues[k], v)
    end
  end
}, {
  __index = lua.debug
})
run_with_scope = function(fn, scope, ...)
  local old_env = getfenv(fn)
  local env = setmetatable({ }, {
    __index = function(self, name)
      local val = scope[name]
      if val ~= nil then
        return val
      else
        return old_env[name]
      end
    end
  })
  setfenv(fn, env)
  return fn(...)
end
bind_methods = function(obj)
  return setmetatable({ }, {
    __index = function(self, name)
      local val = obj[name]
      if val and lua.type(val) == "function" then
        local bound
        bound = function(...)
          return val(obj, ...)
        end
        self[name] = bound
        return bound
      else
        return val
      end
    end
  })
end
defaultbl = function(t, fn)
  if not fn then
    fn = t
    t = { }
  end
  return setmetatable(t, {
    __index = function(self, name)
      local val = fn(self, name)
      rawset(self, name, val)
      return val
    end
  })
end
extend = function(...)
  local tbls = {
    ...
  }
  if #tbls < 2 then
    return 
  end
  for i = 1, #tbls - 1 do
    local a = tbls[i]
    local b = tbls[i + 1]
    setmetatable(a, {
      __index = b
    })
  end
  return tbls[1]
end
copy = function(self)
  local _tbl_0 = { }
  for key, val in pairs(self) do
    _tbl_0[key] = val
  end
  return _tbl_0
end
mixin = function(self, cls, ...)
  for key, val in pairs(cls.__base) do
    if not key:match("^__") then
      self[key] = val
    end
  end
  return cls.__init(self, ...)
end
mixin_object = function(self, object, methods)
  for _index_0 = 1, #methods do
    local name = methods[_index_0]
    self[name] = function(parent, ...)
      return object[name](object, ...)
    end
  end
end
mixin_table = function(self, tbl, keys)
  if keys then
    for _index_0 = 1, #keys do
      local key = keys[_index_0]
      self[key] = tbl[key]
    end
  else
    for key, val in pairs(tbl) do
      self[key] = val
    end
  end
end
fold = function(items, fn)
  local len = #items
  if len > 1 then
    local accum = fn(items[1], items[2])
    for i = 3, len do
      accum = fn(accum, items[i])
    end
    return accum
  else
    return items[1]
  end
end
return {
  dump = dump,
  p = p,
  is_object = is_object,
  type = type,
  debug = debug,
  run_with_scope = run_with_scope,
  bind_methods = bind_methods,
  defaultbl = defaultbl,
  extend = extend,
  copy = copy,
  mixin = mixin,
  mixin_object = mixin_object,
  mixin_table = mixin_table,
  fold = fold
}
--[[
zlib License:

Copyright (c) 2014 Minh Ngo

This software is provided 'as-is', without any express or implied
warranty. In no event will the authors be held liable for any damages
arising from the use of this software.

Permission is granted to anyone to use this software for any purpose,
including commercial applications, and to alter it and redistribute it
freely, subject to the following restrictions:

   1. The origin of this software must not be misrepresented; you must not
   claim that you wrote the original software. If you use this software
   in a product, an acknowledgment in the product documentation would be
   appreciated but is not required.

   2. Altered source versions must be plainly marked as such, and must not be
   misrepresented as being the original software.

   3. This notice may not be removed or altered from any source
   distribution.
--]]

-- Based on recursive shadowcasting by Bjrn Bergstrm

local octants = {
	function(x,y) return x,y end,
	function(x,y) return y,x end,
	function(x,y) return -y,x end,
	function(x,y) return -x,y end,
	function(x,y) return -x,-y end,
	function(x,y) return -y,-x end,
	function(x,y) return y,-x end,
	function(x,y) return x,-y end,
}

local tau         = 2*math.pi
local octant_angle= math.pi / 4
local epsilon     = 1e-5


local fov = function(x0,y0,radius,isTransparent,onVisible,start_angle,last_angle)
	-- **NOTE** Assumed orientation in notes is x+ right, y+ up
	
	--[[
	Octant designation
	   \  |  /
	   4\3|2/1
	 ____\|/____
	     /|\
	   5/6|7\8
	   /  |  \
	   
	   All calculations are done on the first octant
	   To calculate FOV on other octants, reflect the cells onto the first octant
	   
	   The bottom left corner is the coordinates of a cell:
	   
	   (0,1)------(1,1)
	        |Cell|
	        |0,0 |
	   (0,0)------(1,0)
	   
	   **ARC NOTE**
	   
	   The arc angle of vision defaults to 360 degrees.
	   Arc angle is measured counterclockwise from starting to last.
	   The shortest arc is used so if start = 0 and last = 370 deg then arc angle = 10 deg.
	   To get full field of view, add 2*math.pi to starting angle. This is 
	   the only way to get a full view. Any other case will result in the 
	   smallest arc possible.
	   
	   For example:
	   start = 0 ; last = 0         --> line field of view
	   start = 0 ; last = 2*math.pi --> full field of view
	]]
	
	start_angle    = start_angle or 0
	last_angle     = last_angle or tau
	local arc_angle= (last_angle-start_angle)
	-- Clamp angles or else some checks won't work correctly
	if arc_angle - tau > epsilon or arc_angle < 0 then arc_angle = arc_angle % tau end
	start_angle = start_angle % tau
	last_angle  = last_angle % tau
	
	-- Angle interval of first octant [inclusive,exclusive)
	-- Touching the end of the interval moves onto the next octant
	-- Example: [0,pi/4)
	local first_octant = (math.floor(start_angle / octant_angle) % 8) + 1
	-- Angle interval of last octant (exclusive,inclusive]
	-- Touching the beginning of the interval moves to the prev octant
	-- Example: (0,pi/4]
	local last_octant  = ((math.ceil(last_angle / octant_angle) - 1) % 8) + 1
	
	-- Hack to make large angles work when start/last are in the same octant
	if last_octant == first_octant and arc_angle > octant_angle then 
		first_octant = (first_octant % 8) + 1
	end
	
	local octant = first_octant - 1
	
	-- Always see the origin
	onVisible(x0,y0)
	
	repeat
		octant       = (octant % 8) + 1
		local coords = octants[octant]
		local views  = {}
		-- A view is represented by two lines (steep & shallow)
		views[1]    = {
			-- {x,y,x2,y2}
			steep    = {0.5,0.5,0,radius},
			shallow  = {0.5,0.5,radius,0},
		}
		for x = 1,radius do
			if not views[1] then break end
			-- Process all remaining views
			-- Iterate backward to be able to delete views
			for i = #views,1,-1 do
				local prev_cell_solid= false
				local view           = views[i]
				local steep,shallow  = view.steep,view.shallow
				
				-- Calculate the maxmimum and minimum height of the column to scan
				-- y = slope * dx + y0
				local yi,yf
				
				-- Don't calculate if the view lines didn't change
				if steep[3] > steep[1] then
					local steep_slope  = (steep[4]-steep[2]) / (steep[3]-steep[1])
					yi = math.floor( steep[2] + steep_slope*(x-steep[1]) )
				else
					yi = x
				end
				
				if shallow[4] > shallow[2] then
					local shallow_slope = (shallow[4]-shallow[2]) / (shallow[3]-shallow[1])
					yf = math.floor( shallow[2] + shallow_slope*(x-shallow[1]) )
				else
					yf = 0
				end
				
				for y = yi,yf,-1 do
					local tx,ty = coords(x,y)
					
					-- The tile is visible if it is within the cone field of view
					if arc_angle >= tau or arc_angle >= (math.atan2(ty,tx)-start_angle) % tau then
						onVisible( x0+tx,y0+ty )
					end
					-- Found a blocking cell
					if not isTransparent( x0+tx,y0+ty ) then
						-- If the previous cell is non blocking 
						-- and it is not the first cell then
						-- add another view for the remaining columns
						if not prev_cell_solid and y < yi then
							local new_view = {
								-- Inherit the current view steep line
								steep       = {steep[1],steep[2],steep[3],steep[4]},
								-- Shallow line bumps into top left corner of block
								shallow     = {shallow[1],shallow[2],x,y+1},
							}
							
							table.insert(views,new_view)
						end
						
						prev_cell_solid = true
					elseif prev_cell_solid then
						-- Cell is transparent and moving from blocking to non-blocking
						-- Readjust steep line to steep bump
						steep[3],steep[4]= x+1,y+1
						prev_cell_solid  = false
					end
				end
				
				-- Remove the view if the last cell is blocking
				if prev_cell_solid then
					table.remove(views,i)
				end
			end
		end
	until octant == last_octant
end

return fovlocal tactile = {
  _VERSION = 'Tactile v2.0.1',
  _DESCRIPTION = 'A happy and friendly input library for LVE.',
  _URL = 'https://github.com/tesselode/tactile',
  _LICENSE = [[
    Copyright (c) 2016 Andrew Minnich

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.
  ]]
}

local function sign(x)
  return x < 0 and -1 or x > 0 and 1 or 0
end

local function verify(identity, argnum, value, expected, expectedstring)
  if type(value) ~= expected then
    error(string.format("%s: argument %d should be a %s, got %s", identity,
      argnum, expectedstring or expected, type(value)))
  end
end

local Control = {}

function Control:addAxis(f)
  table.insert(self._detectors, f)
  return self
end

function Control:addButton(f)
  table.insert(self._detectors, function()
    return f() and 1 or 0
  end)
  return self
end

function Control:addButtonPair(negative, positive)
  table.insert(self._detectors, function()
    local n, p = negative(), positive()
    return n and p and 0
      or n and -1
      or p and 1
      or 0
  end)
  return self
end

function Control:_calculateValue()
  for i = #self._detectors, 1, -1 do
    local value = self._detectors[i]()
    if math.abs(value) > self.deadzone then
      return value
    end
  end
  return 0
end

function Control:getValue()
  return self._currentValue
end

function Control:isDown(dir)
  if dir then
    return sign(self._currentValue) == sign(dir)
  end
  return self._currentValue ~= 0
end

function Control:pressed(dir)
  if dir then
    dir = sign(dir)
    return sign(self._currentValue) == dir
      and sign(self._previousValue) ~= dir
  end
  return self._currentValue ~= 0
    and self._previousValue == 0
end

function Control:released(dir)
  if dir then
    dir = sign(dir)
    return sign(self._currentValue) ~= dir
      and sign(self._previousValue) == dir
  end
  return self._currentValue == 0
    and self._previousValue ~= 0
end

function Control:update()
  self._previousValue = self._currentValue
  self._currentValue = self:_calculateValue()
end

function tactile.newControl()
  local control = {
    deadzone = .5,
    _detectors = {},
    _currentValue = 0,
    _previousValue = 0,
  }

  setmetatable(control, {
    __index = Control,
    __call = function(t)
      return t:getValue()
    end
  })

  return control
end

function tactile.keys(...)
  local keys = {...}
  for i, key in ipairs(keys) do
    verify('tactile.keys()', i, key, 'string', 'KeyConstant (string)')
  end
  return function()
    return love.keyboard.isDown(unpack(keys))
  end
end

function tactile.gamepadButtons(num, ...)
  local buttons = {...}
  for i, button in ipairs(buttons) do
    verify('tactile.gamepadButtons()', i, button, 'string',
      'GamepadButton (string)')
  end
  return function()
    local joystick = love.joystick.getJoysticks()[num]
    return joystick ~= nil and joystick:isGamepadDown(unpack(buttons))
  end
end

function tactile.gamepadAxis(num, axis)
  verify('tactile.gamepadAxis()', 1, num, 'number')
  verify('tactile.gamepadAxis()', 2, axis, 'string', 'GamepadAxis (string)')
  return function()
    local joystick = love.joystick.getJoysticks()[num]
    return joystick ~= nil and joystick:getGamepadAxis(axis) or 0
  end
end

return tactile
local talkback = {
  _VERSION     = 'Talkback v1.0.2',
  _DESCRIPTION = 'A tiny observer pattern library for Lua',
  _URL         = 'https://github.com/tesselode/talkback',
  _LICENSE     = [[
    The MIT License (MIT)

    Copyright (c) 2015 Andrew Minnich

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE.
  ]]
}

local unpack = unpack or table.unpack

local function removeByValue(t, value)
  for i = #t, 1, -1 do
    if t[i] == value then
      table.remove(t, i)
      break
    end
  end
end

local Conversation = {}
Conversation.__index = Conversation

function Conversation:listen(s, f)
  assert(s, 's must not be a nil value')
  assert(type(f) == 'function', 'f should be a function')

  local listener = {s = s, f = f}
  table.insert(self.listeners, listener)
  return listener
end

function Conversation:newGroup(...)
  local group = {isGroup = true, listeners = {}}

  function group.listen(g, s, f)
    assert(type(f) == 'function', 'f should be a function')
    table.insert(g.listeners, self:listen(s, f))
  end

  return group
end

function Conversation:stopListening(listener)
  if listener.isGroup then
    --remove groups of listeners
    for i = 1, #listener.listeners do
      removeByValue(self.listeners, listener.listeners[i])
    end
  else
    --remove single listeners
    removeByValue(self.listeners, listener)
  end
end

function Conversation:say(s, ...)
  local returned = {}
  for i = 1, #self.listeners do
    local listener = self.listeners[i]
    if s == listener.s then
      local returnedValues = {listener.f(...)}
      for j = 1, #returnedValues do
        table.insert(returned, returnedValues[j])
      end
    end
  end
  return unpack(returned)
end

function talkback.new()
  local conversation = setmetatable({}, Conversation)
  conversation.listeners = {}
  return conversation
end

return talkback
--[[
Copyright (c) 2016 Calvin Rose

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
]]

--- @module tiny-ecs
-- @author Calvin Rose
-- @license MIT
-- @copyright 2016
local tiny = {}

-- Local versions of standard lua functions
local tinsert = table.insert
local tremove = table.remove
local tsort = table.sort
local setmetatable = setmetatable
local type = type
local select = select

-- Local versions of the library functions
local tiny_manageEntities
local tiny_manageSystems
local tiny_addEntity
local tiny_addSystem
local tiny_add
local tiny_removeEntity
local tiny_removeSystem

--- Filter functions.
-- A Filter is a function that selects which Entities apply to a System.
-- Filters take two parameters, the System and the Entity, and return a boolean
-- value indicating if the Entity should be processed by the System. A truthy
-- value includes the entity, while a falsey (nil or false) value excludes the
-- entity.
--
-- Filters must be added to Systems by setting the `filter` field of the System.
-- Filter's returned by tiny-ecs's Filter functions are immutable and can be
-- used by multiple Systems.
--
--    local f1 = tiny.requireAll("position", "velocity", "size")
--    local f2 = tiny.requireAny("position", "velocity", "size")
--
--    local e1 = {
--        position = {2, 3},
--        velocity = {3, 3},
--        size = {4, 4}
--    }
--
--    local entity2 = {
--        position = {4, 5},
--        size = {4, 4}
--    }
--
--    local e3 = {
--        position = {2, 3},
--        velocity = {3, 3}
--    }
--
--    print(f1(nil, e1), f1(nil, e2), f1(nil, e3)) -- prints true, false, false
--    print(f2(nil, e1), f2(nil, e2), f2(nil, e3)) -- prints true, true, true
--
-- Filters can also be passed as arguments to other Filter constructors. This is
-- a powerful way to create complex, custom Filters that select a very specific
-- set of Entities.
--
--    -- Selects Entities with an "image" Component, but not Entities with a
--    -- "Player" or "Enemy" Component.
--    filter = tiny.requireAll("image", tiny.rejectAny("Player", "Enemy"))
--
-- @section Filter

-- A helper function to compile filters.
local filterJoin

-- A helper function to filters from string
local filterBuildString

do

    local loadstring = loadstring or load
    local function getchr(c)
        return "\\" .. c:byte()
    end
    local function make_safe(text)
        return ("%q"):format(text):gsub('\n', 'n'):gsub("[\128-\255]", getchr)
    end

    local function filterJoinRaw(prefix, seperator, ...)
        local accum = {}
        local build = {}
        for i = 1, select('#', ...) do
            local item = select(i, ...)
            if type(item) == 'string' then
                accum[#accum + 1] = ("(e[%s] ~= nil)"):format(make_safe(item))
            elseif type(item) == 'function' then
                build[#build + 1] = ('local subfilter_%d_ = select(%d, ...)')
                    :format(i, i)
                accum[#accum + 1] = ('(subfilter_%d_(system, e))'):format(i)
            else
                error 'Filter token must be a string or a filter function.'
            end
        end
        local source = ('%s\nreturn function(system, e) return %s(%s) end')
            :format(
                table.concat(build, '\n'),
                prefix,
                table.concat(accum, seperator))
        local loader, err = loadstring(source)
        if err then error(err) end
        return loader(...)
    end

    function filterJoin(...)
        local state, value = pcall(filterJoinRaw, ...)
        if state then return value else return nil, value end
    end

    local function buildPart(str)
        local accum = {}
        local subParts = {}
        str = str:gsub('%b()', function(p)
            subParts[#subParts + 1] = buildPart(p:sub(2, -2))
            return ('\255%d'):format(#subParts)
        end)
        for invert, part, sep in str:gmatch('(%!?)([^%|%&%!]+)([%|%&]?)') do
            if part:match('^\255%d+$') then
                local partIndex = tonumber(part:match(part:sub(2)))
                accum[#accum + 1] = ('%s(%s)')
                    :format(invert == '' and '' or 'not', subParts[partIndex])
            else
                accum[#accum + 1] = ("(e[%s] %s nil)")
                    :format(make_safe(part), invert == '' and '~=' or '==')
            end
            if sep ~= '' then
                accum[#accum + 1] = (sep == '|' and ' or ' or ' and ')
            end
        end
        return table.concat(accum)
    end

    function filterBuildString(str)
        local source = ("return function(_, e) return %s end")
            :format(buildPart(str))
        local loader, err = loadstring(source)
        if err then
            error(err)
        end
        return loader()
    end

end

--- Makes a Filter that selects Entities with all specified Components and
-- Filters.
function tiny.requireAll(...)
    return filterJoin('', ' and ', ...)
end

--- Makes a Filter that selects Entities with at least one of the specified
-- Components and Filters.
function tiny.requireAny(...)
    return filterJoin('', ' or ', ...)
end

--- Makes a Filter that rejects Entities with all specified Components and
-- Filters, and selects all other Entities.
function tiny.rejectAll(...)
    return filterJoin('not', ' and ', ...)
end

--- Makes a Filter that rejects Entities with at least one of the specified
-- Components and Filters, and selects all other Entities.
function tiny.rejectAny(...)
    return filterJoin('not', ' or ', ...)
end

--- Makes a Filter from a string. Syntax of `pattern` is as follows.
--
--   * Tokens are alphanumeric strings including underscores.
--   * Tokens can be separated by |, &, or surrounded by parentheses.
--   * Tokens can be prefixed with !, and are then inverted.
--
-- Examples are best:
--    'a|b|c' - Matches entities with an 'a' OR 'b' OR 'c'.
--    'a&!b&c' - Matches entities with an 'a' AND NOT 'b' AND 'c'.
--    'a|(b&c&d)|e - Matches 'a' OR ('b' AND 'c' AND 'd') OR 'e'
-- @param pattern
function tiny.filter(pattern)
    local state, value = pcall(filterBuildString, pattern)
    if state then return value else return nil, value end
end

--- System functions.
-- A System is a wrapper around function callbacks for manipulating Entities.
-- Systems are implemented as tables that contain at least one method;
-- an update function that takes parameters like so:
--
--   * `function system:update(dt)`.
--
-- There are also a few other optional callbacks:
--
--   * `function system:filter(entity)` - Returns true if this System should
-- include this Entity, otherwise should return false. If this isn't specified,
-- no Entities are included in the System.
--   * `function system:onAdd(entity)` - Called when an Entity is added to the
-- System.
--   * `function system:onRemove(entity)` - Called when an Entity is removed
-- from the System.
--   * `function system:onModify(dt)` - Called when the System is modified by
-- adding or removing Entities from the System.
--   * `function system:onAddToWorld(world)` - Called when the System is added
-- to the World, before any entities are added to the system.
--   * `function system:onRemoveFromWorld(world)` - Called when the System is
-- removed from the world, after all Entities are removed from the System.
--   * `function system:preWrap(dt)` - Called on each system before update is
-- called on any system.
--   * `function system:postWrap(dt)` - Called on each system in reverse order
-- after update is called on each system. The idea behind `preWrap` and
-- `postWrap` is to allow for systems that modify the behavior of other systems.
-- Say there is a DrawingSystem, which draws sprites to the screen, and a
-- PostProcessingSystem, that adds some blur and bloom effects. In the preWrap
-- method of the PostProcessingSystem, the System could set the drawing target
-- for the DrawingSystem to a special buffer instead the screen. In the postWrap
-- method, the PostProcessingSystem could then modify the buffer and render it
-- to the screen. In this setup, the PostProcessingSystem would be added to the
-- World after the drawingSystem (A similar but less flexible behavior could
-- be accomplished with a single custom update function in the DrawingSystem).
--
-- For Filters, it is convenient to use `tiny.requireAll` or `tiny.requireAny`,
-- but one can write their own filters as well. Set the Filter of a System like
-- so:
--    system.filter = tiny.requireAll("a", "b", "c")
-- or
--    function system:filter(entity)
--        return entity.myRequiredComponentName ~= nil
--    end
--
-- All Systems also have a few important fields that are initialized when the
-- system is added to the World. A few are important, and few should be less
-- commonly used.
--
--   * The `world` field points to the World that the System belongs to. Useful
-- for adding and removing Entities from the world dynamically via the System.
--   * The `active` flag is whether or not the System is updated automatically.
-- Inactive Systems should be updated manually or not at all via
-- `system:update(dt)`. Defaults to true.
--   * The `entities` field is an ordered list of Entities in the System. This
-- list can be used to quickly iterate through all Entities in a System.
--   * The `interval` field is an optional field that makes Systems update at
-- certain intervals using buffered time, regardless of World update frequency.
-- For example, to make a System update once a second, set the System's interval
-- to 1.
--   * The `index` field is the System's index in the World. Lower indexed
-- Systems are processed before higher indices. The `index` is a read only
-- field; to set the `index`, use `tiny.setSystemIndex(world, system)`.
--   * The `indices` field is a table of Entity keys to their indices in the
-- `entities` list. Most Systems can ignore this.
--   * The `modified` flag is an indicator if the System has been modified in
-- the last update. If so, the `onModify` callback will be called on the System
-- in the next update, if it has one. This is usually managed by tiny-ecs, so
-- users should mostly ignore this, too.
--
-- There is another option to (hopefully) increase performance in systems that
-- have items added to or removed from them often, and have lots of entities in
-- them.  Setting the `nocache` field of the system might improve performance.
-- It is still experimental. There are some restriction to systems without
-- caching, however.
--
--   * There is no `entities` table.
--   * Callbacks such onAdd, onRemove, and onModify will never be called
--   * Noncached systems cannot be sorted (There is no entities list to sort).
--
-- @section System

-- Use an empty table as a key for identifying Systems. Any table that contains
-- this key is considered a System rather than an Entity.
local systemTableKey = { "SYSTEM_TABLE_KEY" }

-- Checks if a table is a System.
local function isSystem(table)
    return table[systemTableKey]
end

-- Update function for all Processing Systems.
local function processingSystemUpdate(system, dt)
    local preProcess = system.preProcess
    local process = system.process
    local postProcess = system.postProcess

    if preProcess then
        preProcess(system, dt)
    end

    if process then
        if system.nocache then
            local entities = system.world.entityList
            local filter = system.filter
            if filter then
                for i = 1, #entities do
                    local entity = entities[i]
                    if filter(system, entity) then
                        process(system, entity, dt)
                    end
                end
            end
        else
            local entities = system.entities
            for i = 1, #entities do
                process(system, entities[i], dt)
            end
        end
    end

    if postProcess then
        postProcess(system, dt)
    end
end

-- Sorts Systems by a function system.sortDelegate(entity1, entity2) on modify.
local function sortedSystemOnModify(system)
    local entities = system.entities
    local indices = system.indices
    local sortDelegate = system.sortDelegate
    if not sortDelegate then
        local compare = system.compare
        sortDelegate = function(e1, e2)
            return compare(system, e1, e2)
        end
        system.sortDelegate = sortDelegate
    end
    tsort(entities, sortDelegate)
    for i = 1, #entities do
        indices[entities[i]] = i
    end
end

--- Creates a new System or System class from the supplied table. If `table` is
-- nil, creates a new table.
function tiny.system(table)
    table = table or {}
    table[systemTableKey] = true
    return table
end

--- Creates a new Processing System or Processing System class. Processing
-- Systems process each entity individual, and are usually what is needed.
-- Processing Systems have three extra callbacks besides those inheritted from
-- vanilla Systems.
--
--     function system:preProcess(dt) -- Called before iteration.
--     function system:process(entity, dt) -- Process each entity.
--     function system:postProcess(dt) -- Called after iteration.
--
-- Processing Systems have their own `update` method, so don't implement a
-- a custom `update` callback for Processing Systems.
-- @see system
function tiny.processingSystem(table)
    table = table or {}
    table[systemTableKey] = true
    table.update = processingSystemUpdate
    return table
end

--- Creates a new Sorted System or Sorted System class. Sorted Systems sort
-- their Entities according to a user-defined method, `system:compare(e1, e2)`,
-- which should return true if `e1` should come before `e2` and false otherwise.
-- Sorted Systems also override the default System's `onModify` callback, so be
-- careful if defining a custom callback. However, for processing the sorted
-- entities, consider `tiny.sortedProcessingSystem(table)`.
-- @see system
function tiny.sortedSystem(table)
    table = table or {}
    table[systemTableKey] = true
    table.onModify = sortedSystemOnModify
    return table
end

--- Creates a new Sorted Processing System or Sorted Processing System class.
-- Sorted Processing Systems have both the aspects of Processing Systems and
-- Sorted Systems.
-- @see system
-- @see processingSystem
-- @see sortedSystem
function tiny.sortedProcessingSystem(table)
    table = table or {}
    table[systemTableKey] = true
    table.update = processingSystemUpdate
    table.onModify = sortedSystemOnModify
    return table
end

--- World functions.
-- A World is a container that manages Entities and Systems. Typically, a
-- program uses one World at a time.
--
-- For all World functions except `tiny.world(...)`, object-oriented syntax can
-- be used instead of the documented syntax. For example,
-- `tiny.add(world, e1, e2, e3)` is the same as `world:add(e1, e2, e3)`.
-- @section World

-- Forward declaration
local worldMetaTable

--- Creates a new World.
-- Can optionally add default Systems and Entities. Returns the new World along
-- with default Entities and Systems.
function tiny.world(...)
    local ret = setmetatable({

        -- List of Entities to remove
        entitiesToRemove = {},

        -- List of Entities to change
        entitiesToChange = {},

        -- List of Entities to add
        systemsToAdd = {},

        -- List of Entities to remove
        systemsToRemove = {},

        -- Set of Entities
        entities = {},

        -- List of Systems
        systems = {}

    }, worldMetaTable)

    tiny_add(ret, ...)
    tiny_manageSystems(ret)
    tiny_manageEntities(ret)

    return ret, ...
end

--- Adds an Entity to the world.
-- Also call this on Entities that have changed Components such that they
-- match different Filters. Returns the Entity.
function tiny.addEntity(world, entity)
    local e2c = world.entitiesToChange
    e2c[#e2c + 1] = entity
    return entity
end
tiny_addEntity = tiny.addEntity

--- Adds a System to the world. Returns the System.
function tiny.addSystem(world, system)
    assert(system.world == nil, "System already belongs to a World.")
    local s2a = world.systemsToAdd
    s2a[#s2a + 1] = system
    system.world = world
    return system
end
tiny_addSystem = tiny.addSystem

--- Shortcut for adding multiple Entities and Systems to the World. Returns all
-- added Entities and Systems.
function tiny.add(world, ...)
    for i = 1, select("#", ...) do
        local obj = select(i, ...)
        if obj then
            if isSystem(obj) then
                tiny_addSystem(world, obj)
            else -- Assume obj is an Entity
                tiny_addEntity(world, obj)
            end
        end
    end
    return ...
end
tiny_add = tiny.add

--- Removes an Entity from the World. Returns the Entity.
function tiny.removeEntity(world, entity)
    local e2r = world.entitiesToRemove
    e2r[#e2r + 1] = entity
    return entity
end
tiny_removeEntity = tiny.removeEntity

--- Removes a System from the world. Returns the System.
function tiny.removeSystem(world, system)
    assert(system.world == world, "System does not belong to this World.")
    local s2r = world.systemsToRemove
    s2r[#s2r + 1] = system
    return system
end
tiny_removeSystem = tiny.removeSystem

--- Shortcut for removing multiple Entities and Systems from the World. Returns
-- all removed Systems and Entities
function tiny.remove(world, ...)
    for i = 1, select("#", ...) do
        local obj = select(i, ...)
        if obj then
            if isSystem(obj) then
                tiny_removeSystem(world, obj)
            else -- Assume obj is an Entity
                tiny_removeEntity(world, obj)
            end
        end
    end
    return ...
end

-- Adds and removes Systems that have been marked from the World.
function tiny_manageSystems(world)
    local s2a, s2r = world.systemsToAdd, world.systemsToRemove

    -- Early exit
    if #s2a == 0 and #s2r == 0 then
        return
    end

    world.systemsToAdd = {}
    world.systemsToRemove = {}

    local worldEntityList = world.entities
    local systems = world.systems

    -- Remove Systems
    for i = 1, #s2r do
        local system = s2r[i]
        local index = system.index
        local onRemove = system.onRemove
        if onRemove and not system.nocache then
            local entityList = system.entities
            for j = 1, #entityList do
                onRemove(system, entityList[j])
            end
        end
        tremove(systems, index)
        for j = index, #systems do
            systems[j].index = j
        end
        local onRemoveFromWorld = system.onRemoveFromWorld
        if onRemoveFromWorld then
            onRemoveFromWorld(system, world)
        end
        s2r[i] = nil

        -- Clean up System
        system.world = nil
        system.entities = nil
        system.indices = nil
        system.index = nil
    end

    -- Add Systems
    for i = 1, #s2a do
        local system = s2a[i]
        if systems[system.index or 0] ~= system then
            if not system.nocache then
                system.entities = {}
                system.indices = {}
            end
            if system.active == nil then
                system.active = true
            end
            system.modified = true
            system.world = world
            local index = #systems + 1
            system.index = index
            systems[index] = system
            local onAddToWorld = system.onAddToWorld
            if onAddToWorld then
                onAddToWorld(system, world)
            end

            -- Try to add Entities
            if not system.nocache then
                local entityList = system.entities
                local entityIndices = system.indices
                local onAdd = system.onAdd
                local filter = system.filter
                if filter then
                    for j = 1, #worldEntityList do
                        local entity = worldEntityList[j]
                        if filter(system, entity) then
                            local entityIndex = #entityList + 1
                            entityList[entityIndex] = entity
                            entityIndices[entity] = entityIndex
                            if onAdd then
                                onAdd(system, entity)
                            end
                        end
                    end
                end
            end
        end
        s2a[i] = nil
    end
end

-- Adds, removes, and changes Entities that have been marked.
function tiny_manageEntities(world)

    local e2r = world.entitiesToRemove
    local e2c = world.entitiesToChange

    -- Early exit
    if #e2r == 0 and #e2c == 0 then
        return
    end

    world.entitiesToChange = {}
    world.entitiesToRemove = {}

    local entities = world.entities
    local systems = world.systems

    -- Change Entities
    for i = 1, #e2c do
        local entity = e2c[i]
        -- Add if needed
        if not entities[entity] then
            local index = #entities + 1
            entities[entity] = index
            entities[index] = entity
        end
        for j = 1, #systems do
            local system = systems[j]
            if not system.nocache then
                local ses = system.entities
                local seis = system.indices
                local index = seis[entity]
                local filter = system.filter
                if filter and filter(system, entity) then
                    if not index then
                        system.modified = true
                        index = #ses + 1
                        ses[index] = entity
                        seis[entity] = index
                        local onAdd = system.onAdd
                        if onAdd then
                            onAdd(system, entity)
                        end
                    end
                elseif index then
                    system.modified = true
                    local tmpEntity = ses[#ses]
                    ses[index] = tmpEntity
                    seis[tmpEntity] = index
                    seis[entity] = nil
                    ses[#ses] = nil
                    local onRemove = system.onRemove
                    if onRemove then
                        onRemove(system, entity)
                    end
                end
            end
        end
        e2c[i] = nil
    end

    -- Remove Entities
    for i = 1, #e2r do
        local entity = e2r[i]
        e2r[i] = nil
        local listIndex = entities[entity]
        if listIndex then
            -- Remove Entity from world state
            local lastEntity = entities[#entities]
            entities[lastEntity] = listIndex
            entities[entity] = nil
            entities[listIndex] = lastEntity
            entities[#entities] = nil
            -- Remove from cached systems
            for j = 1, #systems do
                local system = systems[j]
                if not system.nocache then
                    local ses = system.entities
                    local seis = system.indices
                    local index = seis[entity]
                    if index then
                        system.modified = true
                        local tmpEntity = ses[#ses]
                        ses[index] = tmpEntity
                        seis[tmpEntity] = index
                        seis[entity] = nil
                        ses[#ses] = nil
                        local onRemove = system.onRemove
                        if onRemove then
                            onRemove(system, entity)
                        end
                    end
                end
            end
        end
    end
end

--- Manages Entities and Systems marked for deletion or addition. Call this
-- before modifying Systems and Entities outside of a call to `tiny.update`.
-- Do not call this within a call to `tiny.update`.
function tiny.refresh(world)
    tiny_manageSystems(world)
    tiny_manageEntities(world)
    local systems = world.systems
    for i = #systems, 1, -1 do
        local system = systems[i]
        if system.active then
            local onModify = system.onModify
            if onModify and system.modified then
                onModify(system, 0)
            end
            system.modified = false
        end
    end
end

--- Updates the World by dt (delta time). Takes an optional parameter, `filter`,
-- which is a Filter that selects Systems from the World, and updates only those
-- Systems. If `filter` is not supplied, all Systems are updated. Put this
-- function in your main loop.
function tiny.update(world, dt, filter)

    tiny_manageSystems(world)
    tiny_manageEntities(world)

    local systems = world.systems

    -- Iterate through Systems IN REVERSE ORDER
    for i = #systems, 1, -1 do
        local system = systems[i]
        if system.active then
            -- Call the modify callback on Systems that have been modified.
            local onModify = system.onModify
            if onModify and system.modified then
                onModify(system, dt)
            end
            local preWrap = system.preWrap
            if preWrap and
                ((not filter) or filter(world, system)) then
                preWrap(system, dt)
            end
        end
    end

    --  Iterate through Systems IN ORDER
    for i = 1, #systems do
        local system = systems[i]
        if system.active and ((not filter) or filter(world, system)) then

            -- Update Systems that have an update method (most Systems)
            local update = system.update
            if update then
                local interval = system.interval
                if interval then
                    local bufferedTime = (system.bufferedTime or 0) + dt
                    while bufferedTime >= interval do
                        bufferedTime = bufferedTime - interval
                        update(system, interval)
                    end
                    system.bufferedTime = bufferedTime
                else
                    update(system, dt)
                end
            end

            system.modified = false
        end
    end

    -- Iterate through Systems IN ORDER AGAIN
    for i = 1, #systems do
        local system = systems[i]
        local postWrap = system.postWrap
        if postWrap and system.active and
            ((not filter) or filter(world, system)) then
            postWrap(system, dt)
        end
    end

end

--- Removes all Entities from the World.
function tiny.clearEntities(world)
    local el = world.entities
    for i = 1, #el do
        tiny_removeEntity(world, el[i])
    end
end

--- Removes all Systems from the World.
function tiny.clearSystems(world)
    local systems = world.systems
    for i = #systems, 1, -1 do
        tiny_removeSystem(world, systems[i])
    end
end

--- Gets number of Entities in the World.
function tiny.getEntityCount(world)
    return #world.entities
end

--- Gets number of Systems in World.
function tiny.getSystemCount(world)
    return #world.systems
end

--- Sets the index of a System in the World, and returns the old index. Changes
-- the order in which they Systems processed, because lower indexed Systems are
-- processed first. Returns the old system.index.
function tiny.setSystemIndex(world, system, index)
    local oldIndex = system.index
    local systems = world.systems

    if index < 0 then
        index = tiny.getSystemCount(world) + 1 + index
    end

    tremove(systems, oldIndex)
    tinsert(systems, index, system)

    for i = oldIndex, index, index >= oldIndex and 1 or -1 do
        systems[i].index = i
    end

    return oldIndex
end

-- Construct world metatable.
worldMetaTable = {
    __index = {
        add = tiny.add,
        addEntity = tiny.addEntity,
        addSystem = tiny.addSystem,
        remove = tiny.remove,
        removeEntity = tiny.removeEntity,
        removeSystem = tiny.removeSystem,
        refresh = tiny.refresh,
        update = tiny.update,
        clearEntities = tiny.clearEntities,
        clearSystems = tiny.clearSystems,
        getEntityCount = tiny.getEntityCount,
        getSystemCount = tiny.getSystemCount,
        setSystemIndex = tiny.setSystemIndex
    },
    __tostring = function()
        return "<tiny-ecs_World>"
    end
}

return tiny
--[[
Copyright (c) 2012-2013 Matthias Richter

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

Except as contained in this notice, the name(s) of the above copyright holders
shall not be used in advertising or otherwise to promote the sale, use or
other dealings in this Software without prior written authorization.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
]]--

local sqrt, cos, sin, atan2 = math.sqrt, math.cos, math.sin, math.atan2

local function str(x,y)
	return "("..tonumber(x)..","..tonumber(y)..")"
end

local function mul(s, x,y)
	return s*x, s*y
end

local function div(s, x,y)
	return x/s, y/s
end

local function add(x1,y1, x2,y2)
	return x1+x2, y1+y2
end

local function sub(x1,y1, x2,y2)
	return x1-x2, y1-y2
end

local function permul(x1,y1, x2,y2)
	return x1*x2, y1*y2
end

local function dot(x1,y1, x2,y2)
	return x1*x2 + y1*y2
end

local function det(x1,y1, x2,y2)
	return x1*y2 - y1*x2
end

local function eq(x1,y1, x2,y2)
	return x1 == x2 and y1 == y2
end

local function lt(x1,y1, x2,y2)
	return x1 < x2 or (x1 == x2 and y1 < y2)
end

local function le(x1,y1, x2,y2)
	return x1 <= x2 and y1 <= y2
end

local function len2(x,y)
	return x*x + y*y
end

local function len(x,y)
	return sqrt(x*x + y*y)
end

local function dist2(x1,y1, x2,y2)
	return len2(x1-x2, y1-y2)
end

local function dist(x1,y1, x2,y2)
	return len(x1-x2, y1-y2)
end

local function normalize(x,y)
	local l = len(x,y)
	if l > 0 then
		return x/l, y/l
	end
	return x,y
end

local function rotate(phi, x,y)
	local c, s = cos(phi), sin(phi)
	return c*x - s*y, s*x + c*y
end

local function perpendicular(x,y)
	return -y, x
end

local function project(x,y, u,v)
	local s = (x*u + y*v) / (u*u + v*v)
	return s*u, s*v
end

local function mirror(x,y, u,v)
	local s = 2 * (x*u + y*v) / (u*u + v*v)
	return s*u - x, s*v - y
end

-- ref.: http://blog.signalsondisplay.com/?p=336
local function trim(maxLen, x, y)
	local s = maxLen * maxLen / len2(x, y)
	s = s > 1 and 1 or math.sqrt(s)
	return x * s, y * s
end

local function angleTo(x,y, u,v)
	if u and v then
		return atan2(y, x) - atan2(v, u)
	end
	return atan2(y, x)
end

-- the module
return {
	str = str,

	-- arithmetic
	mul    = mul,
	div    = div,
	add    = add,
	sub    = sub,
	permul = permul,
	dot    = dot,
	det    = det,
	cross  = det,

	-- relation
	eq = eq,
	lt = lt,
	le = le,

	-- misc operations
	len2          = len2,
	len           = len,
	dist2         = dist2,
	dist          = dist,
	normalize     = normalize,
	rotate        = rotate,
	perpendicular = perpendicular,
	project       = project,
	mirror        = mirror,
	trim          = trim,
	angleTo       = angleTo,
}
local Script = require('scripts/script')
local Bullet
do
  local _class_0
  local _parent_0 = Script
  local _base_0 = {
    onAdd = function(self, e)
      return e.events:listen('collide', function(o)
        if o.name ~= e.range_attacker.name then
          if o.health ~= nil then
            o.events:say("damage", {
              damage = 2,
              attacker = e.range_attacker
            })
            return e.events:say("kill")
          end
        end
      end)
    end,
    update = function(self, e, dt)
      if e.tx < 0 or e.tx > 10000 or e.ty < 0 or e.ty > 10000 then
        return e.events:say("kill")
      end
    end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__base)
  _class_0 = setmetatable({
    __init = function(self, ...)
      return _class_0.__parent.__init(self, ...)
    end,
    __base = _base_0,
    __name = "Bullet",
    __parent = _parent_0
  }, {
    __index = function(cls, name)
      local val = rawget(_base_0, name)
      if val == nil then
        local parent = rawget(cls, "__parent")
        if parent then
          return parent[name]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  if _parent_0.__inherited then
    _parent_0.__inherited(_parent_0, _class_0)
  end
  Bullet = _class_0
end
return Bullet
local Script = require('scripts/script')
local MineEntrance
do
  local _class_0
  local _parent_0 = Script
  local _base_0 = {
    onAdd = function(self, e)
      return e.events:listen('interact', function()
        self.state.playthrough.pc = self.state.pc
        return self.state:load(e.interact_map, e.seed)
      end)
    end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__base)
  _class_0 = setmetatable({
    __init = function(self, ...)
      return _class_0.__parent.__init(self, ...)
    end,
    __base = _base_0,
    __name = "MineEntrance",
    __parent = _parent_0
  }, {
    __index = function(cls, name)
      local val = rawget(_base_0, name)
      if val == nil then
        local parent = rawget(cls, "__parent")
        if parent then
          return parent[name]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  if _parent_0.__inherited then
    _parent_0.__inherited(_parent_0, _class_0)
  end
  MineEntrance = _class_0
end
return MineEntrance
local Script
do
  local _class_0
  local _base_0 = {
    update = function(self, e, dt)
      return nil
    end
  }
  _base_0.__index = _base_0
  _class_0 = setmetatable({
    __init = function(self, state)
      self.state = state
    end,
    __base = _base_0,
    __name = "Script"
  }, {
    __index = _base_0,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  Script = _class_0
end
return Script
local lume = require('lib/lume')
local Vector = require('lib/vector-light')
local Script = require('scripts/script')
local SnakeAI
do
  local _class_0
  local _parent_0 = Script
  local _base_0 = {
    onAdd = function(self, e)
      e.script_time = 0
      e.script_attack_timeout = 0
      return e.events:listen("kill", function()
        if (math.random() > 0.5) then
          local tmp = {
            tx = e.tx,
            ty = e.ty
          }
          return self.state:create_entity(tmp, lume.randomchoice({
            'ammo',
            'red_potion'
          }))
        end
      end)
    end,
    is_player = function(o)
      return o.player ~= nil
    end,
    update = function(self, e, dt)
      e.script_time = e.script_time + dt
      local speed = love.math.noise(e.script_time * 0.1 + e.id - 123)
      local results = self.state:search(e.tx, e.ty, 48, self.is_player)
      local player = nil
      if results then
        player = results[1]
      end
      if player then
        if e.script_time >= e.script_attack_timeout then
          e.script_attack_timeout = e.script_time + 0.5
          local dx, dy = Vector.sub(player.tx, player.ty, e.tx, e.ty)
          dx, dy = Vector.normalize(dx, dy)
          e.ax = dx * e.acc
          e.ay = dy * e.acc
          e.events:say("attack melee")
          e.events:say("anim change", "attack", function()
            e.anim_running = false
            return e.events:say("anim change", "idle")
          end)
        end
      else
        if speed > 0.5 then
          speed = speed
        else
          speed = 0
        end
        e.rot = e.rot + ((love.math.noise(e.script_time * 0.01 + e.id * 13.41) * 2 - 1) * 2)
        e.ax = math.sin(e.rot) * e.acc * speed
        e.ay = math.cos(e.rot) * e.acc * speed
      end
      if e.anim_running ~= true then
        if e.vx ~= 0 or e.vy ~= 0 then
          if e.anim_track ~= "walk" then
            return e.events:say("anim change", "walk")
          end
        else
          if e.anim_track ~= "idle" then
            return e.events:say("anim change", "idle")
          end
        end
      end
    end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__base)
  _class_0 = setmetatable({
    __init = function(self, ...)
      return _class_0.__parent.__init(self, ...)
    end,
    __base = _base_0,
    __name = "SnakeAI",
    __parent = _parent_0
  }, {
    __index = function(cls, name)
      local val = rawget(_base_0, name)
      if val == nil then
        local parent = rawget(cls, "__parent")
        if parent then
          return parent[name]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  _base_0.__class = _class_0
  if _parent_0.__inherited then
    _parent_0.__inherited(_parent_0, _class_0)
  end
  SnakeAI = _class_0
end
return SnakeAI
